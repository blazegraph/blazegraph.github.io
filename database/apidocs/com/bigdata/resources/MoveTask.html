<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Thu Feb 25 05:11:34 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MoveTask (Blazegraph Database Platform 2.0.1 API)</title>
<meta name="date" content="2016-02-25">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MoveTask (Blazegraph Database Platform 2.0.1 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MoveTask.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/bigdata/resources/MoveTask.AtomicUpdate.html" title="class in com.bigdata.resources"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/resources/MoveTask.html" target="_top">Frames</a></li>
<li><a href="MoveTask.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_com.bigdata.resources.AbstractResourceManagerTask">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.resources</div>
<h2 title="Class MoveTask" class="title">Class MoveTask</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../com/bigdata/journal/AbstractTask.html" title="class in com.bigdata.journal">com.bigdata.journal.AbstractTask</a>&lt;T&gt;</li>
<li>
<ul class="inheritance">
<li><a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html" title="class in com.bigdata.resources">com.bigdata.resources.AbstractResourceManagerTask</a>&lt;T&gt;</li>
<li>
<ul class="inheritance">
<li><a href="../../../com/bigdata/resources/AbstractPrepareTask.html" title="class in com.bigdata.resources">com.bigdata.resources.AbstractPrepareTask</a>&lt;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&gt;</li>
<li>
<ul class="inheritance">
<li>com.bigdata.resources.MoveTask</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../com/bigdata/journal/ITask.html" title="interface in com.bigdata.journal">ITask</a>&lt;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&gt;, <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html?is-external=true" title="class or interface in java.util.concurrent">Callable</a>&lt;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&gt;</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">MoveTask</span>
extends <a href="../../../com/bigdata/resources/AbstractPrepareTask.html" title="class in com.bigdata.resources">AbstractPrepareTask</a>&lt;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&gt;</pre>
<div class="block">Task moves an index partition to another <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>.
 <p>
 This task runs as a historical read operation and copy the view of the index
 partition as of the lastCommitTime of old journal to another
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>. Once that historical view has been copied, this task
 then submits an <code>AtomicUpdateMoveIndexPartitionTask</code>. The atomic
 update is an <a href="../../../com/bigdata/journal/ITx.html#UNISOLATED"><code>ITx.UNISOLATED</code></a> operation. It is responsible copying any
 writes buffered for the index partition on the live journal to the target
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> and then updating the <a href="../../../com/bigdata/mdi/MetadataIndex.html" title="class in com.bigdata.mdi"><code>MetadataIndex</code></a>. Once the
 atomic update task is finished, clients will discover that the source index
 partition does not exist. When they query the <a href="../../../com/bigdata/service/MetadataService.html" title="class in com.bigdata.service"><code>MetadataService</code></a> they
 will discover that the key(-range) is now handled by the new index partition
 on the target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>.
 <p>
 Note: This task is run on the target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> and it copies the
 data from the source <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>. This allows us to use standard
 <a href="../../../com/bigdata/btree/IRangeQuery.html" title="interface in com.bigdata.btree"><code>IRangeQuery</code></a> operations to copy the historical view. However, the
 <code>AtomicUpdateMoveIndexPartitionTask</code> is run on the source
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> since it needs to obtain an exclusive lock on the index
 partition that is being moved in order to prevent concurrent writes during
 the atomic cutover. For the same reason, the
 <code>AtomicUpdateMoveIndexPartitionTask</code> can not use standard
 <a href="../../../com/bigdata/btree/IRangeQuery.html" title="interface in com.bigdata.btree"><code>IRangeQuery</code></a> operations. Instead, it initiates a series of data
 transfers while holding onto the exclusive lock until the target
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> has the current state of the index partition. At that
 point it notifies the <a href="../../../com/bigdata/service/IMetadataService.html" title="interface in com.bigdata.service"><code>IMetadataService</code></a> to perform the atomic cutover
 to the new index partition.
 <p>
 Note: This task does NOT cause any resources associated with the current view
 of the index partition to be released on the source <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>.
 The reason is two-fold. First, the <a href="../../../com/bigdata/btree/IndexSegment.html" title="class in com.bigdata.btree"><code>IndexSegment</code></a>(s) associated with
 that view MAY be in used by historical views. Second, there MAY be historical
 commit points for the index partition on the live journal before the atomic
 cutover to the new <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> - those historical commit points MUST
 be preserved until the release policy for those views has been satisfied.
 <p>
 Note: The MOVE task MUST be explicitly coordinated with the target
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>. Failure to coordinate the move results in an error
 message reported by the <a href="../../../com/bigdata/service/MetadataService.html" title="class in com.bigdata.service"><code>MetadataService</code></a> indicating that the wrong
 partition locator was found under the key. The cause is a MOVE operation
 during which the target data service undergoes concurrent synchronous (and
 then asynchronous) overflow. What happens is the <a href="../../../com/bigdata/resources/MoveTask.html" title="class in com.bigdata.resources"><code>MoveTask</code></a> registers
 the new index partition on the target data service. One registered on the
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>, the index partition it is visible during synchronous
 overflow BEFORE the MOVE is complete and BEFORE the index is registered with
 the <a href="../../../com/bigdata/service/MetadataService.html" title="class in com.bigdata.service"><code>MetadataService</code></a> and hence discoverable to clients. If the target
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> then undergoes synchronous and asynchronous overflow and
 chooses an action which would change the index partition definition (split,
 join, or move) WHILE the index partition is still being moved onto the target
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> THEN the MOVE is not atomic and the definition of the
 index partition in the <a href="../../../com/bigdata/service/MetadataService.html" title="class in com.bigdata.service"><code>MetadataService</code></a> will not coherently reflect
 either the MOVE or the action chosen by the target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>,
 depending on which one makes its atomic update first.
 <p>
 The target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> MAY undergo both synchronous and asynchronous
 overflow as <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>s are designed to allow continued writes
 during those operations. Further, it MAY choose to copy, build, or compact
 the index partition while it is being moved. However, it MUST NOT choose any
 action (split, join, or move) that would change the index partition
 definition until the move is complete (whether it ends in success or
 failure).
 <p>
 This issue is addressed by the following protocol:
 <ol>
 
 <li>The <a href="../../../com/bigdata/resources/MoveTask.html" title="class in com.bigdata.resources"><code>MoveTask</code></a> set the <code>sourcePartitionId</code> on the
 <a href="../../../com/bigdata/mdi/LocalPartitionMetadata.html" title="class in com.bigdata.mdi"><code>LocalPartitionMetadata</code></a> when it registers the index partition on the
 target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>. When <code>sourcePartitionId != -1</code>.
 the target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> is restricted to for that index partition to
 overflows actions which do not change the index partition definition (copy,
 build, or merge). Further, any index partition found on restart whose by the
 target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> whose <code>sourcePartitionId != -1</code> is
 deleted as it was never successfully put into play (this prevents partial
 moves from accumulating state which could not otherwise be released.)</li>
 
 <li>The atomic update task causes the <code>sourcePartitionId</code> to be
 set to <code>-1</code> as one of its last actions, thereby allowing the
 target <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> to use operations that could re-define the index
 partition (split, join, move) and also preventing the target index partition
 from being deleted on restart. </li>
 
 </ol>
 
 FIXME javadoc
 <p>
 Note: There are only two entry points: a simple move and a move where the
 compacting merge has already been performed, e.g., by a split, and we just
 need to do the atomic update phase.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/resources/MoveTask.AtomicUpdate.html" title="class in com.bigdata.resources">MoveTask.AtomicUpdate</a></strong></code>
<div class="block">Moves an index partition from this data service to another data service.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/resources/MoveTask.ReceiveIndexPartitionTask.html" title="class in com.bigdata.resources">MoveTask.ReceiveIndexPartitionTask</a></strong></code>
<div class="block">Receives an index partition comprised of a historical index segment store
 and an index segment store containing the buffered writes and registers
 the index partition on the data service on which this procedure is
 executed.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_com.bigdata.journal.AbstractTask">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;com.bigdata.journal.<a href="../../../com/bigdata/journal/AbstractTask.html" title="class in com.bigdata.journal">AbstractTask</a></h3>
<code><a href="../../../com/bigdata/journal/AbstractTask.DelegateTask.html" title="class in com.bigdata.journal">AbstractTask.DelegateTask</a>&lt;<a href="../../../com/bigdata/journal/AbstractTask.DelegateTask.html" title="type parameter in AbstractTask.DelegateTask">T</a>&gt;, <a href="../../../com/bigdata/journal/AbstractTask.InnerReadWriteTxServiceCallable.html" title="class in com.bigdata.journal">AbstractTask.InnerReadWriteTxServiceCallable</a>&lt;<a href="../../../com/bigdata/journal/AbstractTask.InnerReadWriteTxServiceCallable.html" title="type parameter in AbstractTask.InnerReadWriteTxServiceCallable">T</a>&gt;, <a href="../../../com/bigdata/journal/AbstractTask.InnerWriteServiceCallable.html" title="class in com.bigdata.journal">AbstractTask.InnerWriteServiceCallable</a>&lt;<a href="../../../com/bigdata/journal/AbstractTask.InnerWriteServiceCallable.html" title="type parameter in AbstractTask.InnerWriteServiceCallable">T</a>&gt;, <a href="../../../com/bigdata/journal/AbstractTask.ResubmitException.html" title="class in com.bigdata.journal">AbstractTask.ResubmitException</a></code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_com.bigdata.resources.AbstractResourceManagerTask">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.bigdata.resources.<a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html" title="class in com.bigdata.resources">AbstractResourceManagerTask</a></h3>
<code><a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html#DEBUG">DEBUG</a>, <a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html#INFO">INFO</a>, <a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html#log">log</a>, <a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html#resourceManager">resourceManager</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_com.bigdata.journal.AbstractTask">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.bigdata.journal.<a href="../../../com/bigdata/journal/AbstractTask.html" title="class in com.bigdata.journal">AbstractTask</a></h3>
<code><a href="../../../com/bigdata/journal/AbstractTask.html#checkpointNanoTime">checkpointNanoTime</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#concurrencyManager">concurrencyManager</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#isReadWriteTx">isReadWriteTx</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#nanoTime_assignedWorker">nanoTime_assignedWorker</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#nanoTime_beginWork">nanoTime_beginWork</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#nanoTime_finishedWork">nanoTime_finishedWork</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#nanoTime_submitTask">nanoTime_submitTask</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#readOnly">readOnly</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#taskCounters">taskCounters</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#timestamp">timestamp</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#transactionManager">transactionManager</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#tx">tx</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/bigdata/resources/MoveTask.html#MoveTask(com.bigdata.resources.ViewMetadata,%20java.util.UUID)">MoveTask</a></strong>(com.bigdata.resources.ViewMetadata&nbsp;vmd,
        <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>&nbsp;targetDataServiceUUID)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/resources/MoveTask.html#clearRefs()">clearRefs</a></strong>()</code>
<div class="block">Method is responsible for clearing the <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/SoftReference.html?is-external=true" title="class or interface in java.lang.ref"><code>SoftReference</code></a>s held by
 <code>ViewMetadata</code> for the source view(s) on the old journal.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static <a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/resources/MoveTask.html#doAtomicUpdate(com.bigdata.resources.ResourceManager,%20java.lang.String,%20com.bigdata.resources.BuildResult,%20java.util.UUID,%20int,%20com.bigdata.service.Event)">doAtomicUpdate</a></strong>(<a href="../../../com/bigdata/resources/ResourceManager.html" title="class in com.bigdata.resources">ResourceManager</a>&nbsp;resourceManager,
              <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sourceIndexName,
              <a href="../../../com/bigdata/resources/BuildResult.html" title="class in com.bigdata.resources">BuildResult</a>&nbsp;historicalWritesBuildResult,
              <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>&nbsp;targetDataServiceUUID,
              int&nbsp;targetIndexPartitionId,
              <a href="../../../com/bigdata/service/Event.html" title="class in com.bigdata.service">Event</a>&nbsp;parentEvent)</code>
<div class="block">Submits an <a href="../../../com/bigdata/resources/MoveTask.AtomicUpdate.html" title="class in com.bigdata.resources"><code>MoveTask.AtomicUpdate</code></a> and awaits and returns its outcome.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/resources/MoveTask.html#doTask()">doTask</a></strong>()</code>
<div class="block">Builds a compact index segment from the historical view as of the last
 commit time on the old journal and then submits an atomic update
 operation to move the source index partition to the target data service.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.bigdata.resources.AbstractResourceManagerTask">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.bigdata.resources.<a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html" title="class in com.bigdata.resources">AbstractResourceManagerTask</a></h3>
<code><a href="../../../com/bigdata/resources/AbstractResourceManagerTask.html#toString(java.lang.String,%20java.lang.Object[])">toString</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.bigdata.journal.AbstractTask">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.bigdata.journal.<a href="../../../com/bigdata/journal/AbstractTask.html" title="class in com.bigdata.journal">AbstractTask</a></h3>
<code><a href="../../../com/bigdata/journal/AbstractTask.html#assertResource(java.lang.String)">assertResource</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#assertRunning()">assertRunning</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#assertUnisolated()">assertUnisolated</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#call()">call</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#clearLoggingContext()">clearLoggingContext</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#dropIndex(java.lang.String)">dropIndex</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getCommitTime()">getCommitTime</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getIndex(java.lang.String)">getIndex</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getJournal()">getJournal</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getOnlyResource()">getOnlyResource</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getResource()">getResource</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getResourceManager()">getResourceManager</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getTaskCounters()">getTaskCounters</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getTaskName()">getTaskName</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#getTimestamp()">getTimestamp</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#isResource(java.lang.String)">isResource</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#registerIndex(java.lang.String,%20com.bigdata.btree.BTree)">registerIndex</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#setupLoggingContext()">setupLoggingContext</a>, <a href="../../../com/bigdata/journal/AbstractTask.html#toString()">toString</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MoveTask(com.bigdata.resources.ViewMetadata, java.util.UUID)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MoveTask</h4>
<pre>public&nbsp;MoveTask(com.bigdata.resources.ViewMetadata&nbsp;vmd,
        <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>&nbsp;targetDataServiceUUID)</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>vmd</code> - Metadata for the source index partition view.</dd><dd><code>targetDataServiceUUID</code> - The UUID for the target data service.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="clearRefs()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearRefs</h4>
<pre>protected&nbsp;void&nbsp;clearRefs()</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../com/bigdata/resources/AbstractPrepareTask.html#clearRefs()">AbstractPrepareTask</a></code></strong></div>
<div class="block">Method is responsible for clearing the <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/SoftReference.html?is-external=true" title="class or interface in java.lang.ref"><code>SoftReference</code></a>s held by
 <code>ViewMetadata</code> for the source view(s) on the old journal.
 <p>
 Note: This method MUST be invoked in order to permit those references to
 be cleared more eagerly than the end of the entire asynchronous overflow
 operation (which is when the task references would themselves go out of
 scope and become available for GC).</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/resources/AbstractPrepareTask.html#clearRefs()">clearRefs</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/resources/AbstractPrepareTask.html" title="class in com.bigdata.resources">AbstractPrepareTask</a>&lt;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&gt;</code></dd>
</dl>
</li>
</ul>
<a name="doTask()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doTask</h4>
<pre>protected&nbsp;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&nbsp;doTask()
                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<div class="block">Builds a compact index segment from the historical view as of the last
 commit time on the old journal and then submits an atomic update
 operation to move the source index partition to the target data service.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/journal/AbstractTask.html#doTask()">doTask</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/journal/AbstractTask.html" title="class in com.bigdata.journal">AbstractTask</a>&lt;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&gt;</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>A <a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources"><code>MoveResult</code></a> describing the move operation (this is
         returned mainly for historical reasons).</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code> - The exception that will be thrown by <a href="../../../com/bigdata/journal/AbstractTask.html#call()"><code>AbstractTask.call()</code></a> iff the
             operation fails.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - This exception SHOULD be thrown if
                <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html?is-external=true#interrupted()" title="class or interface in java.lang"><code>Thread.interrupted()</code></a> becomes true during
                execution.</dd></dl>
</li>
</ul>
<a name="doAtomicUpdate(com.bigdata.resources.ResourceManager, java.lang.String, com.bigdata.resources.BuildResult, java.util.UUID, int, com.bigdata.service.Event)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>doAtomicUpdate</h4>
<pre>protected static&nbsp;<a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources">MoveResult</a>&nbsp;doAtomicUpdate(<a href="../../../com/bigdata/resources/ResourceManager.html" title="class in com.bigdata.resources">ResourceManager</a>&nbsp;resourceManager,
                        <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sourceIndexName,
                        <a href="../../../com/bigdata/resources/BuildResult.html" title="class in com.bigdata.resources">BuildResult</a>&nbsp;historicalWritesBuildResult,
                        <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>&nbsp;targetDataServiceUUID,
                        int&nbsp;targetIndexPartitionId,
                        <a href="../../../com/bigdata/service/Event.html" title="class in com.bigdata.service">Event</a>&nbsp;parentEvent)
                                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a>,
                                           <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutionException.html?is-external=true" title="class or interface in java.util.concurrent">ExecutionException</a></pre>
<div class="block">Submits an <a href="../../../com/bigdata/resources/MoveTask.AtomicUpdate.html" title="class in com.bigdata.resources"><code>MoveTask.AtomicUpdate</code></a> and awaits and returns its outcome.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>resourceManager</code> - The resource manager.</dd><dd><code>sourceIndexName</code> - The name of the source index partition.</dd><dd><code>historicalWritesBuildResult</code> - An index segment containing all data for the source view as of
            the last commit time on the old journal. This index segment
            should be generated by a compacting merge or by an index
            partition split with the same semantics so that we will move
            the minimum amount of data.</dd><dd><code>targetDataServiceUUID</code> - The <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a> of the target data service.</dd><dd><code>targetIndexPartitionId</code> - The partition identifier assigned to the target index
            partition.</dd><dd><code>parentEvent</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutionException.html?is-external=true" title="class or interface in java.util.concurrent">ExecutionException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MoveTask.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/resources/MoveResult.html" title="class in com.bigdata.resources"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/bigdata/resources/MoveTask.AtomicUpdate.html" title="class in com.bigdata.resources"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/resources/MoveTask.html" target="_top">Frames</a></li>
<li><a href="MoveTask.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_com.bigdata.resources.AbstractResourceManagerTask">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
