<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Fri Apr 08 18:36:42 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>WriteCache (Blazegraph Database Platform 2.1.0 API)</title>
<meta name="date" content="2016-04-08">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="WriteCache (Blazegraph Database Platform 2.1.0 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/WriteCache.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/bigdata/io/writecache/TestWriteCacheServiceLifetime.html" title="class in com.bigdata.io.writecache"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html" title="class in com.bigdata.io.writecache"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/bigdata/io/writecache/WriteCache.html" target="_top">Frames</a></li>
<li><a href="WriteCache.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.io.writecache</div>
<h2 title="Class WriteCache" class="title">Class WriteCache</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.io.writecache.WriteCache</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html" title="class in com.bigdata.io.writecache">WriteCache.FileChannelScatteredWriteCache</a>, <a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelWriteCache.html" title="class in com.bigdata.io.writecache">WriteCache.FileChannelWriteCache</a>, <a href="../../../../com/bigdata/io/writecache/WriteCache.ReadCache.html" title="class in com.bigdata.io.writecache">WriteCache.ReadCache</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">WriteCache</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></pre>
<div class="block">This class provides a write cache with read-through for NIO writes on a
 <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html?is-external=true" title="class or interface in java.nio.channels"><code>FileChannel</code></a> (and potentially on a remote service). This class is
 designed to maximize the opportunity for efficient NIO by combining many
 writes onto a single direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a> and then efficiently
 transferring those writes onto the backing channel in a channel dependent
 manner. In general, there are three use cases for a <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>:
 <ol>
 <li>Gathered writes. This case is used by the <a href="../../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a>.</li>
 <li>Pure append of sequentially allocated records. This case is used by the
 <a href="../../../../com/bigdata/journal/WORMStrategy.html" title="class in com.bigdata.journal"><code>WORMStrategy</code></a> (WORM) and by the <a href="../../../../com/bigdata/btree/IndexSegmentBuilder.html" title="class in com.bigdata.btree"><code>IndexSegmentBuilder</code></a>.</li>
 <li>Write of a single large buffer owned by the caller. This case may be used
 when the caller wants to manage the buffers or when the caller's buffer is
 larger than the write cache.</li>
 </ol>
 The caller is responsible for managing which buffers are being written on and
 read on, when they are flushed, and when they are reset. It is perfectly
 reasonable to have more than one <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> and to read through on
 any <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> until it has been recycled. A <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> must
 be reset before it is put into play again for new writes.
 <p>
 Note: For an append-only model (WORM), the caller MUST serialize writes onto
 the <a href="../../../../com/bigdata/rawstore/IRawStore.html" title="interface in com.bigdata.rawstore"><code>IRawStore</code></a> and the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>. This is required in order
 to ensure that the records are laid out in a dense linear fashion on the
 <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> and permits the backing buffer to be transferred in a
 single IO to the backing file.
 <p>
 Note: For a <a href="../../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a>, the caller must take more responsibility for
 managing the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>(s) which are in play and scheduling their
 eviction onto the backing store. The caller can track the space remaining in
 each <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> and decide when to flush a <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> based
 on that information.</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>$Id$</dd>
<dt><span class="strong">Author:</span></dt>
  <dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html" title="class in com.bigdata.io.writecache">WriteCache.FileChannelScatteredWriteCache</a></strong></code>
<div class="block">The scattered write cache is used by the <a href="../../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a> since the writes
 can be made to any part of the file assigned for data allocation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelWriteCache.html" title="class in com.bigdata.io.writecache">WriteCache.FileChannelWriteCache</a></strong></code>
<div class="block">A <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> implementation suitable for an append-only file such
 as the <a href="../../../../com/bigdata/journal/WORMStrategy.html" title="class in com.bigdata.journal"><code>WORMStrategy</code></a> or the output file of the
 <a href="../../../../com/bigdata/btree/IndexSegmentBuilder.html" title="class in com.bigdata.btree"><code>IndexSegmentBuilder</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.HAPackage.html" title="class in com.bigdata.io.writecache">WriteCache.HAPackage</a></strong></code>
<div class="block">Used to retrieve the <a href="../../../../com/bigdata/ha/msg/HAWriteMessage.html" title="class in com.bigdata.ha.msg"><code>HAWriteMessage</code></a> AND the associated
 <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.ReadCache.html" title="class in com.bigdata.io.writecache">WriteCache.ReadCache</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a></strong></code>
<div class="block">The metadata associated with a record in the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="../../../../com/bigdata/io/writecache/WriteCacheCounters.html" title="class in com.bigdata.io.writecache">WriteCacheCounters</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#counters">counters</a></strong></code>
<div class="block">The current performance counters.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#log">log</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentMap.html?is-external=true" title="class or interface in java.util.concurrent">ConcurrentMap</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#recordMap">recordMap</a></strong></code>
<div class="block">An index into the write cache used for read through on the cache.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#WriteCache(com.bigdata.io.IBufferAccess,%20boolean,%20boolean,%20boolean,%20boolean,%20long)">WriteCache</a></strong>(<a href="../../../../com/bigdata/io/IBufferAccess.html" title="interface in com.bigdata.io">IBufferAccess</a>&nbsp;buf,
          boolean&nbsp;prefixWrites,
          boolean&nbsp;useChecksum,
          boolean&nbsp;isHighlyAvailable,
          boolean&nbsp;bufferHasData,
          long&nbsp;fileExtent)</code>
<div class="block">Create a <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> from either a caller supplied buffer or a
 direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a> allocated from the <a href="../../../../com/bigdata/io/DirectBufferPool.html" title="class in com.bigdata.io"><code>DirectBufferPool</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#allocate(int)">allocate</a></strong>(int&nbsp;nbytes)</code>
<div class="block">Allocate space for a record of the given length on this
 <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#bytesWritten()">bytesWritten</a></strong>()</code>
<div class="block">The #of bytes written on the backing buffer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#capacity()">capacity</a></strong>()</code>
<div class="block">The maximum length of a record which could be inserted into the buffer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#close()">close</a></strong>()</code>
<div class="block">Permanently take the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> instance out of service.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#closeForWrites()">closeForWrites</a></strong>()</code>
<div class="block">Called from <a href="../../../../com/bigdata/io/writecache/WriteCacheService.html" title="class in com.bigdata.io.writecache"><code>WriteCacheService</code></a> to lock buffer content immediately
 prior to flushing and HA pipline replication.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#contains(long)">contains</a></strong>(long&nbsp;offset)</code>
<div class="block">Checks if cache recordMap contains address offset</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#decrementReferenceCount()">decrementReferenceCount</a></strong>()</code>
<div class="block">Although public, it is designed to be used by the WriteCacheService
 with a memoizer pattern to support concurrent reads to
 read cache buffers.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#flush(boolean)">flush</a></strong>(boolean&nbsp;force)</code>
<div class="block">Flush the writes to the backing channel but DOES NOT sync the channel and
 DOES NOT <a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()"><code>reset()</code></a> the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#flush(boolean,%20long,%20java.util.concurrent.TimeUnit)">flush</a></strong>(boolean&nbsp;force,
     long&nbsp;timeout,
     <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)</code>
<div class="block">Flush the writes to the backing channel but DOES NOT sync the channel and
 DOES NOT <a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()"><code>reset()</code></a> the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#getCompressorKey()">getCompressorKey</a></strong>()</code>
<div class="block">Return the optional key for the <a href="../../../../com/bigdata/io/compression/CompressorRegistry.html" title="class in com.bigdata.io.compression"><code>CompressorRegistry</code></a> which
 identifies the <a href="../../../../com/bigdata/io/compression/IRecordCompressor.html" title="interface in com.bigdata.io.compression"><code>IRecordCompressor</code></a> to be applied.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#getCounters()">getCounters</a></strong>()</code>
<div class="block">Return the performance counters for the write cacher.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#getFileExtent()">getFileExtent</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#getLastOffset()">getLastOffset</a></strong>()</code>
<div class="block">Used by the HAWriteMessage to retrieve the nextOffset as implied by the
 recordMap</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#getReferenceCount()">getReferenceCount</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#incrementReferenceCount()">incrementReferenceCount</a></strong>()</code>
<div class="block">Called when a new reference is acquired</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#isClosedForWrites()">isClosedForWrites</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#read(long,%20int)">read</a></strong>(long&nbsp;offset,
    int&nbsp;nbytes)</code>
<div class="block">Read a record from the write cache.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#registerWriteStatus(long,%20int,%20char)">registerWriteStatus</a></strong>(long&nbsp;offset,
                   int&nbsp;length,
                   char&nbsp;action)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()">reset</a></strong>()</code>
<div class="block">Reset the write cache, discarding any writes which have not been written
 through to the backing channel yet.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#resetRecordMapFromBuffer()">resetRecordMapFromBuffer</a></strong>()</code>
<div class="block">Hook to rebuild RecordMetadata after buffer has been transferred.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#resetRecordMapFromBuffer(java.nio.ByteBuffer,%20java.util.Map)">resetRecordMapFromBuffer</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;buf,
                        <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;&nbsp;recordMap)</code>
<div class="block">Overridden by
 <a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html#resetRecordMapFromBuffer(java.nio.ByteBuffer,%20java.util.Map)"><code>WriteCache.FileChannelScatteredWriteCache.resetRecordMapFromBuffer(ByteBuffer, Map)</code></a>
 .</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#setFileExtent(long)">setFileExtent</a></strong>(long&nbsp;fileExtent)</code>
<div class="block">Set the current extent of the backing file on the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>
 object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#setFirstOffset(long)">setFirstOffset</a></strong>(long&nbsp;firstOffset)</code>
<div class="block">Exposed to the WORM for HA support.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#setRecordMap(java.util.Collection)">setRecordMap</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;&nbsp;map)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#toString()">toString</a></strong>()</code>
<div class="block">Adds some debugging information.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#write(long,%20java.nio.ByteBuffer,%20int)">write</a></strong>(long&nbsp;offset,
     <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;data,
     int&nbsp;chk)</code>
<div class="block">Write the record on the cache.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/io/writecache/WriteCache.html#writeOnChannel(java.nio.ByteBuffer,%20long,%20java.util.Map,%20long)">writeOnChannel</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;buf,
              long&nbsp;firstOffset,
              <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;&nbsp;recordMap,
              long&nbsp;nanos)</code>
<div class="block">Write the data from the buffer onto the channel.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>log</h4>
<pre>protected static final&nbsp;org.apache.log4j.Logger log</pre>
</li>
</ul>
<a name="recordMap">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordMap</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentMap.html?is-external=true" title="class or interface in java.util.concurrent">ConcurrentMap</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt; recordMap</pre>
<div class="block">An index into the write cache used for read through on the cache. The
 keys are the file offsets that would be used to read the corresponding
 record. The values describe the position in buffer where that record is
 found and the length of the record.
 <p>
 Note: Exposed to inner classes.</div>
</li>
</ul>
<a name="counters">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>counters</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="../../../../com/bigdata/io/writecache/WriteCacheCounters.html" title="class in com.bigdata.io.writecache">WriteCacheCounters</a>&gt; counters</pre>
<div class="block">The current performance counters.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="WriteCache(com.bigdata.io.IBufferAccess, boolean, boolean, boolean, boolean, long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>WriteCache</h4>
<pre>public&nbsp;WriteCache(<a href="../../../../com/bigdata/io/IBufferAccess.html" title="interface in com.bigdata.io">IBufferAccess</a>&nbsp;buf,
          boolean&nbsp;prefixWrites,
          boolean&nbsp;useChecksum,
          boolean&nbsp;isHighlyAvailable,
          boolean&nbsp;bufferHasData,
          long&nbsp;fileExtent)
           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Create a <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> from either a caller supplied buffer or a
 direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a> allocated from the <a href="../../../../com/bigdata/io/DirectBufferPool.html" title="class in com.bigdata.io"><code>DirectBufferPool</code></a>.
 <p>
 Note: The application MUST ensure that it <a href="../../../../com/bigdata/io/writecache/WriteCache.html#close()"><code>close()</code></a>s the
 <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> or it can leak direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a>s!
 <p>
 Note: NIO operations are performed using a direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a>
 (that is, one use backing bytes are allocated on the C heap). When the
 caller supplies a <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a> that is allocated on the Java heap
 as opposed to in native memory, a temporary direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a>
 will be allocated for the IO operation by Java. The JVM can fail to
 release this temporary direct <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a>, resulting in a memory
 leak. For this reason, the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> SHOULD use a direct
 <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>buf</code> - A <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a> to be used as the write cache (optional).
            When <code>null</code> a buffer will be allocated for you from
            the <a href="../../../../com/bigdata/io/DirectBufferPool.html" title="class in com.bigdata.io"><code>DirectBufferPool</code></a>. Buffers allocated on your behalf
            will be automatically released by <a href="../../../../com/bigdata/io/writecache/WriteCache.html#close()"><code>close()</code></a>.</dd><dd><code>prefixWrites</code> - <code>true</code> iff the implementation uses scattered
            writes. The RW store uses scattered writes since its updates
            are written to different parts of the backing file. The WORM
            store does not since all updates are written to the end of the
            user extent in the backing file.</dd><dd><code>useChecksum</code> - <code>true</code> iff the write cache will store the caller's
            checksum for a record and validate it on read.</dd><dd><code>isHighlyAvailable</code> - when <code>true</code> the whole record checksum is maintained
            for use when replicating the write cache along the write
            pipeline.  This needs to be <code>true</code> for HA1 as well
            since we need to write the HALog.</dd><dd><code>bufferHasData</code> - when <code>true</code> the caller asserts that the buffer has
            data (from a replicated write), in which case the position
            should be the start of the data in the buffer and the limit
            the #of bytes with valid data. when <code>false</code>, the
            caller's buffer will be cleared. The code presumes that the
            <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> instance will be used to lay down a single
            buffer worth of data onto the backing file.</dd><dd><code>fileExtent</code> - The then current extent of the backing file.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd><dt><span class="strong">See Also:</span></dt><dd><code>ab76d1d4479fffffffffa5abfb09c719a30?bug_id=6210541</code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setFirstOffset(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setFirstOffset</h4>
<pre>protected&nbsp;void&nbsp;setFirstOffset(long&nbsp;firstOffset)</pre>
<div class="block">Exposed to the WORM for HA support.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>firstOffset</code> - The first offset (from the HA message).</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;toString()</pre>
<div class="block">Adds some debugging information.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
<a name="capacity()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>capacity</h4>
<pre>public final&nbsp;int&nbsp;capacity()</pre>
<div class="block">The maximum length of a record which could be inserted into the buffer.
 <p>
 Note: When checksums are enabled, this is 4 bytes less than the actual
 capacity of the underlying buffer since each record requires an
 additional four bytes for the checksum field.</div>
</li>
</ul>
<a name="bytesWritten()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bytesWritten</h4>
<pre>public final&nbsp;int&nbsp;bytesWritten()</pre>
<div class="block">The #of bytes written on the backing buffer.
 <p>
 Note: in order to rely on this value the caller MUST have exclusive
 access to the buffer. This API does not provide the means for acquiring
 that exclusive access. This is something that the caller has to arrange
 for themselves, which is why this is a package private method.</div>
</li>
</ul>
<a name="setFileExtent(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setFileExtent</h4>
<pre>public&nbsp;void&nbsp;setFileExtent(long&nbsp;fileExtent)</pre>
<div class="block">Set the current extent of the backing file on the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>
 object. When used as part of an HA write pipeline, the receiver is
 responsible for adjusting its local file size to match the file extent in
 each <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fileExtent</code> - The current extent of the file.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the file extent is negative.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../com/bigdata/io/writecache/WriteCacheService.html#setExtent(long)"><code>WriteCacheService.setExtent(long)</code></a></dd></dl>
</li>
</ul>
<a name="getFileExtent()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileExtent</h4>
<pre>public&nbsp;long&nbsp;getFileExtent()</pre>
</li>
</ul>
<a name="write(long, java.nio.ByteBuffer, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>write</h4>
<pre>public&nbsp;boolean&nbsp;write(long&nbsp;offset,
            <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;data,
            int&nbsp;chk)
              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Write the record on the cache. This interface DOES NOT provide any
 guarantee about the ordering of writes. Callers who require a specific
 ordering must coordinate that ordering themselves, e.g., by synchronizing
 across their writes onto the cache.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html#write(long,%20java.nio.ByteBuffer,%20int)">write</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>offset</code> - The file offset of that record in the backing file.</dd><dd><code>data</code> - The record. The bytes from the current
            <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html?is-external=true#position()" title="class or interface in java.nio"><code>Buffer.position()</code></a> to the
            <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html?is-external=true#limit()" title="class or interface in java.nio"><code>Buffer.limit()</code></a> will be written and the
            <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html?is-external=true#position()" title="class or interface in java.nio"><code>Buffer.position()</code></a> will be advanced to the
            <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html?is-external=true#limit()" title="class or interface in java.nio"><code>Buffer.limit()</code></a> . The caller may subsequently
            modify the contents of the buffer without changing the state
            of the cache (i.e., the data are copied into the cache).</dd><dd><code>chk</code> - The checksum of the <i>data</i> (optional). When checksums are
            not enabled this should be ZERO (0). When checksums are
            enabled, <code>#read(long)</code> will validate the checksum before
            returning <i>data</i>.</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> iff the caller's record was transferred to the
         cache. When <code>false</code>, there is not enough room left in
         the write cache for this record.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - If the buffer is closed.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - If the caller's record is larger than the maximum capacity of
             cache (the record could not fit within the cache). The caller
             should check for this and provide special handling for such
             large records. For example, they can be written directly onto
             the backing channel.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="read(long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;read(long&nbsp;offset,
              int&nbsp;nbytes)
                throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a>,
                       <a href="../../../../com/bigdata/util/ChecksumError.html" title="class in com.bigdata.util">ChecksumError</a></pre>
<div class="block">Read a record from the write cache.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html#read(long,%20int)">read</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>offset</code> - The file offset of that record in the backing file.</dd><dd><code>nbytes</code> - The length of the record (decoded from the address by the
            caller).</dd>
<dt><span class="strong">Returns:</span></dt><dd>The data read -or- <code>null</code> iff the record does not lie
         within the <a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache"><code>IWriteCache</code></a>. When non-null, this will be a
         newly allocated exact fit mutable <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio"><code>ByteBuffer</code></a> backed by a
         Java <code>byte[]</code>. The buffer will be flipped to prepare
         for reading (the position will be zero and the limit will be the
         #of bytes read). The data DOES NOT include the bytes used to code
         checksum even when checksums are enabled.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - If the buffer is closed.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd>
<dd><code><a href="../../../../com/bigdata/util/ChecksumError.html" title="class in com.bigdata.util">ChecksumError</a></code> - if checksums are enabled and the checksum for the record
             could not be validated.</dd></dl>
</li>
</ul>
<a name="flush(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flush</h4>
<pre>public&nbsp;void&nbsp;flush(boolean&nbsp;force)
           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                  <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Flush the writes to the backing channel but DOES NOT sync the channel and
 DOES NOT <a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()"><code>reset()</code></a> the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>. <a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()"><code>reset()</code></a> is a
 separate operation because a common use is to retain recently flushed
 instances for read-back.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html#flush(boolean)">flush</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>force</code> - When <code>true</code>, the data will be forced to stable
            media.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="flush(boolean, long, java.util.concurrent.TimeUnit)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flush</h4>
<pre>public&nbsp;boolean&nbsp;flush(boolean&nbsp;force,
            long&nbsp;timeout,
            <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)
              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                     <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a>,
                     <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Flush the writes to the backing channel but DOES NOT sync the channel and
 DOES NOT <a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()"><code>reset()</code></a> the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>. <a href="../../../../com/bigdata/io/writecache/WriteCache.html#reset()"><code>reset()</code></a> is a
 separate operation because a common use is to retain recently flushed
 instances for read-back.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html#flush(boolean,%20long,%20java.util.concurrent.TimeUnit)">flush</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>force</code> - When <code>true</code>, the data will be forced to stable
            media.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="writeOnChannel(java.nio.ByteBuffer, long, java.util.Map, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeOnChannel</h4>
<pre>protected abstract&nbsp;boolean&nbsp;writeOnChannel(<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;buf,
                     long&nbsp;firstOffset,
                     <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;&nbsp;recordMap,
                     long&nbsp;nanos)
                                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a>,
                                          <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a>,
                                          <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Write the data from the buffer onto the channel. This method provides a
 uniform means to request that the buffer write itself onto the backing
 channel, regardless of whether the channel is backed by a file, a socket,
 etc.
 <p>
 Implementations of this method MAY support gathered writes, depending on
 the channel. The necessary information to perform a gathered write is
 present in the <i>recordMap</i>. On the other hand, the implementation
 MAY require that the records in the cache are laid out for a WORM, in
 which case <a href="../../../../com/bigdata/io/writecache/WriteCache.html#getFirstOffset()"><code>getFirstOffset()</code></a> provides the starting offset for the
 data to be written. The application MUST coordinate the requirements for
 a R/W or WORM store with the use of the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> and the means
 to write on the backing channel.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>buf</code> - The data to be written. Only the dirty bytes are visible in
            this view. The implementation should write all bytes from the
            current position to the limit.</dd><dd><code>firstOffset</code> - The offset of the first record in the recordMap into the file
            (may be relative to a base offset within the file). This is
            provided as an optimization for the WORM which writes its
            records contiguously on the backing store.</dd><dd><code>recordMap</code> - The mapping of record offsets onto metadata about those
            records.</dd><dd><code>nanos</code> - The timeout for the operation in nanoseconds.</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> if the operation was completed successfully
         within the time alloted.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - if the thread was interrupted.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if there was an IO problem.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a></code></dd></dl>
</li>
</ul>
<a name="reset()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reset</h4>
<pre>public&nbsp;void&nbsp;reset()
           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Reset the write cache, discarding any writes which have not been written
 through to the backing channel yet. This method IS NOT responsible for
 discarding writes which have been written through since those are in
 general available for reading directly from the backing channel. The
 abort protocol at the <a href="../../../../com/bigdata/journal/IAtomicStore.html" title="interface in com.bigdata.journal"><code>IAtomicStore</code></a> level is responsible for
 ensuring that processes do not see old data after an abort. This is
 generally handled by re-loading the appropriate root block and
 reinitializing various things from that root block..
 <p>
 This implementation clears the buffer, the record map, and other internal
 metadata such that the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> is prepared to receive new
 writes.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html#reset()">reset</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if the write cache is closed.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()
           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Permanently take the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> instance out of service. If the
 buffer was allocated by the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> then it is released back
 to the <a href="../../../../com/bigdata/io/DirectBufferPool.html" title="class in com.bigdata.io"><code>DirectBufferPool</code></a>. After this method is called, records can
 no longer be read from nor written onto the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>. It is
 safe to invoke this method more than once.
 <p>
 Concurrent <a href="../../../../com/bigdata/io/writecache/WriteCache.html#read(long,%20int)"><code>read(long, int)</code></a> requests will be serviced if the
 already hold the the read lock but requests will fail once the</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html#close()">close</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/io/writecache/IWriteCache.html" title="interface in com.bigdata.io.writecache">IWriteCache</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="getCompressorKey()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCompressorKey</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getCompressorKey()</pre>
<div class="block">Return the optional key for the <a href="../../../../com/bigdata/io/compression/CompressorRegistry.html" title="class in com.bigdata.io.compression"><code>CompressorRegistry</code></a> which
 identifies the <a href="../../../../com/bigdata/io/compression/IRecordCompressor.html" title="interface in com.bigdata.io.compression"><code>IRecordCompressor</code></a> to be applied.</div>
</li>
</ul>
<a name="getCounters()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCounters</h4>
<pre>public&nbsp;<a href="../../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a>&nbsp;getCounters()</pre>
<div class="block">Return the performance counters for the write cacher.</div>
</li>
</ul>
<a name="registerWriteStatus(long, int, char)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerWriteStatus</h4>
<pre>protected&nbsp;void&nbsp;registerWriteStatus(long&nbsp;offset,
                       int&nbsp;length,
                       char&nbsp;action)</pre>
</li>
</ul>
<a name="setRecordMap(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRecordMap</h4>
<pre>public&nbsp;void&nbsp;setRecordMap(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;&nbsp;map)</pre>
</li>
</ul>
<a name="getLastOffset()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastOffset</h4>
<pre>public&nbsp;long&nbsp;getLastOffset()</pre>
<div class="block">Used by the HAWriteMessage to retrieve the nextOffset as implied by the
 recordMap</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the last offset value</dd></dl>
</li>
</ul>
<a name="resetRecordMapFromBuffer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetRecordMapFromBuffer</h4>
<pre>public&nbsp;void&nbsp;resetRecordMapFromBuffer()
                              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Hook to rebuild RecordMetadata after buffer has been transferred. For the
 default <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> this is a single entry using firstOffset and
 current position. For scattered writes, it uses a map with the addr,
 size, and data inlined.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache.FileChannelScatteredWriteCache</code></a></dd></dl>
</li>
</ul>
<a name="resetRecordMapFromBuffer(java.nio.ByteBuffer, java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetRecordMapFromBuffer</h4>
<pre>protected&nbsp;void&nbsp;resetRecordMapFromBuffer(<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;buf,
                            <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../com/bigdata/io/writecache/WriteCache.RecordMetadata.html" title="class in com.bigdata.io.writecache">WriteCache.RecordMetadata</a>&gt;&nbsp;recordMap)</pre>
<div class="block">Overridden by
 <a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html#resetRecordMapFromBuffer(java.nio.ByteBuffer,%20java.util.Map)"><code>WriteCache.FileChannelScatteredWriteCache.resetRecordMapFromBuffer(ByteBuffer, Map)</code></a>
 .</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>buf</code> - </dd><dd><code>recordMap</code> - </dd></dl>
</li>
</ul>
<a name="closeForWrites()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>closeForWrites</h4>
<pre>public&nbsp;void&nbsp;closeForWrites()
                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a>,
                           <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Called from <a href="../../../../com/bigdata/io/writecache/WriteCacheService.html" title="class in com.bigdata.io.writecache"><code>WriteCacheService</code></a> to lock buffer content immediately
 prior to flushing and HA pipline replication. Neither the internal buffer
 state nor the <a href="../../../../com/bigdata/io/writecache/WriteCache.html#recordMap"><code>recordMap</code></a> may be changed once the
 <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> has been closed for writes. This is necessary to
 provide 100% binary replication. Otherwise the stores can differ in the
 data in freed allocation slots.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code></dd></dl>
</li>
</ul>
<a name="isClosedForWrites()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isClosedForWrites</h4>
<pre>public&nbsp;boolean&nbsp;isClosedForWrites()</pre>
</li>
</ul>
<a name="allocate(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allocate</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;allocate(int&nbsp;nbytes)
                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a>,
                           <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Allocate space for a record of the given length on this
 <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>nbytes</code> - The size of the record.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A view of the allocation on the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> -or-
         <code>null</code> if there is not enough room in this
         <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> for the allocation.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if the <a href="../../../../com/bigdata/io/writecache/WriteCache.html" title="class in com.bigdata.io.writecache"><code>WriteCache</code></a> has been <a href="../../../../com/bigdata/io/writecache/WriteCache.html#close()"><code>closed</code></a>.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - if the lock could not be acquired.</dd></dl>
</li>
</ul>
<a name="getReferenceCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReferenceCount</h4>
<pre>public&nbsp;int&nbsp;getReferenceCount()</pre>
</li>
</ul>
<a name="incrementReferenceCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>incrementReferenceCount</h4>
<pre>public&nbsp;int&nbsp;incrementReferenceCount()</pre>
<div class="block">Called when a new reference is acquired</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>current reference count</dd></dl>
</li>
</ul>
<a name="decrementReferenceCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decrementReferenceCount</h4>
<pre>public&nbsp;int&nbsp;decrementReferenceCount()</pre>
<div class="block">Although public, it is designed to be used by the WriteCacheService
 with a memoizer pattern to support concurrent reads to
 read cache buffers.
 
 Called when a reference is released.  The return
 value should be tested and if zero the cache should
 be returned to the clean list.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>current reference count</dd></dl>
</li>
</ul>
<a name="contains(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>contains</h4>
<pre>public&nbsp;boolean&nbsp;contains(long&nbsp;offset)</pre>
<div class="block">Checks if cache recordMap contains address offset</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>offset</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/WriteCache.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/bigdata/io/writecache/TestWriteCacheServiceLifetime.html" title="class in com.bigdata.io.writecache"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../com/bigdata/io/writecache/WriteCache.FileChannelScatteredWriteCache.html" title="class in com.bigdata.io.writecache"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/bigdata/io/writecache/WriteCache.html" target="_top">Frames</a></li>
<li><a href="WriteCache.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
