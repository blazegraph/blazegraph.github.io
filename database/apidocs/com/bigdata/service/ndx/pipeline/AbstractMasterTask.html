<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Mon Mar 18 18:55:10 UTC 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AbstractMasterTask (Blazegraph Database Platform 2.1.5 API)</title>
<meta name="date" content="2019-03-18">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AbstractMasterTask (Blazegraph Database Platform 2.1.5 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractMasterTask.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTestCase.html" title="class in com.bigdata.service.ndx.pipeline"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" target="_top">Frames</a></li>
<li><a href="AbstractMasterTask.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.service.ndx.pipeline</div>
<h2 title="Class AbstractMasterTask" class="title">Class AbstractMasterTask&lt;H extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractMasterStats</a>&lt;L,? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;,E,S extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtask</a>,L&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../com/bigdata/util/concurrent/AbstractHaltableProcess.html" title="class in com.bigdata.util.concurrent">com.bigdata.util.concurrent.AbstractHaltableProcess</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.service.ndx.pipeline.AbstractMasterTask&lt;H,E,S,L&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl><dt><span class="strong">Type Parameters:</span></dt><dd><code>H</code> - The generic type of the value returned by <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html?is-external=true#call()" title="class or interface in java.util.concurrent"><code>Callable.call()</code></a>
            for the master.</dd><dd><code>E</code> - The generic type of the elements in the chunks stored in the
            <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath"><code>BlockingBuffer</code></a>.</dd><dd><code>S</code> - The generic type of the subtask implementation class.</dd><dd><code>L</code> - The generic type of the locator object used to lookup a subtask in
            the internal map (must be unique and must implement hashCode() and
            equals() per their contracts).</dd></dl>
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html" title="interface in com.bigdata.service.ndx.pipeline">IMasterTask</a>&lt;E,H&gt;, <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html?is-external=true" title="class or interface in java.util.concurrent">Callable</a>&lt;H&gt;</dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractPendingSetMasterTask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractPendingSetMasterTask</a>, <a href="../../../../../com/bigdata/service/ndx/pipeline/IndexWriteTask.html" title="class in com.bigdata.service.ndx.pipeline">IndexWriteTask</a>, <a href="../../../../../com/bigdata/service/ndx/pipeline/MockMaster.html" title="class in com.bigdata.service.ndx.pipeline">MockMaster</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">AbstractMasterTask&lt;H extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractMasterStats</a>&lt;L,? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;,E,S extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtask</a>,L&gt;</span>
extends <a href="../../../../../com/bigdata/util/concurrent/AbstractHaltableProcess.html" title="class in com.bigdata.util.concurrent">AbstractHaltableProcess</a>
implements <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html?is-external=true" title="class or interface in java.util.concurrent">Callable</a>&lt;H&gt;, <a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html" title="interface in com.bigdata.service.ndx.pipeline">IMasterTask</a>&lt;E,H&gt;</pre>
<div class="block">Abstract base class for a master task which consumes chunks of elements
 written onto a <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath"><code>BlockingBuffer</code></a> and distributes those chunks to
 subtasks according to some abstraction which is not defined by this class.
 
 <h3>Design discussion</h3>
 
 The asynchronous write API exposes a blocking buffer to the application which
 accepts concurrent writes of <a href="../../../../../com/bigdata/btree/keys/KVO.html" title="class in com.bigdata.btree.keys"><code>KVO</code></a>[] chunks, in which each <a href="../../../../../com/bigdata/btree/keys/KVO.html" title="class in com.bigdata.btree.keys"><code>KVO</code></a>
 represents a tuple to be written on a scale-out index. The buffer is drained
 by a master task, which transfers chunks to sinks tasks, each of which writes
 on a specific index partition.
 <p>
 The master is provisioned with a CTOR which is used to convert the
 <a href="../../../../../com/bigdata/btree/keys/KVO.html" title="class in com.bigdata.btree.keys"><code>KVO</code></a>s into <code>unsigned byte[]</code> <i>keys</i> and
 <code>byte[]</code> <i>values</i> for writes on the scale-out index. The
 master may be provisioned with a mechanism to filter out duplicate tuples.
 <p>
 Writes on the index partitions are asynchronous with respect to the
 application. However, a <a href="../../../../../com/bigdata/service/ndx/pipeline/KVOC.html" title="class in com.bigdata.service.ndx.pipeline"><code>KVOC</code></a> / <a href="../../../../../com/bigdata/service/ndx/pipeline/KVOLatch.html" title="class in com.bigdata.service.ndx.pipeline"><code>KVOLatch</code></a> combination can be
 used to coordinate notification when some set of tuples of interest have been
 successfully written onto the scale-out index. This combination can also be
 used to pass back values from the write operation if they are assigned by
 side-effect onto the <a href="../../../../../com/bigdata/btree/keys/KVO.html#obj"><code>KVO.obj</code></a> reference.
 <p>
 The asynchronous write implementation is divided into a master, with an input
 queue and a redirect queue, and sinks, each of which has an input queue and
 writes chunks onto a specific index partition for the scale-out index. The
 input queues for the master and the sinks are bounded. The redirect input
 queue is unbounded. The master and each sink is assigned its own worker
 thread.
 <p>
 The master transfers chunks from its input queue to the sinks. It polls the
 redirect queue for a chunk. If that queue was empty, then it polls a chunk
 from the input queue. If no chunks are available, it needs to check again.
 The master stops polling the input queue when the input queue is closed, but
 it continues to drain the redirect queue until all sinks are done or the
 master is canceled.
 <p>
 Note: The requirement for polling arises because: (a) we are not coordinating
 signals for the arrival of a chunk on the input or redirect queues; and (b) a
 chunk can be redirected at any time if there is an outstanding write by a
 sink on an index partition.
 <p>
 The atomic decision to terminate the master is made using a <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#lock"><code>lock</code></a>.
 The lock is specific to the life cycle of the sinks. The lock is held when a
 sink is created. When a sink terminates, its last action is to grab the lock
 and signal the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#subtaskDone"><code>subtaskDone</code></a> <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html?is-external=true" title="class or interface in java.util.concurrent.locks"><code>Condition</code></a>. The master terminates
 when, while holding the lock, it observes that no sinks are running AND the
 redirect queue is empty. Since chunks are placed onto the redirect queue by
 sinks (and there are no sinks running) and by the master (which is not
 issuing a redirect since it is running its termination logic) these criteria
 are sufficient for termination. However, the sink must ensure that its buffer
 is closed before it terminates, even if it terminates by exception, so that
 an attempt to transfer a chunk to the sink will not block forever.
 <p>
 Once the master is holding a chunk, it splits the chunk into a set of dense
 chunks correlated with the locators of the index partitions on which those
 chunks will be written. The split operation is NOT atomic, but it is
 consistent in the following sense. If a <a href="../../../../../com/bigdata/service/Split.html" title="class in com.bigdata.service"><code>Split</code></a> is identified based on
 old information, then the chunk will be directed to an index partition which
 no longer exists. An attempt to write on that index partition will result in
 a stale locator exception, which is handled.
 <p>
 Once the chunk has been split, the split chunks are transferred to the
 appropriate sink(s). Since the master is not holding any locks, a blocking
 put() may be used to transfer the chunk to sink.
 <p>
 The sink drain chunks from its input queue. If the input queue is empty and
 the idle timeout expires before a chunk is transferred to the input queue,
 then the sink will be asynchronously closed and an
 <a href="../../../../../com/bigdata/service/ndx/pipeline/IdleTimeoutException.html" title="class in com.bigdata.service.ndx.pipeline"><code>IdleTimeoutException</code></a> will be set on the input queue. If the master
 attempts to transfer a chunk to the sink's input queue after the idle
 timeout, then an exception wrapping the idle timeout exception will be
 thrown. The master handles the wrapped idle timeout exception by re-opening
 the sink and will retry the transfer of the chunk to the (new) sink's input
 queue. After the sink closes it's input queue by an idle timeout, it will
 continue to drain the input queue until it is empty, at which point the sink
 will terminate (this handles the case where the master concurrently
 transferred a chunk to the sink's input queue before it was closed by the
 idle time out).
 <p>
 The sink combines chunks drained from its input queue until the target chunk
 size for a write is achieved or until the chunk timeout for the sink is
 exceeded. The sink then writes on the index partition corresponding to its
 locator. This write occurs in the thread assigned to the sink and the sink
 will block during the write request.
 <p>
 If a stale locator exception is received by the sink in response to a write,
 it will: (a) notify the client of the stale locator exception; (b) close the
 input queue, setting the stale locator exception as the cause; (c) place the
 chunk for that write onto the master's (unbounded) redirect queue; and (d)
 drain its input queue and transfer the chunks to the master's redirect queue.
 <p>
 If the master attempts to transfer a chunk to the input queue for a sink
 which has closed its input queue in response to a stale locator exception,
 then an exception will be thrown with the stale locator exception as the
 inner cause. The master will trap that exception and place the chunk on the
 redirect queue instead.
 <p>
 If the sink RMI is successful, the sink will invoke the optional result
 handler and touch each tuple in the chunk using KVO#done(). These protocols
 can be used to pass results from asynchronous writes back to the application.</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>$Id$</dd>
<dt><span class="strong">Author:</span></dt>
  <dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../com/bigdata/service/ndx/ISplitter.html" title="interface in com.bigdata.service.ndx"><code>ISplitter</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#buffer">buffer</a></strong></code>
<div class="block">The top-level buffer on which the application is writing.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#log">log</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#sinkIdleTimeoutNanos">sinkIdleTimeoutNanos</a></strong></code>
<div class="block">The timeout in nanoseconds before closing an idle output sink.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#sinkPollTimeoutNanos">sinkPollTimeoutNanos</a></strong></code>
<div class="block">The time in nanoseconds that the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline"><code>sink</code></a> will wait
 inside of the <a href="../../../../../com/bigdata/relation/accesspath/IAsynchronousIterator.html" title="interface in com.bigdata.relation.accesspath"><code>IAsynchronousIterator</code></a> when it polls the iterator
 for a chunk.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../com/bigdata/relation/accesspath/IAsynchronousIterator.html" title="interface in com.bigdata.relation.accesspath">IAsynchronousIterator</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#src">src</a></strong></code>
<div class="block">The iterator draining the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#buffer"><code>buffer</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#stats">stats</a></strong></code>
<div class="block">Statistics for this (and perhaps other) masters.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#AbstractMasterTask(H,%20com.bigdata.relation.accesspath.BlockingBuffer,%20long,%20long)">AbstractMasterTask</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a>&nbsp;stats,
                  <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;&nbsp;buffer,
                  long&nbsp;sinkIdleTimeoutNanos,
                  long&nbsp;sinkPollTimeoutNanos)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#addToOutputBuffer(L,%20E[],%20int,%20int,%20boolean)">addToOutputBuffer</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
                 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&nbsp;a,
                 int&nbsp;fromIndex,
                 int&nbsp;toIndex,
                 boolean&nbsp;reopen)</code>
<div class="block">Resolves the output buffer onto which the split must be written and adds
 the data to that output buffer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#call()">call</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#getBuffer()">getBuffer</a></strong>()</code>
<div class="block">The top-level buffer on which the application is writing.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#getRedirectQueueSize()">getRedirectQueueSize</a></strong>()</code>
<div class="block">The #of chunks on the master's redirectQueue.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">S</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#getSink(L,%20boolean)">getSink</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
       boolean&nbsp;reopen)</code>
<div class="block">Return the sink for the locator.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#getStats()">getStats</a></strong>()</code>
<div class="block">The statistics.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#handleChunk(E[],%20boolean)">handleChunk</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&nbsp;chunk,
           boolean&nbsp;reopen)</code>
<div class="block">Handle the next chunk of elements from the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#buffer"><code>buffer</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#mapOperationOverSubtasks(com.bigdata.service.ndx.pipeline.SubtaskOp)">mapOperationOverSubtasks</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/SubtaskOp.html" title="interface in com.bigdata.service.ndx.pipeline">SubtaskOp</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">S</a>&gt;&nbsp;op)</code>
<div class="block">Maps an operation across the subtasks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#moveSinkToFinishedQueueAtomically(L,%20com.bigdata.service.ndx.pipeline.AbstractSubtask)">moveSinkToFinishedQueueAtomically</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
                                 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtask</a>&nbsp;sink)</code>
<div class="block">Transfer a sink from <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#sinks"><code>sinks</code></a> to <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#finishedSubtaskQueue"><code>finishedSubtaskQueue</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">S</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#newSubtask(L,%20com.bigdata.relation.accesspath.BlockingBuffer)">newSubtask</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
          <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;&nbsp;out)</code>
<div class="block">Factory for a new subtask.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#newSubtaskBuffer()">newSubtaskBuffer</a></strong>()</code>
<div class="block">Factory for a new buffer for a subtask.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#nothingPending()">nothingPending</a></strong>()</code>
<div class="block">Extension hook for implementations where the clients accept work for
 asynchronous processing and notify the master as work items completed
 successfully or fail.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#notifySubtaskDone(com.bigdata.service.ndx.pipeline.AbstractSubtask)">notifySubtaskDone</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtask</a>&nbsp;subtask)</code>
<div class="block">Notify the master that a subtask is done.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#redirectChunk(E[])">redirectChunk</a></strong>(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&nbsp;chunk)</code>
<div class="block">Places a chunk onto the master's redirectQueue.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#submitSubtask(java.util.concurrent.FutureTask)">submitSubtask</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/FutureTask.html?is-external=true" title="class or interface in java.util.concurrent">FutureTask</a>&lt;? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;&nbsp;subtask)</code>
<div class="block">Submit the subtask to an <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executor.html?is-external=true" title="class or interface in java.util.concurrent"><code>Executor</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#willShutdown()">willShutdown</a></strong>()</code>
<div class="block">Extension hook invoked when the master's buffer is exhausted by
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#awaitAll()"><code>awaitAll()</code></a>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.bigdata.util.concurrent.AbstractHaltableProcess">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.bigdata.util.concurrent.<a href="../../../../../com/bigdata/util/concurrent/AbstractHaltableProcess.html" title="class in com.bigdata.util.concurrent">AbstractHaltableProcess</a></h3>
<code><a href="../../../../../com/bigdata/util/concurrent/AbstractHaltableProcess.html#halt(T)">halt</a>, <a href="../../../../../com/bigdata/util/concurrent/AbstractHaltableProcess.html#halted()">halted</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>log</h4>
<pre>protected static final transient&nbsp;org.apache.log4j.Logger log</pre>
</li>
</ul>
<a name="buffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buffer</h4>
<pre>protected final&nbsp;<a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt; buffer</pre>
<div class="block">The top-level buffer on which the application is writing.</div>
</li>
</ul>
<a name="src">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>src</h4>
<pre>protected final&nbsp;<a href="../../../../../com/bigdata/relation/accesspath/IAsynchronousIterator.html" title="interface in com.bigdata.relation.accesspath">IAsynchronousIterator</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt; src</pre>
<div class="block">The iterator draining the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#buffer"><code>buffer</code></a>.
 <p>
 Note: DO NOT close this iterator from within <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#call()"><code>call()</code></a> as that
 would cause this task to interrupt itself!</div>
</li>
</ul>
<a name="stats">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stats</h4>
<pre>public final&nbsp;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a> extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractMasterStats</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>,? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt; stats</pre>
<div class="block">Statistics for this (and perhaps other) masters.</div>
</li>
</ul>
<a name="sinkIdleTimeoutNanos">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sinkIdleTimeoutNanos</h4>
<pre>protected final&nbsp;long sinkIdleTimeoutNanos</pre>
<div class="block">The timeout in nanoseconds before closing an idle output sink.</div>
</li>
</ul>
<a name="sinkPollTimeoutNanos">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>sinkPollTimeoutNanos</h4>
<pre>protected final&nbsp;long sinkPollTimeoutNanos</pre>
<div class="block">The time in nanoseconds that the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline"><code>sink</code></a> will wait
 inside of the <a href="../../../../../com/bigdata/relation/accesspath/IAsynchronousIterator.html" title="interface in com.bigdata.relation.accesspath"><code>IAsynchronousIterator</code></a> when it polls the iterator
 for a chunk. If this value is too large then the sink will block for
 noticeable lengths of time and will be less responsive to interrupts.
 Something in the 10s of milliseconds is appropriate.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="AbstractMasterTask(com.bigdata.service.ndx.pipeline.AbstractMasterStats,com.bigdata.relation.accesspath.BlockingBuffer,long,long)">
<!--   -->
</a><a name="AbstractMasterTask(H, com.bigdata.relation.accesspath.BlockingBuffer, long, long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AbstractMasterTask</h4>
<pre>public&nbsp;AbstractMasterTask(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a>&nbsp;stats,
                  <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;&nbsp;buffer,
                  long&nbsp;sinkIdleTimeoutNanos,
                  long&nbsp;sinkPollTimeoutNanos)</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>stats</code> - Statistics for the master.</dd><dd><code>buffer</code> - The buffer on which data is written by the application and
            from which it is drained by the master.</dd><dd><code>sinkIdleTimeoutNanos</code> - The time in nanoseconds after which an idle sink will be
            closed. Any buffered writes are flushed when the sink is
            closed. This must be GTE the <i>sinkChunkTimeout</i>
            otherwise the sink will decide that it is idle when it was
            just waiting for enough data to prepare a full chunk.</dd><dd><code>sinkPollTimeoutNanos</code> - The time in nanoseconds that the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline"><code>sink</code></a>
            will wait inside of the <a href="../../../../../com/bigdata/relation/accesspath/IAsynchronousIterator.html" title="interface in com.bigdata.relation.accesspath"><code>IAsynchronousIterator</code></a> when it
            polls the iterator for a chunk. If this value is too large
            then the sink will block for noticeable lengths of time and
            will be less responsive to interrupts. Something in the 10s of
            milliseconds is appropriate.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getRedirectQueueSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRedirectQueueSize</h4>
<pre>public final&nbsp;int&nbsp;getRedirectQueueSize()</pre>
<div class="block">The #of chunks on the master's redirectQueue.</div>
</li>
</ul>
<a name="redirectChunk(java.lang.Object[])">
<!--   -->
</a><a name="redirectChunk(E[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>redirectChunk</h4>
<pre>protected final&nbsp;void&nbsp;redirectChunk(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&nbsp;chunk)
                            throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Places a chunk onto the master's redirectQueue.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>chunk</code> - The chunk.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="getBuffer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBuffer</h4>
<pre>public&nbsp;<a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;&nbsp;getBuffer()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html#getBuffer()">IMasterTask</a></code></strong></div>
<div class="block">The top-level buffer on which the application is writing.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html#getBuffer()">getBuffer</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html" title="interface in com.bigdata.service.ndx.pipeline">IMasterTask</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>,<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a> extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractMasterStats</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>,? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;&gt;</code></dd>
</dl>
</li>
</ul>
<a name="mapOperationOverSubtasks(com.bigdata.service.ndx.pipeline.SubtaskOp)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mapOperationOverSubtasks</h4>
<pre>public&nbsp;void&nbsp;mapOperationOverSubtasks(<a href="../../../../../com/bigdata/service/ndx/pipeline/SubtaskOp.html" title="interface in com.bigdata.service.ndx.pipeline">SubtaskOp</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">S</a>&gt;&nbsp;op)
                              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a>,
                                     <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutionException.html?is-external=true" title="class or interface in java.util.concurrent">ExecutionException</a></pre>
<div class="block">Maps an operation across the subtasks.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>op</code> - The operation, which should be light weight</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutionException.html?is-external=true" title="class or interface in java.util.concurrent">ExecutionException</a></code> - if a subtask throws an exception.</dd></dl>
</li>
</ul>
<a name="notifySubtaskDone(com.bigdata.service.ndx.pipeline.AbstractSubtask)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>notifySubtaskDone</h4>
<pre>protected&nbsp;void&nbsp;notifySubtaskDone(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtask</a>&nbsp;subtask)
                          throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Notify the master that a subtask is done. The subtask is placed onto the
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#finishedSubtaskQueue"><code>finishedSubtaskQueue</code></a> queue. The master polls that queue in
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#call()"><code>call()</code></a> and <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#awaitAll()"><code>awaitAll()</code></a> and checks the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html?is-external=true" title="class or interface in java.util.concurrent"><code>Future</code></a> of
 each finished subtask using <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#drainFutures()"><code>drainFutures()</code></a>. If a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html?is-external=true" title="class or interface in java.util.concurrent"><code>Future</code></a>
 reports an error, then the master is halted. This is how we ensure that
 all subtasks complete normally.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>subtask</code> - The subtask.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="getStats()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStats</h4>
<pre>public&nbsp;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a>&nbsp;getStats()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html#getStats()">IMasterTask</a></code></strong></div>
<div class="block">The statistics.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html#getStats()">getStats</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/bigdata/service/ndx/pipeline/IMasterTask.html" title="interface in com.bigdata.service.ndx.pipeline">IMasterTask</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>,<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a> extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractMasterStats</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>,? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;&gt;</code></dd>
</dl>
</li>
</ul>
<a name="call()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>call</h4>
<pre>public&nbsp;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a>&nbsp;call()
                                                                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html?is-external=true#call()" title="class or interface in java.util.concurrent">call</a></code>&nbsp;in interface&nbsp;<code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html?is-external=true" title="class or interface in java.util.concurrent">Callable</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">H</a> extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractMasterStats</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>,? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;&gt;</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code></dd></dl>
</li>
</ul>
<a name="handleChunk(java.lang.Object[],boolean)">
<!--   -->
</a><a name="handleChunk(E[], boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleChunk</h4>
<pre>protected abstract&nbsp;void&nbsp;handleChunk(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&nbsp;chunk,
               boolean&nbsp;reopen)
                             throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Handle the next chunk of elements from the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#buffer"><code>buffer</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>chunk</code> - A chunk.</dd><dd><code>reopen</code> - When <code>false</code> it is an error if the output buffer
            has been closed. When <code>true</code> the output buffer
            will be (re-)opened as necessary. This will be
            <code>false</code> when invoked by <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#call()"><code>call()</code></a> (since
            the output buffers are not closed until the master's buffer is
            closed) and should be <code>true</code> if you are handling
            redirects.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="nothingPending()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nothingPending</h4>
<pre>protected&nbsp;boolean&nbsp;nothingPending()</pre>
<div class="block">Extension hook for implementations where the clients accept work for
 asynchronous processing and notify the master as work items completed
 successfully or fail. The <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="class in com.bigdata.service.ndx.pipeline"><code>AbstractMasterTask</code></a> will not terminate
 unless this method returns <code>true</code> when queried while holding
 the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#lock"><code>lock</code></a>. A true return indicates that there are no pending
 work items. The default implementation returns <code>true</code>.
 <p>
 The work perform by the client must be idempotent (it must be safe to
 re-perform the operation). Pending work items may be in an unknown state,
 the master may submit the same work item to multiple clients (where that
 is permitted by the locator semantics), the client task may fail before
 the work item is complete, and a failed client can cause work items
 associated with that client to be posted to another client.
 <p>
 To handle master termination, the pending set must track outstanding work
 items. Those work item should be removed from the pending set as soon as
 any client has successfully completed that work item (since the work is
 idempotent).
 <p>
 To handle client failure, the subtask must track the pending set for its
 client. If the client dies, then the subtask must handle the client by
 placing all pending work items for that client (including any in the
 chunk for the current request) onto the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#redirectQueue"><code>redirectQueue</code></a>.</div>
</li>
</ul>
<a name="willShutdown()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>willShutdown</h4>
<pre>protected&nbsp;void&nbsp;willShutdown()
                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Extension hook invoked when the master's buffer is exhausted by
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#awaitAll()"><code>awaitAll()</code></a>. The default implementation is a NOP.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="getSink(java.lang.Object,boolean)">
<!--   -->
</a><a name="getSink(L, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSink</h4>
<pre>protected&nbsp;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">S</a>&nbsp;getSink(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
        boolean&nbsp;reopen)
                                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Return the sink for the locator. The sink is created if it does not exist
 using <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#newSubtaskBuffer()"><code>newSubtaskBuffer()</code></a> and
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#newSubtask(L,%20com.bigdata.relation.accesspath.BlockingBuffer)"><code>newSubtask(Object, BlockingBuffer)</code></a>.
 <p>
 Note: The caller is single threaded since this is invoked from the
 master's thread. This code depends on that assumption.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>locator</code> - The locator (unique subtask key).</dd><dd><code>reopen</code> - <code>true</code> IFF a closed buffer should be re-opened
            (in fact, this causes a new buffer to be created and the new
            buffer will be drained by a new
            <a href="../../../../../com/bigdata/service/ndx/pipeline/IndexPartitionWriteTask.html" title="class in com.bigdata.service.ndx.pipeline"><code>IndexPartitionWriteTask</code></a>).</dd>
<dt><span class="strong">Returns:</span></dt><dd>The sink for that locator.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the argument is <code>null</code>.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - if interrupted.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/RuntimeException.html?is-external=true" title="class or interface in java.lang">RuntimeException</a></code> - if <a href="../../../../../com/bigdata/util/concurrent/AbstractHaltableProcess.html#halted()"><code>AbstractHaltableProcess.halted()</code></a></dd></dl>
</li>
</ul>
<a name="newSubtaskBuffer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newSubtaskBuffer</h4>
<pre>protected abstract&nbsp;<a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;&nbsp;newSubtaskBuffer()</pre>
<div class="block">Factory for a new buffer for a subtask.</div>
</li>
</ul>
<a name="newSubtask(java.lang.Object,com.bigdata.relation.accesspath.BlockingBuffer)">
<!--   -->
</a><a name="newSubtask(L, com.bigdata.relation.accesspath.BlockingBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newSubtask</h4>
<pre>protected abstract&nbsp;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">S</a>&nbsp;newSubtask(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
           <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath">BlockingBuffer</a>&lt;<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&gt;&nbsp;out)</pre>
<div class="block">Factory for a new subtask.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>locator</code> - The unique key for the subtask.</dd><dd><code>out</code> - The <a href="../../../../../com/bigdata/relation/accesspath/BlockingBuffer.html" title="class in com.bigdata.relation.accesspath"><code>BlockingBuffer</code></a> on which the master will write for
            that subtask.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The subtask.</dd></dl>
</li>
</ul>
<a name="submitSubtask(java.util.concurrent.FutureTask)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>submitSubtask</h4>
<pre>protected abstract&nbsp;void&nbsp;submitSubtask(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/FutureTask.html?is-external=true" title="class or interface in java.util.concurrent">FutureTask</a>&lt;? extends <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtaskStats.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtaskStats</a>&gt;&nbsp;subtask)</pre>
<div class="block">Submit the subtask to an <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executor.html?is-external=true" title="class or interface in java.util.concurrent"><code>Executor</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>subtask</code> - The <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/FutureTask.html?is-external=true" title="class or interface in java.util.concurrent"><code>FutureTask</code></a> used to execute thee subtask.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="https://sourceforge.net/apps/trac/bigdata/ticket/707">
      BlockingBuffer.close() does not unblock threads </a></dd></dl>
</li>
</ul>
<a name="moveSinkToFinishedQueueAtomically(java.lang.Object,com.bigdata.service.ndx.pipeline.AbstractSubtask)">
<!--   -->
</a><a name="moveSinkToFinishedQueueAtomically(L, com.bigdata.service.ndx.pipeline.AbstractSubtask)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>moveSinkToFinishedQueueAtomically</h4>
<pre>protected&nbsp;void&nbsp;moveSinkToFinishedQueueAtomically(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
                                     <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline">AbstractSubtask</a>&nbsp;sink)
                                          throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Transfer a sink from <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#sinks"><code>sinks</code></a> to <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#finishedSubtaskQueue"><code>finishedSubtaskQueue</code></a>. The
 entry for the locator is removed from <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#sinks"><code>sinks</code></a> atomically IFF that
 map the given <i>sink</i> is associated with the given <i>locator</i> in
 that map.
 <p>
 This is done atomically using the <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#lock"><code>lock</code></a>. This is invoked both by
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html#call()"><code>AbstractSubtask.call()</code></a> (when it is preparing to exit call()) and
 by <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#getSink(L,%20boolean)"><code>getSink(Object, boolean)</code></a> (when it discovers that the sink for
 a locator is closed, but not yet finished with its work).
 <p>
 Note: The sink MUST be atomically transferred from <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#sinks"><code>sinks</code></a> to
 <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#finishedSubtaskQueue"><code>finishedSubtaskQueue</code></a> and <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html#awaitAll()"><code>awaitAll()</code></a> MUST verify that
 both are empty in order for the termination condition to be atomic.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>locator</code> - The locator.</dd><dd><code>sink</code> - The sink.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="addToOutputBuffer(java.lang.Object,java.lang.Object[],int,int,boolean)">
<!--   -->
</a><a name="addToOutputBuffer(L, E[], int, int, boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>addToOutputBuffer</h4>
<pre>protected&nbsp;void&nbsp;addToOutputBuffer(<a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">L</a>&nbsp;locator,
                     <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" title="type parameter in AbstractMasterTask">E</a>[]&nbsp;a,
                     int&nbsp;fromIndex,
                     int&nbsp;toIndex,
                     boolean&nbsp;reopen)
                          throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Resolves the output buffer onto which the split must be written and adds
 the data to that output buffer.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>split</code> - The <a href="../../../../../com/bigdata/service/Split.html" title="class in com.bigdata.service"><code>Split</code></a> identifies both the tuples to be dispatched
            and the <a href="../../../../../com/bigdata/mdi/PartitionLocator.html" title="class in com.bigdata.mdi"><code>PartitionLocator</code></a> on which they must be
            written.</dd><dd><code>a</code> - The array of tuples. Only those tuples addressed by the
            <i>split</i> will be written onto the output buffer.</dd><dd><code>reopen</code> - <code>true</code> IFF a closed buffer should be re-opened (in
            fact, this causes a new buffer to be created and the new
            buffer will be drained by a new <a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractSubtask.html" title="class in com.bigdata.service.ndx.pipeline"><code>AbstractSubtask</code></a>).</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - if the thread is interrupted.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractMasterTask.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterStats.html" title="class in com.bigdata.service.ndx.pipeline"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../com/bigdata/service/ndx/pipeline/AbstractMasterTestCase.html" title="class in com.bigdata.service.ndx.pipeline"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/bigdata/service/ndx/pipeline/AbstractMasterTask.html" target="_top">Frames</a></li>
<li><a href="AbstractMasterTask.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2019 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
