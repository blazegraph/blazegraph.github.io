<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_51) on Thu Jan 21 00:31:00 EST 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AbstractTransactionService (Blazegraph Database Platform 2.0.0-SNAPSHOT API)</title>
<meta name="date" content="2016-01-21">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AbstractTransactionService (Blazegraph Database Platform 2.0.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":6,"i3":10,"i4":10,"i5":10,"i6":10,"i7":6,"i8":10,"i9":10,"i10":6,"i11":6,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":6,"i20":10,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10,"i27":10,"i28":10,"i29":10,"i30":10,"i31":10,"i32":10,"i33":10,"i34":10,"i35":10,"i36":10,"i37":10,"i38":10,"i39":10,"i40":10,"i41":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractTransactionService.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/service/AbstractServiceLoadHelperWithScores.html" title="class in com.bigdata.service"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/bigdata/service/AbstractTransactionService.Options.html" title="interface in com.bigdata.service"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/service/AbstractTransactionService.html" target="_top">Frames</a></li>
<li><a href="AbstractTransactionService.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.service</div>
<h2 title="Class AbstractTransactionService" class="title">Class AbstractTransactionService</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">com.bigdata.service.AbstractService</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.service.AbstractTransactionService</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../com/bigdata/counters/ICounterSetAccess.html" title="interface in com.bigdata.counters">ICounterSetAccess</a>, <a href="../../../com/bigdata/journal/ITimestampService.html" title="interface in com.bigdata.journal">ITimestampService</a>, <a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a>, <a href="../../../com/bigdata/service/IService.html" title="interface in com.bigdata.service">IService</a>, <a href="../../../com/bigdata/service/IServiceShutdown.html" title="interface in com.bigdata.service">IServiceShutdown</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/rmi/Remote.html?is-external=true" title="class or interface in java.rmi">Remote</a></dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../com/bigdata/service/AbstractHATransactionService.html" title="class in com.bigdata.service">AbstractHATransactionService</a>, <a href="../../../com/bigdata/service/DistributedTransactionService.html" title="class in com.bigdata.service">DistributedTransactionService</a>, <a href="../../../com/bigdata/journal/TestTransactionService.MockTransactionService.html" title="class in com.bigdata.journal">TestTransactionService.MockTransactionService</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">AbstractTransactionService</span>
extends <a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a>
implements <a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a>, <a href="../../../com/bigdata/service/IServiceShutdown.html" title="interface in com.bigdata.service">IServiceShutdown</a>, <a href="../../../com/bigdata/counters/ICounterSetAccess.html" title="interface in com.bigdata.counters">ICounterSetAccess</a></pre>
<div class="block">Centralized transaction manager service. In response to a client request, the
 transaction manager will distribute prepare/commit or abort operations to all
 data services on which writes were made by a transaction. The transaction
 manager also provides global timestamps required for non-transactional commit
 points and various other purposes.</div>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>$Id$</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.Options.html" title="interface in com.bigdata.service">AbstractTransactionService.Options</a></span></code>
<div class="block">Options understood by this service.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a></span></code>
<div class="block">Transaction state as maintained by the <a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal"><code>ITransactionService</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#ERR_NO_SUCH">ERR_NO_SUCH</a></span></code>
<div class="block">If the transaction is not known to this service.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#ERR_NOT_ACTIVE">ERR_NOT_ACTIVE</a></span></code>
<div class="block">If a transaction is no longer active.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#ERR_READ_ONLY">ERR_READ_ONLY</a></span></code>
<div class="block">If the transaction is read-only and a write operation was requested.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#ERR_SERVICE_NOT_AVAIL">ERR_SERVICE_NOT_AVAIL</a></span></code>
<div class="block">If the transaction service is not in a run state which permits the
 requested operation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantLock.html?is-external=true" title="class or interface in java.util.concurrent.locks">ReentrantLock</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#lock">lock</a></span></code>
<div class="block">A lock used to serialize certain operations that must be atomic with
 respect to the state of the transaction service.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#log">log</a></span></code>
<div class="block">Logger.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html?is-external=true" title="class or interface in java.util.concurrent.locks">Condition</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#txDeactivate">txDeactivate</a></span></code>
<div class="block">Signaled by <a href="../../../com/bigdata/service/AbstractTransactionService.html#deactivateTx-com.bigdata.service.AbstractTransactionService.TxState-"><code>deactivateTx(TxState)</code></a> and based on <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#AbstractTransactionService-java.util.Properties-">AbstractTransactionService</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html?is-external=true" title="class or interface in java.util">Properties</a>&nbsp;properties)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#abort-long-">abort</a></span>(long&nbsp;tx)</code>
<div class="block">Abort the transaction (asynchronous).</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#abortAllTx--">abortAllTx</a></span>()</code>
<div class="block">Abort all active transactions.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#abortImpl-com.bigdata.service.AbstractTransactionService.TxState-">abortImpl</a></span>(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)</code>
<div class="block">Implementation must abort the tx on the journal (standalone) or on each
 data service (federation) on which it has written.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#activateTx-com.bigdata.service.AbstractTransactionService.TxState-">activateTx</a></span>(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)</code>
<div class="block">Adds the transaction from to the local tables.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#assertOpen--">assertOpen</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#assignTransactionIdentifier-long-">assignTransactionIdentifier</a></span>(long&nbsp;timestamp)</code>
<div class="block">Assign a transaction identifier for a new transaction.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#commit-long-">commit</a></span>(long&nbsp;tx)</code>
<div class="block">Request commit of the transaction write set.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected abstract long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#commitImpl-com.bigdata.service.AbstractTransactionService.TxState-">commitImpl</a></span>(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)</code>
<div class="block">Implementation must either single-phase commit (standalone journal or a
 transaction that only writes on a single data service) or 2-/3-phase
 commit (distributed transaction running on a federation).</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#deactivateTx-com.bigdata.service.AbstractTransactionService.TxState-">deactivateTx</a></span>(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)</code>
<div class="block">Removes the transaction from the local tables.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#destroy--">destroy</a></span>()</code>
<div class="block">Immediate/fast shutdown of the service and then destroys any persistent
 state associated with the service.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>protected abstract long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#findCommitTime-long-">findCommitTime</a></span>(long&nbsp;timestamp)</code>
<div class="block">Find the commit time from which the tx will read (largest commitTime LTE
 timestamp).</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>protected abstract long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#findNextCommitTime-long-">findNextCommitTime</a></span>(long&nbsp;commitTime)</code>
<div class="block">Return the commit time for the successor of that commit point have the
 specified timestamp (a commit time strictly GT the given value).</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#findUnusedTimestamp-long-long-long-java.util.concurrent.TimeUnit-">findUnusedTimestamp</a></span>(long&nbsp;commitTime,
                   long&nbsp;nextCommitTime,
                   long&nbsp;timeout,
                   <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)</code>
<div class="block">Find a valid, unused timestamp.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getAbortCount--">getAbortCount</a></span>()</code>
<div class="block">#of transaction aborted.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getActiveCount--">getActiveCount</a></span>()</code>
<div class="block">The #of open transactions in any <a href="../../../com/bigdata/journal/RunState.html" title="enum in com.bigdata.journal"><code>RunState</code></a>.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getCommitCount--">getCommitCount</a></span>()</code>
<div class="block">#of transaction committed.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getCounters--">getCounters</a></span>()</code>
<div class="block">Return the <a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters"><code>CounterSet</code></a>.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>protected <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getEarliestActiveTx--">getEarliestActiveTx</a></span>()</code>
<div class="block">Return the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service"><code>AbstractTransactionService.TxState</code></a> for the earliest active Tx -or-
 <code>null</code> if there is no active tx.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getEffectiveReleaseTimeForHA--">getEffectiveReleaseTimeForHA</a></span>()</code>
<div class="block">This method was introduced to compute the effective timestamp of the
 pinned history in support of the HA TXS.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>abstract long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getLastCommitTime--">getLastCommitTime</a></span>()</code>
<div class="block">Note: Declared abstract so that we can hide the <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io"><code>IOException</code></a>.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getMinReleaseAge--">getMinReleaseAge</a></span>()</code>
<div class="block">Return the minimum #of milliseconds of history that must be preserved.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html?is-external=true" title="class or interface in java.util">Properties</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getProperties--">getProperties</a></span>()</code>
<div class="block">An object wrapping the properties used to initialize the service.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getReadOnlyActiveCount--">getReadOnlyActiveCount</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getReadsOnTime-long-">getReadsOnTime</a></span>(long&nbsp;txId)</code>
<div class="block">Return the commit time on which the transaction is reading.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getReadWriteActiveCount--">getReadWriteActiveCount</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getReleaseTime--">getReleaseTime</a></span>()</code>
<div class="block">Return the timestamp whose historical data MAY be released.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service">TxServiceRunState</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getRunState--">getRunState</a></span>()</code>
<div class="block">Return the <a href="../../../com/bigdata/journal/RunState.html" title="enum in com.bigdata.journal"><code>RunState</code></a>.</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getServiceIface--">getServiceIface</a></span>()</code>
<div class="block">Return the most interesting interface for the service.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getStartCount--">getStartCount</a></span>()</code>
<div class="block">#of transaction started.</div>
</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>protected <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#getTxState-long-">getTxState</a></span>(long&nbsp;tx)</code>
<div class="block">Return the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service"><code>AbstractTransactionService.TxState</code></a> associated with the specified transition
 identifier.</div>
</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#isOpen--">isOpen</a></span>()</code>
<div class="block">Any state other than <a href="../../../com/bigdata/service/TxServiceRunState.html#Halted"><code>TxServiceRunState.Halted</code></a>.</div>
</td>
</tr>
<tr id="i31" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#isReleaseTimeConsensusProtocol--">isReleaseTimeConsensusProtocol</a></span>()</code>
<div class="block">Return <code>true</code> iff the release time consensus protocol is being
 used to update the releaseTime (HA and this service is either a leader or
 a follower).</div>
</td>
</tr>
<tr id="i32" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#newTx-long-">newTx</a></span>(long&nbsp;timestamp)</code>
<div class="block">Create a new transaction.</div>
</td>
</tr>
<tr id="i33" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#nextTimestamp--">nextTimestamp</a></span>()</code>
<div class="block">Return the next unique timestamp.</div>
</td>
</tr>
<tr id="i34" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#notifyCommit-long-">notifyCommit</a></span>(long&nbsp;commitTime)</code>
<div class="block">The basic implementation advances the release time periodically as
 commits occur even when there are no transactions in use.</div>
</td>
</tr>
<tr id="i35" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#setReleaseTime-long-">setReleaseTime</a></span>(long&nbsp;newValue)</code>
<div class="block">Sets the new release time.</div>
</td>
</tr>
<tr id="i36" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#setRunState-com.bigdata.service.TxServiceRunState-">setRunState</a></span>(<a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service">TxServiceRunState</a>&nbsp;newval)</code>
<div class="block">Change the <a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service"><code>TxServiceRunState</code></a>.</div>
</td>
</tr>
<tr id="i37" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#shutdown--">shutdown</a></span>()</code>
<div class="block">Polite shutdown.</div>
</td>
</tr>
<tr id="i38" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#shutdownNow--">shutdownNow</a></span>()</code>
<div class="block">Fast shutdown (not immediate since it must abort active transactions).</div>
</td>
</tr>
<tr id="i39" class="rowColor">
<td class="colFirst"><code><a href="../../../com/bigdata/service/AbstractTransactionService.html" title="class in com.bigdata.service">AbstractTransactionService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#start--">start</a></span>()</code>
<div class="block">Verifies that <a href="../../../com/bigdata/service/AbstractTransactionService.html#nextTimestamp--"><code>nextTimestamp()</code></a> will not report a time before
 <a href="../../../com/bigdata/service/AbstractTransactionService.html#getLastCommitTime--"><code>getLastCommitTime()</code></a> and then changes the <a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service"><code>TxServiceRunState</code></a>
 to <a href="../../../com/bigdata/service/TxServiceRunState.html#Running"><code>TxServiceRunState.Running</code></a>.</div>
</td>
</tr>
<tr id="i40" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#updateReleaseTime-long-com.bigdata.service.AbstractTransactionService.TxState-">updateReleaseTime</a></span>(long&nbsp;timestamp,
                 <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;deactivatedTx)</code>
<div class="block">This method MUST be invoked each time a transaction completes with the
 absolute value of the transaction identifier that has just been
 deactivated.</div>
</td>
</tr>
<tr id="i41" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/bigdata/service/AbstractTransactionService.html#updateReleaseTimeForBareCommit-long-">updateReleaseTimeForBareCommit</a></span>(long&nbsp;commitTime)</code>
<div class="block">If there are NO active transactions and the current releaseTime is LT
 (commitTime-1) then compute and set the new releaseTime.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.bigdata.service.AbstractService">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.bigdata.service.<a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a></h3>
<code><a href="../../../com/bigdata/service/AbstractService.html#clearLoggingContext--">clearLoggingContext</a>, <a href="../../../com/bigdata/service/AbstractService.html#getFederation--">getFederation</a>, <a href="../../../com/bigdata/service/AbstractService.html#getHostname--">getHostname</a>, <a href="../../../com/bigdata/service/AbstractService.html#getServiceName--">getServiceName</a>, <a href="../../../com/bigdata/service/AbstractService.html#getServiceUUID--">getServiceUUID</a>, <a href="../../../com/bigdata/service/AbstractService.html#setServiceUUID-java.util.UUID-">setServiceUUID</a>, <a href="../../../com/bigdata/service/AbstractService.html#setupLoggingContext--">setupLoggingContext</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.bigdata.service.IService">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;com.bigdata.service.<a href="../../../com/bigdata/service/IService.html" title="interface in com.bigdata.service">IService</a></h3>
<code><a href="../../../com/bigdata/service/IService.html#getHostname--">getHostname</a>, <a href="../../../com/bigdata/service/IService.html#getServiceName--">getServiceName</a>, <a href="../../../com/bigdata/service/IService.html#getServiceUUID--">getServiceUUID</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>log</h4>
<pre>protected static final&nbsp;org.apache.log4j.Logger log</pre>
<div class="block">Logger.</div>
</li>
</ul>
<a name="ERR_READ_ONLY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ERR_READ_ONLY</h4>
<pre>protected static final transient&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> ERR_READ_ONLY</pre>
<div class="block">If the transaction is read-only and a write operation was requested.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#com.bigdata.service.AbstractTransactionService.ERR_READ_ONLY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ERR_NO_SUCH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ERR_NO_SUCH</h4>
<pre>protected static final transient&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> ERR_NO_SUCH</pre>
<div class="block">If the transaction is not known to this service.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#com.bigdata.service.AbstractTransactionService.ERR_NO_SUCH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ERR_NOT_ACTIVE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ERR_NOT_ACTIVE</h4>
<pre>protected static final transient&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> ERR_NOT_ACTIVE</pre>
<div class="block">If a transaction is no longer active.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#com.bigdata.service.AbstractTransactionService.ERR_NOT_ACTIVE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ERR_SERVICE_NOT_AVAIL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ERR_SERVICE_NOT_AVAIL</h4>
<pre>protected static final transient&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> ERR_SERVICE_NOT_AVAIL</pre>
<div class="block">If the transaction service is not in a run state which permits the
 requested operation.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#com.bigdata.service.AbstractTransactionService.ERR_SERVICE_NOT_AVAIL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="lock">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lock</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantLock.html?is-external=true" title="class or interface in java.util.concurrent.locks">ReentrantLock</a> lock</pre>
<div class="block">A lock used to serialize certain operations that must be atomic with
 respect to the state of the transaction service. Mostly this is used to
 serialize the assignment of transaction identifiers and the update of the
 release time as transactions complete.
 <p>
 Note: To avoid lock ordering problems DO NOT acquire this <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a>
 if you are already holding a <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html#lock"><code>AbstractTransactionService.TxState.lock</code></a>. This causes a lock
 ordering problem and can result in deadlock.</div>
</li>
</ul>
<a name="txDeactivate">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>txDeactivate</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html?is-external=true" title="class or interface in java.util.concurrent.locks">Condition</a> txDeactivate</pre>
<div class="block">Signaled by <a href="../../../com/bigdata/service/AbstractTransactionService.html#deactivateTx-com.bigdata.service.AbstractTransactionService.TxState-"><code>deactivateTx(TxState)</code></a> and based on <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a>.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="AbstractTransactionService-java.util.Properties-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AbstractTransactionService</h4>
<pre>public&nbsp;AbstractTransactionService(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html?is-external=true" title="class or interface in java.util">Properties</a>&nbsp;properties)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getProperties--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getProperties</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html?is-external=true" title="class or interface in java.util">Properties</a>&nbsp;getProperties()</pre>
<div class="block">An object wrapping the properties used to initialize the service.</div>
</li>
</ul>
<a name="getTxState-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTxState</h4>
<pre>protected&nbsp;<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;getTxState(long&nbsp;tx)</pre>
<div class="block">Return the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service"><code>AbstractTransactionService.TxState</code></a> associated with the specified transition
 identifier.
 <p>
 Note: This method is an internal API. The caller must adhere to the
 internal synchronization APIs for the transaction service.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tx</code> - The transaction identifier (the signed value, NOT the absolute
            value).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service"><code>AbstractTransactionService.TxState</code></a> -or- <code>null</code> if there is no such
         active transaction.</dd>
</dl>
</li>
</ul>
<a name="getActiveCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getActiveCount</h4>
<pre>public final&nbsp;int&nbsp;getActiveCount()</pre>
<div class="block">The #of open transactions in any <a href="../../../com/bigdata/journal/RunState.html" title="enum in com.bigdata.journal"><code>RunState</code></a>.</div>
</li>
</ul>
<a name="isOpen--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isOpen</h4>
<pre>public&nbsp;boolean&nbsp;isOpen()</pre>
<div class="block">Any state other than <a href="../../../com/bigdata/service/TxServiceRunState.html#Halted"><code>TxServiceRunState.Halted</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/IServiceShutdown.html#isOpen--">isOpen</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/service/IServiceShutdown.html" title="interface in com.bigdata.service">IServiceShutdown</a></code></dd>
</dl>
</li>
</ul>
<a name="assertOpen--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertOpen</h4>
<pre>protected&nbsp;void&nbsp;assertOpen()</pre>
</li>
</ul>
<a name="getRunState--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRunState</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service">TxServiceRunState</a>&nbsp;getRunState()</pre>
<div class="block">Return the <a href="../../../com/bigdata/journal/RunState.html" title="enum in com.bigdata.journal"><code>RunState</code></a>.</div>
</li>
</ul>
<a name="setRunState-com.bigdata.service.TxServiceRunState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRunState</h4>
<pre>protected&nbsp;void&nbsp;setRunState(<a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service">TxServiceRunState</a>&nbsp;newval)</pre>
<div class="block">Change the <a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service"><code>TxServiceRunState</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newval</code> - The new value.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if the requested state is not a legal state change.</dd>
</dl>
</li>
</ul>
<a name="shutdown--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutdown</h4>
<pre>public&nbsp;void&nbsp;shutdown()</pre>
<div class="block">Polite shutdown. New transactions will not start. This method will block
 until existing transactions (both read-write and read-only) are complete
 (either aborted or committed).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/IServiceShutdown.html#shutdown--">shutdown</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/service/IServiceShutdown.html" title="interface in com.bigdata.service">IServiceShutdown</a></code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../com/bigdata/service/AbstractService.html#shutdown--">shutdown</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a></code></dd>
</dl>
</li>
</ul>
<a name="shutdownNow--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutdownNow</h4>
<pre>public&nbsp;void&nbsp;shutdownNow()</pre>
<div class="block">Fast shutdown (not immediate since it must abort active transactions).
 <p>
 New transactions will not start and active transactions will be aborted.
 Transactions which are concurrently committing MAY fail (throwing
 exceptions from various methods, including <a href="../../../com/bigdata/service/AbstractTransactionService.html#nextTimestamp--"><code>nextTimestamp()</code></a>)
 when the service halts.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/IServiceShutdown.html#shutdownNow--">shutdownNow</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/service/IServiceShutdown.html" title="interface in com.bigdata.service">IServiceShutdown</a></code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../com/bigdata/service/AbstractService.html#shutdownNow--">shutdownNow</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a></code></dd>
</dl>
</li>
</ul>
<a name="abortAllTx--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abortAllTx</h4>
<pre>public&nbsp;void&nbsp;abortAllTx()</pre>
<div class="block">Abort all active transactions.</div>
</li>
</ul>
<a name="destroy--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>destroy</h4>
<pre>public&nbsp;void&nbsp;destroy()</pre>
<div class="block">Immediate/fast shutdown of the service and then destroys any persistent
 state associated with the service.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/IService.html#destroy--">destroy</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/service/IService.html" title="interface in com.bigdata.service">IService</a></code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../com/bigdata/service/AbstractService.html#destroy--">destroy</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a></code></dd>
</dl>
</li>
</ul>
<a name="nextTimestamp--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nextTimestamp</h4>
<pre>public&nbsp;long&nbsp;nextTimestamp()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/journal/ITimestampService.html#nextTimestamp--">ITimestampService</a></code></span></div>
<div class="block">Return the next unique timestamp. Timestamps must be strictly increasing.
 <p>
 Note: This method MUST return strictly increasing values, even when it is
 invoked by concurrent threads. While other implementations are possible
 and may be more efficient, one way to insure thread safety is to
 synchronize on some object such that the implementaiton exhibits a FIFO
 behavior.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITimestampService.html#nextTimestamp--">nextTimestamp</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITimestampService.html" title="interface in com.bigdata.journal">ITimestampService</a></code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../com/bigdata/journal/TimestampServiceUtil.html#nextTimestamp-com.bigdata.journal.ITimestampService-"><code>TimestampServiceUtil.nextTimestamp(ITimestampService)</code></a></dd>
</dl>
</li>
</ul>
<a name="newTx-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newTx</h4>
<pre>public&nbsp;long&nbsp;newTx(long&nbsp;timestamp)</pre>
<div class="block">Create a new transaction.
 <p>
 Note: There is an upper bound of one read-write transaction that may be
 created per millisecond (the resolution of <a href="../../../com/bigdata/service/AbstractTransactionService.html#nextTimestamp--"><code>nextTimestamp()</code></a>) and
 requests for new read-write transactions contend with other requests for
 <a href="../../../com/bigdata/service/AbstractTransactionService.html#nextTimestamp--"><code>nextTimestamp()</code></a>.
 <p>
 Note: The transaction service will refuse to start new transactions whose
 timestamps are LTE to <a href="../../../com/bigdata/service/AbstractTransactionService.html#getReleaseTime--"><code>getReleaseTime()</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITransactionService.html#newTx-long-">newTx</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp may be:
            <ul>
            <li>A timestamp (GT ZERO), which will result in a
            read-historical (read-only) transaction that reads from the
            most recent committed state whose commit timestamp is less
            than or equal to <i>timestamp</i>. (As a special case, a
            timestamp that is GT the <code>lastCommitTime</code> will
            produce a read-only transaction that is reading on the
            <code>lastCommitTime</code> with snapshot isolation (new
            writes will not become visible in the view). This is basically
            the same behavior as specifying <a href="../../../com/bigdata/journal/ITx.html#READ_COMMITTED"><code>ITx.READ_COMMITTED</code></a>.
            While perhaps counter-intuitive, this behavior is preferred to
            throwing an exception when a user attempts to read from a
            commit time GT the most recent commit point.).</li>
            <li>The symbolic constant <a href="../../../com/bigdata/journal/ITx.html#READ_COMMITTED"><code>ITx.READ_COMMITTED</code></a> to obtain
            a read-historical transaction reading from the most recently
            committed state of the database. The transaction will be
            assigned a start time corresponding to the most recent commit
            point of the database and will be a fully isolated read-only
            view of the state of the database as of that start time. (This
            is an atomic shorthand for newTx(getLastCommitTime())).</li>
            <li><a href="../../../com/bigdata/journal/ITx.html#UNISOLATED"><code>ITx.UNISOLATED</code></a> for a read-write transaction.</li>
            </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The unique transaction identifier.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/RuntimeException.html?is-external=true" title="class or interface in java.lang">RuntimeException</a></code> - Wrapping <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent"><code>TimeoutException</code></a> if a timeout occurs
             awaiting a start time which would satisfy the request for a
             read-only transaction (this can occur only for read-only
             transactions which must contend for start times which will
             read from the appropriate historical commit point).</dd>
</dl>
</li>
</ul>
<a name="getStartCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStartCount</h4>
<pre>public&nbsp;long&nbsp;getStartCount()</pre>
<div class="block">#of transaction started.</div>
</li>
</ul>
<a name="getAbortCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAbortCount</h4>
<pre>public&nbsp;long&nbsp;getAbortCount()</pre>
<div class="block">#of transaction aborted.</div>
</li>
</ul>
<a name="getCommitCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCommitCount</h4>
<pre>public&nbsp;long&nbsp;getCommitCount()</pre>
<div class="block">#of transaction committed.</div>
</li>
</ul>
<a name="getReadOnlyActiveCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReadOnlyActiveCount</h4>
<pre>public&nbsp;long&nbsp;getReadOnlyActiveCount()</pre>
</li>
</ul>
<a name="getReadWriteActiveCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReadWriteActiveCount</h4>
<pre>public&nbsp;long&nbsp;getReadWriteActiveCount()</pre>
</li>
</ul>
<a name="getEarliestActiveTx--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEarliestActiveTx</h4>
<pre>protected&nbsp;<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;getEarliestActiveTx()</pre>
<div class="block">Return the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service"><code>AbstractTransactionService.TxState</code></a> for the earliest active Tx -or-
 <code>null</code> if there is no active tx.
 <p>
 Note: The <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a> is required in order to make atomic decisions
 about the earliest active tx. Without the <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a>, the tx could
 stop or a new tx could start, thereby invalidating the "earliest active"
 guarantee.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalMonitorStateException.html?is-external=true" title="class or interface in java.lang">IllegalMonitorStateException</a></code> - unless the <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a> is held by the caller.</dd>
</dl>
</li>
</ul>
<a name="getReleaseTime--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReleaseTime</h4>
<pre>public&nbsp;long&nbsp;getReleaseTime()</pre>
<div class="block">Return the timestamp whose historical data MAY be released. This time is
 derived from the minimum of the timestamp of the earliest running
 transaction and <code>now-minReleaseAge</code> and is updated whenever
 the earliest running transaction terminates. This value is monotonically
 increasing. It will always be LT the last non-zero last commit time. It
 will never be negative. It MAY be ZERO (0L) and will be ZERO (0L) on
 startup (unless explicitly set by the database to the last known commit
 time).
 <p>
 The returned values is used to identify the most recent commit point LTE
 the releaseTime. This is the earliest commit point on whose data MAY be
 released. (Consequently, the first commit point GT the releaseTime is the
 earliest visible commit point.)</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITransactionService.html#getReleaseTime--">getReleaseTime</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a></code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../com/bigdata/service/AbstractTransactionService.Options.html#MIN_RELEASE_AGE"><code>AbstractTransactionService.Options.MIN_RELEASE_AGE</code></a></dd>
</dl>
</li>
</ul>
<a name="setReleaseTime-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setReleaseTime</h4>
<pre>protected&nbsp;void&nbsp;setReleaseTime(long&nbsp;newValue)</pre>
<div class="block">Sets the new release time.
 <p>
 Note: For a joined service in HA (the leader or a follower), the release
 time is set by the consensus protocol. Otherwise it is automatically
 maintained by <a href="../../../com/bigdata/service/AbstractTransactionService.html#updateReleaseTime-long-com.bigdata.service.AbstractTransactionService.TxState-"><code>updateReleaseTime(long, TxState)</code></a> and
 <a href="../../../com/bigdata/service/AbstractTransactionService.html#updateReleaseTimeForBareCommit-long-"><code>updateReleaseTimeForBareCommit(long)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newValue</code> - The new value.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="https://sourceforge.net/apps/trac/bigdata/ticket/671">
      Query on follower fails during UPDATE on leader </a></dd>
</dl>
</li>
</ul>
<a name="getEffectiveReleaseTimeForHA--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEffectiveReleaseTimeForHA</h4>
<pre>protected&nbsp;long&nbsp;getEffectiveReleaseTimeForHA()</pre>
<div class="block">This method was introduced to compute the effective timestamp of the
 pinned history in support of the HA TXS. It <strong>ignores</strong> the
 <code>releaseTime</code> and reports the minimum of
 <code>now - minReleaseAge</code> and the readsOnCommitTime of the
 earliest active Tx. If the value would be negative, then ZERO (0L) is
 reported instead.
 <p>
 Note: This duplicates logic in <code>#updateReleaseTime(long)</code>, but
 handles the special case in HA where the releaseTime is not being updated
 by <a href="../../../com/bigdata/service/AbstractTransactionService.html#updateReleaseTimeForBareCommit-long-"><code>updateReleaseTimeForBareCommit(long)</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The effective release time.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="https://sourceforge.net/apps/trac/bigdata/ticket/623"> HA
      TXS </a>, 
<code>#updateReleaseTime(long)</code></dd>
</dl>
</li>
</ul>
<a name="activateTx-com.bigdata.service.AbstractTransactionService.TxState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>activateTx</h4>
<pre>protected&nbsp;void&nbsp;activateTx(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)</pre>
<div class="block">Adds the transaction from to the local tables.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>state</code> - The transaction.</dd>
</dl>
</li>
</ul>
<a name="getReadsOnTime-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReadsOnTime</h4>
<pre>protected&nbsp;long&nbsp;getReadsOnTime(long&nbsp;txId)</pre>
<div class="block">Return the commit time on which the transaction is reading.
 <p>
 Note: This method is exposed primarily for the unit tests.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>txId</code> - The transaction identifier.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The commit time on which that transaction is reading.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if there is no such transaction.</dd>
</dl>
</li>
</ul>
<a name="deactivateTx-com.bigdata.service.AbstractTransactionService.TxState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deactivateTx</h4>
<pre>protected&nbsp;void&nbsp;deactivateTx(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)</pre>
<div class="block">Removes the transaction from the local tables.
 <p>
 Note: The caller MUST own <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html#lock"><code>AbstractTransactionService.TxState.lock</code></a> across this method and
 MUST then do
 
 <pre>
 updateReleaseTime(long)
 deactivateTx.signallAll()
 </pre>
 
 while holding the outer <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a>.
 <p>
 Note: Normally this method is invoked without the outer <a href="../../../com/bigdata/service/AbstractTransactionService.html#lock"><code>lock</code></a>
 which necessitates lifting those method calls out of this method and into
 the caller.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>state</code> - The transaction.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalMonitorStateException.html?is-external=true" title="class or interface in java.lang">IllegalMonitorStateException</a></code> - unless the caller is holding the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html#lock"><code>AbstractTransactionService.TxState.lock</code></a>.</dd>
</dl>
</li>
</ul>
<a name="isReleaseTimeConsensusProtocol--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isReleaseTimeConsensusProtocol</h4>
<pre>protected&nbsp;boolean&nbsp;isReleaseTimeConsensusProtocol()</pre>
<div class="block">Return <code>true</code> iff the release time consensus protocol is being
 used to update the releaseTime (HA and this service is either a leader or
 a follower). Return <code>false</code> iff the service should locally
 manage its own release time (non-HA and HA when the service is
 <a href="../../../com/bigdata/ha/HAStatusEnum.html#NotReady"><code>HAStatusEnum.NotReady</code></a>).
 <p>
 Note: When we are using a 2-phase commit, the leader can not update the
 release time from commit() using this methods. It must rely on the
 consensus protocol to update the release time instead.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href=
      "https://sourceforge.net/apps/trac/bigdata/ticket/530#comment:116">
      Journal HA </a></dd>
</dl>
</li>
</ul>
<a name="updateReleaseTime-long-com.bigdata.service.AbstractTransactionService.TxState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateReleaseTime</h4>
<pre>protected final&nbsp;void&nbsp;updateReleaseTime(long&nbsp;timestamp,
                                       <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;deactivatedTx)</pre>
<div class="block">This method MUST be invoked each time a transaction completes with the
 absolute value of the transaction identifier that has just been
 deactivated. The method will remove the transaction entry in the ordered
 set of running transactions (<a href="../../../com/bigdata/service/AbstractTransactionService.html#startTimeIndex"><code>startTimeIndex</code></a>).
 <p>
 If the specified timestamp corresponds to the earliest running
 transaction, then the <code>releaseTime</code> will be updated and the
 new releaseTime will be set using <a href="../../../com/bigdata/service/AbstractTransactionService.html#setReleaseTime-long-"><code>setReleaseTime(long)</code></a>. For HA,
 the releaseTime is updated by a consensus protocol and the individual
 services MUST NOT advance their releaseTime as transactions complete.
 <p>
 Note: When we are using a 2-phase commit, the leader can not update the
 release time from commit() using this methods. It must rely on the
 consensus protocol to update the release time instead.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The absolute value of a transaction identifier that has just
            been deactivated.</dd>
<dd><code>deactivatedTx</code> - The transaction object that has been deactivated -or-
            <code>null</code> if there are known to be no active
            transactions remaining (e.g., startup and abortAll()).</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="https://sourceforge.net/apps/trac/bigdata/ticket/467" >
      IllegalStateException trying to access lexicon index using RWStore
      with recycling </a>, 
<a href="https://sourceforge.net/apps/trac/bigdata/ticket/671">
      Query on follower fails during UPDATE on leader </a></dd>
</dl>
</li>
</ul>
<a name="notifyCommit-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>notifyCommit</h4>
<pre>public&nbsp;void&nbsp;notifyCommit(long&nbsp;commitTime)</pre>
<div class="block">The basic implementation advances the release time periodically as
 commits occur even when there are no transactions in use.  
 <p>
 Note: This needs to be a fairly low-latency operation since this method
 is invoked for all commits on all data services and will otherwise be a
 global hotspot.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITransactionService.html#notifyCommit-long-">notifyCommit</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>commitTime</code> - The commit time.</dd>
</dl>
</li>
</ul>
<a name="updateReleaseTimeForBareCommit-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateReleaseTimeForBareCommit</h4>
<pre>protected&nbsp;void&nbsp;updateReleaseTimeForBareCommit(long&nbsp;commitTime)</pre>
<div class="block">If there are NO active transactions and the current releaseTime is LT
 (commitTime-1) then compute and set the new releaseTime.
 <p>
 Note: This method was historically part of <a href="../../../com/bigdata/service/AbstractTransactionService.html#notifyCommit-long-"><code>notifyCommit(long)</code></a>.
 It was moved into its own method so it can be overridden for some unit
 tests.
 <p>
 Note: When we are using a 2-phase commit, the leader can not update the
 release time from commit() using this methods. It must rely on the
 consensus protocol to update the release time instead.</div>
</li>
</ul>
<a name="getMinReleaseAge--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMinReleaseAge</h4>
<pre>public final&nbsp;long&nbsp;getMinReleaseAge()</pre>
<div class="block">Return the minimum #of milliseconds of history that must be preserved.</div>
</li>
</ul>
<a name="assignTransactionIdentifier-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assignTransactionIdentifier</h4>
<pre>protected final&nbsp;<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;assignTransactionIdentifier(long&nbsp;timestamp)
                                                                        throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a>,
                                                                               <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a></pre>
<div class="block">Assign a transaction identifier for a new transaction.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The new transaction object.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - if interrupted while awaiting a start time which would
             satisfy the request.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code> - if a timeout occurs while awaiting a start time which would
             satisfy the request.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a></code></dd>
</dl>
</li>
</ul>
<a name="findCommitTime-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findCommitTime</h4>
<pre>protected abstract&nbsp;long&nbsp;findCommitTime(long&nbsp;timestamp)</pre>
<div class="block">Find the commit time from which the tx will read (largest commitTime LTE
 timestamp).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The commit time and -1L if there is no such commit time.</dd>
</dl>
</li>
</ul>
<a name="findNextCommitTime-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findNextCommitTime</h4>
<pre>protected abstract&nbsp;long&nbsp;findNextCommitTime(long&nbsp;commitTime)</pre>
<div class="block">Return the commit time for the successor of that commit point have the
 specified timestamp (a commit time strictly GT the given value).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>commitTime</code> - The probe.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The successor or -1L iff the is no successor for that commit
         time.</dd>
</dl>
</li>
</ul>
<a name="findUnusedTimestamp-long-long-long-java.util.concurrent.TimeUnit-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findUnusedTimestamp</h4>
<pre>protected&nbsp;long&nbsp;findUnusedTimestamp(long&nbsp;commitTime,
                                   long&nbsp;nextCommitTime,
                                   long&nbsp;timeout,
                                   <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)
                            throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a>,
                                   <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a></pre>
<div class="block">Find a valid, unused timestamp.
 <p>
 Note: Any timestamp in the half-open range [commitTime:nextCommitTime)
 MAY be assigned as all such timestamps will read from the commit point
 associated with [commitTime].</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>commitTime</code> - The commit time for the commit point on which the tx will read
            (this must be the exact timestamp associated with the desired
            commit point).</dd>
<dd><code>nextCommitTime</code> - The commit time for the successor of that commit point.</dd>
<dd><code>timeout</code> - The maximum length of time to await an available timestamp.</dd>
<dd><code>unit</code> - The unit in which <i>timeout</i> is expressed.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/TimeoutException.html?is-external=true" title="class or interface in java.util.concurrent">TimeoutException</a></code></dd>
</dl>
</li>
</ul>
<a name="getLastCommitTime--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastCommitTime</h4>
<pre>public abstract&nbsp;long&nbsp;getLastCommitTime()</pre>
<div class="block">Note: Declared abstract so that we can hide the <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io"><code>IOException</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITransactionService.html#getLastCommitTime--">getLastCommitTime</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The last known commit time.</dd>
</dl>
</li>
</ul>
<a name="abortImpl-com.bigdata.service.AbstractTransactionService.TxState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abortImpl</h4>
<pre>protected abstract&nbsp;void&nbsp;abortImpl(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)
                           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<div class="block">Implementation must abort the tx on the journal (standalone) or on each
 data service (federation) on which it has written.
 <p>
 Pre-conditions:
 <ol>
 <li>The transaction is <a href="../../../com/bigdata/journal/RunState.html#Active"><code>RunState.Active</code></a>; and</li>
 <li>The caller holds the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html#lock"><code>AbstractTransactionService.TxState.lock</code></a>.</li>
 </ol>
 <p>
 Post-conditions:
 <ol>
 <li>The transaction is <a href="../../../com/bigdata/journal/RunState.html#Aborted"><code>RunState.Aborted</code></a>; and</li>
 <li>The transaction write set has been discarded by each <a href="../../../com/bigdata/journal/Journal.html" title="class in com.bigdata.journal"><code>Journal</code></a>
 or <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> or which it has written (applicable for
 read-write transactions only).</li>
 </ol>
 <p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>state</code> - The transaction state as maintained by the transaction server.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code></dd>
</dl>
</li>
</ul>
<a name="commitImpl-com.bigdata.service.AbstractTransactionService.TxState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commitImpl</h4>
<pre>protected abstract&nbsp;long&nbsp;commitImpl(<a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html" title="class in com.bigdata.service">AbstractTransactionService.TxState</a>&nbsp;state)
                            throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<div class="block">Implementation must either single-phase commit (standalone journal or a
 transaction that only writes on a single data service) or 2-/3-phase
 commit (distributed transaction running on a federation).
 <p>
 Pre-conditions:
 <ol>
 <li>The transaction is <a href="../../../com/bigdata/journal/RunState.html#Active"><code>RunState.Active</code></a>; and</li>
 <li>The caller holds the <a href="../../../com/bigdata/service/AbstractTransactionService.TxState.html#lock"><code>AbstractTransactionService.TxState.lock</code></a>.</li>
 </ol>
 <p>
 Post-conditions (success for read-only transaction or a read-write
 transaction with an empty write set):
 <ol>
 <li>The transaction is <a href="../../../com/bigdata/journal/RunState.html#Committed"><code>RunState.Committed</code></a>; and</li>
 <li>The returned <i>commitTime</i> is ZERO (0L).</li>
 </ol>
 <p>
 Post-conditions (success for read-write transaction with a non-empty
 write set):
 <ol>
 <li>The transaction is <a href="../../../com/bigdata/journal/RunState.html#Committed"><code>RunState.Committed</code></a>;</li>
 <li>The transaction write set has been made restart-safe by each
 <a href="../../../com/bigdata/journal/Journal.html" title="class in com.bigdata.journal"><code>Journal</code></a> or <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> or which it has written
 (applicable for read-write transactions only); and</li>
 <li>The application can read exactly the data written by the transaction
 from the commit point identified by the returned <i>commitTime</i>.</li>
 </ol>
 <p>
 Post-conditions (failure):
 <ol>
 <li>The transaction is <a href="../../../com/bigdata/journal/RunState.html#Aborted"><code>RunState.Aborted</code></a>; and</li>
 <li>The transaction write set has been discarded by each <a href="../../../com/bigdata/journal/Journal.html" title="class in com.bigdata.journal"><code>Journal</code></a>
 or <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> or which it has written (applicable for
 read-write transactions only).</li>
 </ol></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tx</code> - The transaction identifier.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The commit time for the transaction -or- ZERO (0L) if the
         transaction was read-only or had an empty write set.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code> - if something else goes wrong. This will be (or will wrap) a
             <a href="../../../com/bigdata/journal/ValidationError.html" title="class in com.bigdata.journal"><code>ValidationError</code></a> if validation fails.</dd>
</dl>
</li>
</ul>
<a name="abort-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abort</h4>
<pre>public&nbsp;void&nbsp;abort(long&nbsp;tx)</pre>
<div class="block">Abort the transaction (asynchronous).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITransactionService.html#abort-long-">abort</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tx</code> - The transaction identifier.</dd>
</dl>
</li>
</ul>
<a name="commit-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public&nbsp;long&nbsp;commit(long&nbsp;tx)
            throws <a href="../../../com/bigdata/journal/ValidationError.html" title="class in com.bigdata.journal">ValidationError</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html#commit-long-">ITransactionService</a></code></span></div>
<div class="block">Request commit of the transaction write set. Committing a read-only
 transaction is necessary in order to release read locks (this is very
 fast). If a transaction has a write set, then this method does not return
 until that write set has been made restart safe or the transaction has
 failed.
 <p>
 The commit of a transaction with a write set on a single
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> does not require either <a href="../../../com/bigdata/journal/ITx.html#UNISOLATED"><code>ITx.UNISOLATED</code></a> tasks
 or other transactions to wait. The latency for such commits is directly
 related to the size of the transaction write set.
 <p>
 However, the commit of a transaction with writes on more than one
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a> requires a distributed commit protocol. The
 distributed commit protocol forces ALL tasks writing on those
 <a href="../../../com/bigdata/service/IDataService.html" title="interface in com.bigdata.service"><code>IDataService</code></a>s to wait until the transaction is complete. This is
 necessary in order to obtain a global commit point that corresponds to
 the atomic commit state of the transaction (without this we would not
 have the Atomic property for distributed transaction commits).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ITransactionService.html#commit-long-">commit</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/ITransactionService.html" title="interface in com.bigdata.journal">ITransactionService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tx</code> - The transaction identifier.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The commit time for the transaction -or- ZERO (0L) if the
         transaction was read-only or had an empty write set. This commit
         time identifies a global commit point on the database from which
         you may read the coherent post-commit state of the transaction.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../com/bigdata/journal/ValidationError.html" title="class in com.bigdata.journal">ValidationError</a></code> - if the transaction could not be validated.</dd>
</dl>
</li>
</ul>
<a name="start--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/service/AbstractTransactionService.html" title="class in com.bigdata.service">AbstractTransactionService</a>&nbsp;start()</pre>
<div class="block">Verifies that <a href="../../../com/bigdata/service/AbstractTransactionService.html#nextTimestamp--"><code>nextTimestamp()</code></a> will not report a time before
 <a href="../../../com/bigdata/service/AbstractTransactionService.html#getLastCommitTime--"><code>getLastCommitTime()</code></a> and then changes the <a href="../../../com/bigdata/service/TxServiceRunState.html" title="enum in com.bigdata.service"><code>TxServiceRunState</code></a>
 to <a href="../../../com/bigdata/service/TxServiceRunState.html#Running"><code>TxServiceRunState.Running</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/AbstractService.html#start--">start</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><i>this</i> (the return type should be strengthened by the
         concrete implementation to return the actual type).</dd>
</dl>
</li>
</ul>
<a name="getServiceIface--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getServiceIface</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&nbsp;getServiceIface()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../com/bigdata/service/AbstractService.html#getServiceIface--">AbstractService</a></code></span></div>
<div class="block">Return the most interesting interface for the service.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/IService.html#getServiceIface--">getServiceIface</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/service/IService.html" title="interface in com.bigdata.service">IService</a></code></dd>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/service/AbstractService.html#getServiceIface--">getServiceIface</a></code>&nbsp;in class&nbsp;<code><a href="../../../com/bigdata/service/AbstractService.html" title="class in com.bigdata.service">AbstractService</a></code></dd>
</dl>
</li>
</ul>
<a name="getCounters--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getCounters</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a>&nbsp;getCounters()</pre>
<div class="block">Return the <a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters"><code>CounterSet</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../com/bigdata/counters/ICounterSetAccess.html#getCounters--">getCounters</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/counters/ICounterSetAccess.html" title="interface in com.bigdata.counters">ICounterSetAccess</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractTransactionService.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/service/AbstractServiceLoadHelperWithScores.html" title="class in com.bigdata.service"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/bigdata/service/AbstractTransactionService.Options.html" title="interface in com.bigdata.service"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/service/AbstractTransactionService.html" target="_top">Frames</a></li>
<li><a href="AbstractTransactionService.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
