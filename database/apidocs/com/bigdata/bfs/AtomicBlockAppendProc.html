<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Tue Jan 26 05:10:13 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AtomicBlockAppendProc (Blazegraph Database Platform 2.0.0 API)</title>
<meta name="date" content="2016-01-26">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AtomicBlockAppendProc (Blazegraph Database Platform 2.0.0 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AtomicBlockAppendProc.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/bfs/AbstractRepositoryTestCase.html" title="class in com.bigdata.bfs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/bigdata/bfs/AtomicBlockWriteProc.html" title="class in com.bigdata.bfs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/bfs/AtomicBlockAppendProc.html" target="_top">Frames</a></li>
<li><a href="AtomicBlockAppendProc.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.bfs</div>
<h2 title="Class AtomicBlockAppendProc" class="title">Class AtomicBlockAppendProc</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.bfs.AtomicBlockAppendProc</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../com/bigdata/btree/proc/IIndexProcedure.html" title="interface in com.bigdata.btree.proc">IIndexProcedure</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;, <a href="../../../com/bigdata/btree/proc/ISimpleIndexProcedure.html" title="interface in com.bigdata.btree.proc">ISimpleIndexProcedure</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;, <a href="../../../com/bigdata/journal/IReadOnly.html" title="interface in com.bigdata.journal">IReadOnly</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html?is-external=true" title="class or interface in java.io">Externalizable</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">AtomicBlockAppendProc</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../com/bigdata/btree/proc/ISimpleIndexProcedure.html" title="interface in com.bigdata.btree.proc">ISimpleIndexProcedure</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html?is-external=true" title="class or interface in java.io">Externalizable</a></pre>
<div class="block">Atomic append of a single block to a file version.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../serialized-form.html#com.bigdata.bfs.AtomicBlockAppendProc">Serialized Form</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#DEBUG">DEBUG</a></strong></code>
<div class="block">True iff the <a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#log"><code>log</code></a> level is DEBUG or less.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#INFO">INFO</a></strong></code>
<div class="block">True iff the <a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#log"><code>log</code></a> level is INFO or less.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#log">log</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#AtomicBlockAppendProc(com.bigdata.bfs.BigdataFileSystem,%20java.lang.String,%20int,%20byte[],%20int,%20int)">AtomicBlockAppendProc</a></strong>(<a href="../../../com/bigdata/bfs/BigdataFileSystem.html" title="class in com.bigdata.bfs">BigdataFileSystem</a>&nbsp;repo,
                     <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;id,
                     int&nbsp;version,
                     byte[]&nbsp;b,
                     int&nbsp;off,
                     int&nbsp;len)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#apply(com.bigdata.btree.IIndex)">apply</a></strong>(<a href="../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>&nbsp;ndx)</code>
<div class="block">This procedure runs on the unisolated index.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#getNextBlockFromPriorKey(com.bigdata.btree.keys.IKeyBuilder,%20byte[])">getNextBlockFromPriorKey</a></strong>(<a href="../../../com/bigdata/btree/keys/IKeyBuilder.html" title="interface in com.bigdata.btree.keys">IKeyBuilder</a>&nbsp;keyBuilder,
                        byte[]&nbsp;key)</code>
<div class="block">Decode the block identifier in the key and return the block
 identifier plus one, which is the block identifier to be used for the
 atomic append operation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#getNextBlockIdentifierInFileVersion(com.bigdata.btree.IIndex,%20com.bigdata.btree.keys.IKeyBuilder)">getNextBlockIdentifierInFileVersion</a></strong>(<a href="../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>&nbsp;ndx,
                                   <a href="../../../com/bigdata/btree/keys/IKeyBuilder.html" title="interface in com.bigdata.btree.keys">IKeyBuilder</a>&nbsp;keyBuilder)</code>
<div class="block">Find the key for the last block written for this file version.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#getNextBlockIdentifierInFileVersion2(com.bigdata.btree.IIndex,%20com.bigdata.btree.keys.IKeyBuilder)">getNextBlockIdentifierInFileVersion2</a></strong>(<a href="../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>&nbsp;ndx,
                                    <a href="../../../com/bigdata/btree/keys/IKeyBuilder.html" title="interface in com.bigdata.btree.keys">IKeyBuilder</a>&nbsp;keyBuilder)</code>
<div class="block">Find the key for the last block written for this file version.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#isReadOnly()">isReadOnly</a></strong>()</code>
<div class="block">Return <code>true</code> iff the procedure asserts that it will not
 write on the index.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#readExternal(java.io.ObjectInput)">readExternal</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/ObjectInput.html?is-external=true" title="class or interface in java.io">ObjectInput</a>&nbsp;in)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#writeExternal(java.io.ObjectOutput)">writeExternal</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/ObjectOutput.html?is-external=true" title="class or interface in java.io">ObjectOutput</a>&nbsp;out)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>log</h4>
<pre>protected static transient&nbsp;org.apache.log4j.Logger log</pre>
</li>
</ul>
<a name="INFO">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>INFO</h4>
<pre>protected static final transient&nbsp;boolean INFO</pre>
<div class="block">True iff the <a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#log"><code>log</code></a> level is INFO or less.</div>
</li>
</ul>
<a name="DEBUG">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEBUG</h4>
<pre>protected static final transient&nbsp;boolean DEBUG</pre>
<div class="block">True iff the <a href="../../../com/bigdata/bfs/AtomicBlockAppendProc.html#log"><code>log</code></a> level is DEBUG or less.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="AtomicBlockAppendProc(com.bigdata.bfs.BigdataFileSystem, java.lang.String, int, byte[], int, int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AtomicBlockAppendProc</h4>
<pre>public&nbsp;AtomicBlockAppendProc(<a href="../../../com/bigdata/bfs/BigdataFileSystem.html" title="class in com.bigdata.bfs">BigdataFileSystem</a>&nbsp;repo,
                     <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;id,
                     int&nbsp;version,
                     byte[]&nbsp;b,
                     int&nbsp;off,
                     int&nbsp;len)</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>id</code> - The file identifier.</dd><dd><code>version</code> - The file version.</dd><dd><code>b</code> - The buffer containing the data to be written.</dd><dd><code>off</code> - The offset in the buffer of the first byte to be written.</dd><dd><code>len</code> - The #of bytes to be written.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="isReadOnly()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isReadOnly</h4>
<pre>public final&nbsp;boolean&nbsp;isReadOnly()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/journal/IReadOnly.html#isReadOnly()">IReadOnly</a></code></strong></div>
<div class="block">Return <code>true</code> iff the procedure asserts that it will not
 write on the index. When <code>true</code>, the procedure may be run
 against a view of the index that is read-only or which allows concurrent
 processes to read on the same index object. When <code>false</code> the
 procedure will be run against a mutable view of the index (assuming that
 the procedure is executed in a context that has access to a mutable index
 view).</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/journal/IReadOnly.html#isReadOnly()">isReadOnly</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/journal/IReadOnly.html" title="interface in com.bigdata.journal">IReadOnly</a></code></dd>
</dl>
</li>
</ul>
<a name="apply(com.bigdata.btree.IIndex)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>apply</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;apply(<a href="../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>&nbsp;ndx)</pre>
<div class="block">This procedure runs on the unisolated index. The block identifier is
 computed as a one up long integer for that file version using locally
 available state. The raw data for the block is written directly onto
 the <a href="../../../com/bigdata/journal/Journal.html" title="class in com.bigdata.journal"><code>Journal</code></a> and an index entry is added for the file,
 version, and block whose value is the address of the block's data on
 the <a href="../../../com/bigdata/journal/Journal.html" title="class in com.bigdata.journal"><code>Journal</code></a>.
 <p>
 Note: The caller MUST have correctly identified the data service on
 which the tail of the file exists (or on which the head of the file
 will be written).
 <p>
 The block identifier is computed by reading and decoding the key for
 the last block written for this file version (if any). Special cases
 exist when the file version spans more than one index partition, when
 the block would be the first block (in key order) for the index
 partition, and when the block would be the last block (in key order)
 for the index partition.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/btree/proc/IIndexProcedure.html#apply(com.bigdata.btree.IIndex)">apply</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/btree/proc/IIndexProcedure.html" title="interface in com.bigdata.btree.proc">IIndexProcedure</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>ndx</code> - The index.</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> iff the block was overwritten.</dd></dl>
</li>
</ul>
<a name="getNextBlockIdentifierInFileVersion2(com.bigdata.btree.IIndex, com.bigdata.btree.keys.IKeyBuilder)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextBlockIdentifierInFileVersion2</h4>
<pre>protected&nbsp;long&nbsp;getNextBlockIdentifierInFileVersion2(<a href="../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>&nbsp;ndx,
                                        <a href="../../../com/bigdata/btree/keys/IKeyBuilder.html" title="interface in com.bigdata.btree.keys">IKeyBuilder</a>&nbsp;keyBuilder)</pre>
<div class="block">Find the key for the last block written for this file version. We do this
 by forming a probe key from the file, version, and the maximum allowed
 block identifier. This is guarenteed to be after any existing block for
 that file and version.
 <p>
 Note: This implementation uses an <a href="../../../com/bigdata/btree/IRangeQuery.html#REVERSE"><code>IRangeQuery.REVERSE</code></a> iterator to
 locate the last block in the file and is capable of scale-out.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>ndx</code> - </dd><dd><code>keyBuilder</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="getNextBlockIdentifierInFileVersion(com.bigdata.btree.IIndex, com.bigdata.btree.keys.IKeyBuilder)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextBlockIdentifierInFileVersion</h4>
<pre>protected&nbsp;long&nbsp;getNextBlockIdentifierInFileVersion(<a href="../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>&nbsp;ndx,
                                       <a href="../../../com/bigdata/btree/keys/IKeyBuilder.html" title="interface in com.bigdata.btree.keys">IKeyBuilder</a>&nbsp;keyBuilder)</pre>
<div class="block">Find the key for the last block written for this file version. We do this
 by forming a probe key from the file, version, and the maximum allowed
 block identifier. This is guarenteed to be after any existing block for
 that file and version.
 <p>
 Note: This implementation uses the <a href="../../../com/bigdata/btree/ILinearList.html" title="interface in com.bigdata.btree"><code>ILinearList</code></a> API to locate the
 last block in the file and is NOT capable of scale-out since that API is
 NOT available for an index partition view (a <a href="../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view"><code>FusedView</code></a>).</div>
</li>
</ul>
<a name="getNextBlockFromPriorKey(com.bigdata.btree.keys.IKeyBuilder, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextBlockFromPriorKey</h4>
<pre>protected&nbsp;long&nbsp;getNextBlockFromPriorKey(<a href="../../../com/bigdata/btree/keys/IKeyBuilder.html" title="interface in com.bigdata.btree.keys">IKeyBuilder</a>&nbsp;keyBuilder,
                            byte[]&nbsp;key)</pre>
<div class="block">Decode the block identifier in the key and return the block
 identifier plus one, which is the block identifier to be used for the
 atomic append operation. If the key does NOT encode the same file +
 version then no blocks exist for that file version and the method
 returns zero (0L) as the block identifer to be used.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>keyBuilder</code> - The key builder.</dd><dd><code>key</code> - The key - either from the index partition or in some cases
            from the leftSeparator of the index partition metadata.
            <p>
            Note that the leftSeparator MAY be an empty byte[] (e.g.,
            for the 1st index partition in the key order) and MIGHT
            NOT include the block identifier (the block identifier is
            only included when it is necessary to split a file across
            index partitions). When the block identifier is omitted
            from the key and the key encodes the same file and version
            we therefore use zero (0L) as the next block identifier
            since we will be appending the first block to the file
            version.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The block identifier that will be used by the atomic append
         operation.</dd></dl>
</li>
</ul>
<a name="readExternal(java.io.ObjectInput)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readExternal</h4>
<pre>public&nbsp;void&nbsp;readExternal(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/ObjectInput.html?is-external=true" title="class or interface in java.io">ObjectInput</a>&nbsp;in)
                  throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                         <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ClassNotFoundException.html?is-external=true" title="class or interface in java.lang">ClassNotFoundException</a></pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html?is-external=true#readExternal(java.io.ObjectInput)" title="class or interface in java.io">readExternal</a></code>&nbsp;in interface&nbsp;<code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html?is-external=true" title="class or interface in java.io">Externalizable</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ClassNotFoundException.html?is-external=true" title="class or interface in java.lang">ClassNotFoundException</a></code></dd></dl>
</li>
</ul>
<a name="writeExternal(java.io.ObjectOutput)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>writeExternal</h4>
<pre>public&nbsp;void&nbsp;writeExternal(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/ObjectOutput.html?is-external=true" title="class or interface in java.io">ObjectOutput</a>&nbsp;out)
                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html?is-external=true#writeExternal(java.io.ObjectOutput)" title="class or interface in java.io">writeExternal</a></code>&nbsp;in interface&nbsp;<code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html?is-external=true" title="class or interface in java.io">Externalizable</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AtomicBlockAppendProc.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/bfs/AbstractRepositoryTestCase.html" title="class in com.bigdata.bfs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/bigdata/bfs/AtomicBlockWriteProc.html" title="class in com.bigdata.bfs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/bfs/AtomicBlockAppendProc.html" target="_top">Frames</a></li>
<li><a href="AtomicBlockAppendProc.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
