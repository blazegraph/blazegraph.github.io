<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Sat Jun 18 19:37:58 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>RWStore (Blazegraph Database Platform 2.1.2 API)</title>
<meta name="date" content="2016-06-18">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="RWStore (Blazegraph Database Platform 2.1.2 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/RWStore.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/rwstore/PSOutputStream.html" title="class in com.bigdata.rwstore"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/bigdata/rwstore/RWStore.AllocationStats.html" title="class in com.bigdata.rwstore"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/rwstore/RWStore.html" target="_top">Frames</a></li>
<li><a href="RWStore.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.rwstore</div>
<h2 title="Class RWStore" class="title">Class RWStore</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.rwstore.RWStore</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../com/bigdata/io/writecache/IBackingReader.html" title="interface in com.bigdata.io.writecache">IBackingReader</a>, <a href="../../../com/bigdata/io/writecache/IBufferedWriter.html" title="interface in com.bigdata.io.writecache">IBufferedWriter</a>, <a href="../../../com/bigdata/rawstore/IStreamStore.html" title="interface in com.bigdata.rawstore">IStreamStore</a>, <a href="../../../com/bigdata/rwstore/IAllocationManager.html" title="interface in com.bigdata.rwstore">IAllocationManager</a>, <a href="../../../com/bigdata/rwstore/IHistoryManager.html" title="interface in com.bigdata.rwstore">IHistoryManager</a>, <a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">RWStore</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a>, <a href="../../../com/bigdata/io/writecache/IBufferedWriter.html" title="interface in com.bigdata.io.writecache">IBufferedWriter</a>, <a href="../../../com/bigdata/io/writecache/IBackingReader.html" title="interface in com.bigdata.io.writecache">IBackingReader</a></pre>
<div class="block">Storage class
 <p>
 Provides an interface to allocating storage within a disk file.
 <p>
 Essentially provides a DiskMalloc interface.
 <p>
 In addition to the DiskMalloc/ReAlloc mechanism, a single root address can be
 associated. This can be used when opening an existing storage file to
 retrieve some management object - such as an object manager!
 <p>
 The allocator also support atomic update via a simple transaction mechanism.
 <p>
 Updates are normally committed immediately, but by using startTransaction and
 commitTransaction, the previous state of the store is retained until the
 moment of commitment.
 <p>
 It would also be possible to add some journaling/version mechanism, where
 snapshots of the allocation maps are retained for sometime. For a store which
 was only added to this would not be an unreasonable overhead and would
 support the rolling back of the database weekly or monthly if required.
 <p>
 The input/output mechanism uses ByteArray Input and Output Streams.
 <p>
 One difference between the disk realloc and in memory realloc is that the
 disk realloc will always return a new address and mark the old address as
 ready to be freed.
 <p>
 The method of storing the allocation headers has been changed from always
 allocating at the end of the file (and moving them on file extend) to
 allocation of fixed areas. The meta-allocation data, containing the bitmap
 that controls these allocations, is itself stored in the heap, and is now
 structured to include both the bit data and the list of meta-storage
 addresses.
 <p>
 Sizing: 256 allocators would reference approximately 2M objects/allocations.
 At 1K per allocator this would require 250K of store. The meta-allocation
 data would therefore need a start address plus 32 bytes (or 8 ints) to
 represent the meta-allocation bits. An array of such data referencing
 sequentially allocated storage areas completes the meta-allocation
 requirements.
 <p>
 A meta-allocation address can therefore be represented as a single bit offset
 from which the block, providing start address, and bit offset can be directly
 determined.
 <p>
 The m_metaBits int array used to be fully used as allocation bits, but now
 stores both the start address plus the 8 ints used to manage that data block.
 <p>
 Allocation is reduced to sets of allocator objects which have a start address
 and a bitmap of allocated storage maps.
 <p>
 Searching thousands of allocation blocks to find storage is not efficient,
 but by utilizing roving pointers and sorting blocks with free space available
 this can be made most efficient.
 <p>
 In order to provide optimum use of bitmaps, this implementation will NOT use
 the BitSet class.
 <p>
 Using the meta-allocation bits, it is straightforward to load ALL the
 allocation headers. A total of (say) 100 allocation headers might provide up
 to 4000 allocations each -> 400 000 objects, while 1000 headers -> 4m objects
 and 2000 -> 8m objects.
 <p>
 The allocators are split into a set of FixedAllocators and then
 BlobAllocation. The FixedAllocators will allocate from 128 to 32K objects,
 with a minimum block allocation of 64K, and a minimum bit number per block of
 32.
 <p>
 Where possible lists and roving pointers will be used to minimize searching
 of the potentially large structures.
 <p>
 Since the memory is allocated on (at least) a 128 byte boundary, there is
 some leeway on storing the address. Added to the address is the shift
 required to make to the "standard" 128 byte block, e.g. blocksize = 128 <<
 (addr % 8)
 <p>
 NB Useful method on RandomAccessFile.setLength(newLength)
 <p>
 When session data is preserved two things must happen - the allocators must
 not reallocate data that has been freed in this session, or more clearly can
 only free data that has been allocated in this session. That should be it.
 <p>
 The ALLOC_SIZES table is the fibonacci sequence. We multiply by 64 bytes to
 get actual allocation block sizes. We then allocate bits based on 8K
 allocation rounding and 32 bits at a time allocation. Note that 4181 * 64 =
 267,584 and 256K is 262,144
 <p>
 All data is checksummed, both allocated/saved data and the allocation blocks.
 <p>
 BLOB allocation is not handled using chained data buffers but with a blob
 header record. This is indicated with a BlobAllocator that provides indexed
 offsets to the header record (the address encodes the BlobAllocator and the
 offset to the address). The header record stores the number of component
 allocations and the address of each.
 <p>
 This approach makes for much more efficient freeing/re-allocation of Blob
 storage, in particular avoiding the need to read in the component blocks to
 determine chained blocks for freeing. This is particularly important for
 larger stores where a disk cache could be flushed through simply freeing BLOB
 allocations.
 <h2>
 Deferred Free List</h2>
 <p>
 The previous implementation has been amended to associate a single set of
 deferredFree blocks with each CommitRecord. The CommitRecordIndex will then
 provide access to the CommitRecords to support the deferred freeing of
 allocations based on age/earliestTxReleaseTime.
 <p>
 The last release time processed is held with the MetaAllocation data</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Martyn Cutcher
 
         FIXME Release checklist:
         <p>
         Add metabits header record checksum field and verify on read back.
         <p>
         Done. Checksum fixed allocators (needs to be tested on read back).
         <p>
         Done. Add version field to the fixed allocator.
         <p>
         Done. Checksum delete blocks / blob records.
         <p>
         PSOutputStream - remove caching logic. It is unused and makes this
         class much more complex. A separate per-RWStore caching class for
         recycling PSOutputStreams can be added later.
         <p>
         Modify FixedAllocator to use arrayCopy() rather than clone and
         declare more fields to be final. See notes on <a href="../../../com/bigdata/rwstore/AllocBlock.html" title="class in com.bigdata.rwstore"><code>AllocBlock</code></a>.
         <p>
         Done. Implement logic to "abort" a shadow allocation context.
         <p>
         Unit test to verify that we do not recycle allocations from the last
         commit point even when the retention time is zero such that it is
         always possible to re-open the store from the alternative root block
         even after you have allocated things against the current root block
         (but not yet committed).
         <p>
         Read-only mode.
         <p>
         Unit tests looking for persistent memory leaks (e.g., all allocated
         space can be reclaimed).</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.AllocationStats.html" title="class in com.bigdata.rwstore">RWStore.AllocationStats</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.DeleteBlockStats.html" title="class in com.bigdata.rwstore">RWStore.DeleteBlockStats</a></strong></code>
<div class="block">Simple class to collect up DeleteBlockStats and returned by
 checkDeleteBlocks, called from DumpJournal.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.Options.html" title="interface in com.bigdata.rwstore">RWStore.Options</a></strong></code>
<div class="block">Options understood by the <a href="../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.RWStoreState.html" title="class in com.bigdata.rwstore">RWStore.RWStoreState</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore">RWStore.StoreCounters</a>&lt;<a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="type parameter in RWStore.StoreCounters">T</a> extends <a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore">RWStore.StoreCounters</a>&lt;<a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="type parameter in RWStore.StoreCounters">T</a>&gt;&gt;</strong></code>
<div class="block">Striped performance counters for <a href="../../../com/bigdata/rawstore/IRawStore.html" title="interface in com.bigdata.rawstore"><code>IRawStore</code></a> access, including
 operations that read or write through to the underlying media.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#RWStore(com.bigdata.journal.FileMetadata,%20com.bigdata.quorum.Quorum)">RWStore</a></strong>(<a href="../../../com/bigdata/journal/FileMetadata.html" title="class in com.bigdata.journal">FileMetadata</a>&nbsp;fileMetadata,
       <a href="../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum">Quorum</a>&lt;?,?&gt;&nbsp;quorum)</code>
<div class="block">The ALLOC_SIZES must be initialized from either the file or the
 properties associated with the fileMetadataView</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#abortContext(com.bigdata.rawstore.IAllocationContext)">abortContext</a></strong>(<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</code>
<div class="block">The ContextAllocation object manages a freeList of associated allocators
 and an overall list of allocators.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#alloc(byte[],%20int,%20com.bigdata.rawstore.IAllocationContext)">alloc</a></strong>(byte[]&nbsp;buf,
     int&nbsp;size,
     <a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</code>
<div class="block">Called by PSOutputStream to make to actual allocation or directly by
 lower level API clients.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#alloc(int,%20com.bigdata.rawstore.IAllocationContext)">alloc</a></strong>(int&nbsp;size,
     <a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</code>
<div class="block">Core allocation method.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#allocBlock(int)">allocBlock</a></strong>(int&nbsp;size)</code>
<div class="block">Return the address of a contiguous region on the persistent heap.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#checkDeferredFrees(com.bigdata.journal.AbstractJournal)">checkDeferredFrees</a></strong>(<a href="../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal">AbstractJournal</a>&nbsp;journal)</code>
<div class="block">This method is invoked during the commit protocol and gives the backing
 store an opportunity to check whether storage associated with deferred
 frees can now be released.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/RWStore.DeleteBlockStats.html" title="class in com.bigdata.rwstore">RWStore.DeleteBlockStats</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#checkDeleteBlocks(com.bigdata.journal.AbstractJournal)">checkDeleteBlocks</a></strong>(<a href="../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal">AbstractJournal</a>&nbsp;journal)</code>
<div class="block">Utility to check the deleteBlocks associated with each active CommitRecord</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#close()">close</a></strong>()</code>
<div class="block">Close the backing storage.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#commit()">commit</a></strong>()</code>
<div class="block">Global commit on the backing store.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#computeDigest(java.lang.Object,%20java.security.MessageDigest)">computeDigest</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;snapshot,
             <a href="http://docs.oracle.com/javase/7/docs/api/java/security/MessageDigest.html?is-external=true" title="class or interface in java.security">MessageDigest</a>&nbsp;digest)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#convertAddr(int)">convertAddr</a></strong>(int&nbsp;addr)</code>
<div class="block">Convert an implicitly scaled int32 offset into the backing file into an
 int64 address into the backing file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#convertFromAddr(long)">convertFromAddr</a></strong>(long&nbsp;addr)</code>
<div class="block">Convert an int64 address into the backing file into an int32 offset that
 is implicitly scaled by <a href="../../../com/bigdata/rwstore/RWStore.html#ALLOCATION_SCALEUP"><code>ALLOCATION_SCALEUP</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#deferFree(int,%20int)">deferFree</a></strong>(int&nbsp;rwaddr,
         int&nbsp;sze)</code>
<div class="block">Adds the address for later freeing to the deferred free list.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#detachContext(com.bigdata.rawstore.IAllocationContext)">detachContext</a></strong>(<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</code>
<div class="block">Indicates that the allocation context will no longer be used, but that
 the allocations made within the context should be preserved.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#ensureMetabitsDemispace(boolean)">ensureMetabitsDemispace</a></strong>(boolean&nbsp;useDemispace)</code>
<div class="block">Forces a reset of the metabits allocation on the next commit.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#establishExtent(long)">establishExtent</a></strong>(long&nbsp;extent)</code>
<div class="block">If the current file extent is different from the required extent then the
 call is made to <a href="../../../com/bigdata/rwstore/RWStore.html#extendFile(int)"><code>extendFile(int)</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#finalize()">finalize</a></strong>()</code>
<div class="block">make sure resource is closed!</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#flushWrites(boolean)">flushWrites</a></strong>(boolean&nbsp;metadata)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#free(long,%20int)">free</a></strong>(long&nbsp;laddr,
    int&nbsp;sze)</code>
<div class="block">Frees allocated storage (clears the bit to enable recycling after
 the next commit).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#free(long,%20int,%20com.bigdata.rawstore.IAllocationContext)">free</a></strong>(long&nbsp;laddr,
    int&nbsp;sze,
    <a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</code>
<div class="block">free</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getActiveTxCount()">getActiveTxCount</a></strong>()</code>
<div class="block">Debug ONLY method added to permit unit tests to be written that the
 native transaction counter is correctly decremented to zero.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getAllocatedBlocks()">getAllocatedBlocks</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getAllocatedSlots()">getAllocatedSlots</a></strong>()</code>
<div class="block">Computes the amount of utilised storage</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/Allocator.html" title="interface in com.bigdata.rwstore">Allocator</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getAllocator(int)">getAllocator</a></strong>(int&nbsp;i)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getAssociatedSlotSize(int)">getAssociatedSlotSize</a></strong>(int&nbsp;addr)</code>
<div class="block">Returns the slot size associated with this address</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getBlockSequence()">getBlockSequence</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html?is-external=true" title="class or interface in java.util.concurrent.locks">Lock</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getCommitLock()">getCommitLock</a></strong>()</code>
<div class="block">Optionally return a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html?is-external=true" title="class or interface in java.util.concurrent.locks"><code>Lock</code></a> that must be used (when non-
 <code>null</code>) to make the <a href="../../../com/bigdata/rwstore/IStore.html#commit()"><code>IStore.commit()</code></a> / <a href="../../../com/bigdata/rwstore/IStore.html#postCommit()"><code>IStore.postCommit()</code></a>
 strategy atomic.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getCounters()">getCounters</a></strong>()</code>
<div class="block">Return interesting information about the write cache and file operations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getCurrentBlockSequence()">getCurrentBlockSequence</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getData(long,%20byte[])">getData</a></strong>(long&nbsp;addr,
       byte[]&nbsp;buf)</code>
<div class="block">If the buf[] size is greater than the maximum fixed allocation, then the
 direct read will be the blob header record.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getData(long,%20byte[],%20int,%20int)">getData</a></strong>(long&nbsp;addr,
       byte[]&nbsp;buf,
       int&nbsp;offset,
       int&nbsp;length)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getData(long,%20int)">getData</a></strong>(long&nbsp;rwaddr,
       int&nbsp;sze)</code>
<div class="block">Alternative method signature returning a ByteBuffer rather than receiving a
 byte array.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getFileStorage()">getFileStorage</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getFixedAllocatorCount()">getFixedAllocatorCount</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io">InputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getInputStream(long)">getInputStream</a></strong>(long&nbsp;addr)</code>
<div class="block">Return an input stream from which a previously written stream may be read
 back.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getLastReleaseTime()">getLastReleaseTime</a></strong>()</code>
<div class="block">If history is retained this returns the time for which data was most
 recently released.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getMaxAllocSize()">getMaxAllocSize</a></strong>()</code>
<div class="block">The maximum allocation size (bytes).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getMaxBlobSize()">getMaxBlobSize</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getMaxFileSize()">getMaxFileSize</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getMetaBitsAddr()">getMetaBitsAddr</a></strong>()</code>
<div class="block">Since we need to store the absolute address and the size can be
 a maximum of 64K, the absolute address is limited to 48 bits, setting
 the maximum address as 140T, which is sufficient.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getMetaBitsStoreAddress()">getMetaBitsStoreAddress</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getMetaStartAddr()">getMetaStartAddr</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getNextOffset()">getNextOffset</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rawstore/IPSOutputStream.html" title="class in com.bigdata.rawstore">IPSOutputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getOutputStream()">getOutputStream</a></strong>()</code>
<div class="block">Return an output stream which can be used to write on the backing store.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rawstore/IPSOutputStream.html" title="class in com.bigdata.rawstore">IPSOutputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getOutputStream(com.bigdata.rawstore.IAllocationContext)">getOutputStream</a></strong>(<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getSlotSize(int)">getSlotSize</a></strong>(int&nbsp;data_len)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/StorageStats.html" title="class in com.bigdata.rwstore">StorageStats</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getStorageStats()">getStorageStats</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore">RWStore.StoreCounters</a>&lt;?&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getStoreCounters()">getStoreCounters</a></strong>()</code>
<div class="block">Returns the striped performance counters for the store.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getStoreFile()">getStoreFile</a></strong>()</code>
<div class="block">Retrieves store file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/journal/StoreState.html" title="interface in com.bigdata.journal">StoreState</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getStoreState()">getStoreState</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getTotalAllocations()">getTotalAllocations</a></strong>()</code>
<div class="block">The # of allocation requests made.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getTotalAllocationsSize()">getTotalAllocationsSize</a></strong>()</code>
<div class="block">The # of bytes requested - as opposed to the size of the slots allocated.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getTotalFrees()">getTotalFrees</a></strong>()</code>
<div class="block">The # of free requests made</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getWriteCacheCounters()">getWriteCacheCounters</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/RWWriteCacheService.html" title="class in com.bigdata.rwstore">RWWriteCacheService</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#getWriteCacheService()">getWriteCacheService</a></strong>()</code>
<div class="block">Return the then current <a href="../../../com/bigdata/io/writecache/WriteCacheService.html" title="class in com.bigdata.io.writecache"><code>WriteCacheService</code></a> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#inWriteCache(int)">inWriteCache</a></strong>(int&nbsp;rwaddr)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#isCommitted(int)">isCommitted</a></strong>(int&nbsp;rwaddr)</code>
<div class="block">Return <code>true</code> iff the allocation having that address is
 flagged as committed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#isDirty()">isDirty</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#isNativeAddress(long)">isNativeAddress</a></strong>(long&nbsp;addr)</code>
<div class="block">The <a href="../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a> always generates negative address values.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#isOpen()">isOpen</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#isUsingDemiSpace()">isUsingDemiSpace</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#lockAddress(int)">lockAddress</a></strong>(int&nbsp;addr)</code>
<div class="block">lockAddress adds the address passed to a lock list.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#newAllocationContext(boolean)">newAllocationContext</a></strong>(boolean&nbsp;isolated)</code>
<div class="block">Creates a context to be used to isolate updates to within the context until it
 is released to the parent environment.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/IRawTx.html" title="interface in com.bigdata.rwstore">IRawTx</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#newTx()">newTx</a></strong>()</code>
<div class="block">A hook used to support session protection by incrementing and
 decrementing a transaction counter within the <a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore"><code>IStore</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#physicalAddress(int)">physicalAddress</a></strong>(int&nbsp;addr)</code>
<div class="block">Return the byte offset in the file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#postCommit()">postCommit</a></strong>()</code>
<div class="block">Hook that supports synchronization with an external commit before which
 a rollback to "pre-commit" state is supported.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#postHACommit(com.bigdata.journal.IRootBlockView)">postHACommit</a></strong>(<a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal">IRootBlockView</a>&nbsp;rbv)</code>
<div class="block">Called from <a href="../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal"><code>AbstractJournal</code></a> commit2Phase to ensure that a
 downstream HA quorum member ensures it is able to read committed data
 that has been streamed directly to the backing store.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#readAllocationBlocks()">readAllocationBlocks</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#readFromLatchedAddress(int)">readFromLatchedAddress</a></strong>(int&nbsp;nxtAddr)</code>
<div class="block">A low level utility method that reads directly from the backing
 <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html?is-external=true" title="class or interface in java.nio.channels"><code>FileChannel</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#readRaw(long,%20java.nio.ByteBuffer)">readRaw</a></strong>(long&nbsp;offset,
       <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;dst)</code>
<div class="block">Read on the backing file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#readRootBlock(boolean)">readRootBlock</a></strong>(boolean&nbsp;rootBlock0)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../com/bigdata/rwstore/PSOutputStream.html" title="class in com.bigdata.rwstore">PSOutputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#realloc(long,%20int)">realloc</a></strong>(long&nbsp;oldAddr,
       int&nbsp;size)</code>
<div class="block">The base realloc method that returns a stream for writing to rather than
 handle the reallocation immediately.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#registerExternalCache(com.bigdata.cache.ConcurrentWeakValueCache,%20int)">registerExternalCache</a></strong>(<a href="../../../com/bigdata/cache/ConcurrentWeakValueCache.html" title="class in com.bigdata.cache">ConcurrentWeakValueCache</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../com/bigdata/journal/ICommitter.html" title="interface in com.bigdata.journal">ICommitter</a>&gt;&nbsp;externalCache,
                     int&nbsp;dataSize)</code>
<div class="block">Call made from AbstractJournal to register the cache used.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#requiresCommit()">requiresCommit</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#reset()">reset</a></strong>()</code>
<div class="block">The semantics of reset are to revert unisolated writes to committed
 state.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#resetFromHARootBlock(com.bigdata.journal.IRootBlockView)">resetFromHARootBlock</a></strong>(<a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal">IRootBlockView</a>&nbsp;rootBlock)</code>
<div class="block">Low level routine used when we replace the root blocks of an empty
 journal in HA with those from the leader.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#saveDeferrals()">saveDeferrals</a></strong>()</code>
<div class="block">Saves the current list of delete blocks, returning the address allocated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html?is-external=true" title="class or interface in java.util.concurrent">Future</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Void.html?is-external=true" title="class or interface in java.lang">Void</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#sendHALogBuffer(com.bigdata.ha.msg.IHALogRequest,%20com.bigdata.ha.msg.IHAWriteMessage,%20com.bigdata.io.IBufferAccess)">sendHALogBuffer</a></strong>(<a href="../../../com/bigdata/ha/msg/IHALogRequest.html" title="interface in com.bigdata.ha.msg">IHALogRequest</a>&nbsp;req,
               <a href="../../../com/bigdata/ha/msg/IHAWriteMessage.html" title="interface in com.bigdata.ha.msg">IHAWriteMessage</a>&nbsp;msg,
               <a href="../../../com/bigdata/io/IBufferAccess.html" title="interface in com.bigdata.io">IBufferAccess</a>&nbsp;buf)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html?is-external=true" title="class or interface in java.util.concurrent">Future</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Void.html?is-external=true" title="class or interface in java.lang">Void</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#sendRawBuffer(com.bigdata.ha.msg.IHARebuildRequest,%20long,%20long,%20long,%20long,%20int,%20java.nio.ByteBuffer)">sendRawBuffer</a></strong>(<a href="../../../com/bigdata/ha/msg/IHARebuildRequest.html" title="interface in com.bigdata.ha.msg">IHARebuildRequest</a>&nbsp;req,
             long&nbsp;sequence,
             long&nbsp;quorumToken,
             long&nbsp;fileExtent,
             long&nbsp;offset,
             int&nbsp;nbytes,
             <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;b)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#setStoreCounters(com.bigdata.rwstore.RWStore.StoreCounters)">setStoreCounters</a></strong>(<a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore">RWStore.StoreCounters</a>&lt;?&gt;&nbsp;storeCounters)</code>
<div class="block">Replaces the <a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore"><code>RWStore.StoreCounters</code></a> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#showAllocators(java.lang.StringBuilder)">showAllocators</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html?is-external=true" title="class or interface in java.lang">StringBuilder</a>&nbsp;str)</code>
<div class="block">Utility debug outputing the allocator array, showing index, start
 address and alloc type/size
 
 Collected statistics are against each Allocation Block size:
 total number of slots | store size
 number of filled slots | store used
 
 AllocatorSizeThe #of bytes in the allocated slots issued by this allocator.
 AllocatorCountThe #of fixed allocators for that slot size.
 SlotsInUseThe difference between the two previous columns (net slots in use for this slot size).
 SlotsReservedThe #of slots in this slot size which have had storage reserved for them.
 SlotsAllocatedCumulative allocation of slots to date in this slot size (regardless of the transaction outcome).
 SlotsRecycledCumulative recycled slots to date in this slot size (regardless of the transaction outcome).
 SlotsChurnHow frequently slots of this size are re-allocated (SlotsInUse/SlotsAllocated).
 %SlotsUnusedThe percentage of slots of this size which are not in use (1-(SlotsInUse/SlotsReserved)).
 BytesReservedThe space reserved on the backing file for those allocation slots
 BytesAppDataThe #of bytes in the allocated slots which are used by application data (including the record checksum).
 %SlotWasteHow well the application data fits in the slots (BytesAppData/(SlotsInUse*AllocatorSize)).
 %AppDataHow much of your data is stored by each allocator (BytesAppData/Sum(BytesAppData)).
 %StoreFileHow much of the backing file is reserved for each allocator (BytesReserved/Sum(BytesReserved)).
 %StoreWasteHow much of the total waste on the store is waste for this allocator size ((BytesReserved-BytesAppData)/(Sum(BytesReserved)-Sum(BytesAppData))).
 </div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#showWriteCacheDebug(long)">showWriteCacheDebug</a></strong>(long&nbsp;paddr)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#snapshotAllocators(com.bigdata.journal.AbstractJournal.ISnapshotData)">snapshotAllocators</a></strong>(<a href="../../../com/bigdata/journal/AbstractJournal.ISnapshotData.html" title="interface in com.bigdata.journal">AbstractJournal.ISnapshotData</a>&nbsp;tm)</code>
<div class="block">Add the address/allocator associated with each FixedAllocator to the snapshot map</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#snapshotMetabits(com.bigdata.journal.AbstractJournal.ISnapshotData)">snapshotMetabits</a></strong>(<a href="../../../com/bigdata/journal/AbstractJournal.ISnapshotData.html" title="interface in com.bigdata.journal">AbstractJournal.ISnapshotData</a>&nbsp;tm)</code>
<div class="block">Add the address/byte[] to the snapshot representing the metabits allocaiton data</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#verify(long)">verify</a></strong>(long&nbsp;laddr)</code>
<div class="block">Given a physical address (byte offset on the store), return true if that
 address could be managed by an allocated block.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#verifyAllocatedAddress(long)">verifyAllocatedAddress</a></strong>(long&nbsp;addr)</code>
<div class="block">Can be used to determine if an address is within an allocated slot.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#writeOnStream(java.io.OutputStream,%20com.bigdata.journal.AbstractJournal.ISnapshotData,%20com.bigdata.quorum.Quorum,%20long)">writeOnStream</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;os,
             <a href="../../../com/bigdata/journal/AbstractJournal.ISnapshotData.html" title="interface in com.bigdata.journal">AbstractJournal.ISnapshotData</a>&nbsp;snapshotData,
             <a href="../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum">Quorum</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>,<a href="../../../com/bigdata/ha/QuorumService.html" title="interface in com.bigdata.ha">QuorumService</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>&gt;&gt;&nbsp;quorum,
             long&nbsp;token)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#writeOnStream2(java.io.OutputStream,%20java.util.Set,%20com.bigdata.quorum.Quorum,%20long)">writeOnStream2</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;os,
              <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util">Map.Entry</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,byte[]&gt;&gt;&nbsp;snapshotData,
              <a href="../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum">Quorum</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>,<a href="../../../com/bigdata/ha/QuorumService.html" title="interface in com.bigdata.ha">QuorumService</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>&gt;&gt;&nbsp;quorum,
              long&nbsp;token)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#writeRaw(long,%20java.nio.ByteBuffer)">writeRaw</a></strong>(long&nbsp;offset,
        <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;transfer)</code>
<div class="block">Used as part of the rebuild protocol</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#writeRawBuffer(com.bigdata.ha.msg.IHAWriteMessage,%20com.bigdata.io.IBufferAccess)">writeRawBuffer</a></strong>(<a href="../../../com/bigdata/ha/msg/IHAWriteMessage.html" title="interface in com.bigdata.ha.msg">IHAWriteMessage</a>&nbsp;msg,
              <a href="../../../com/bigdata/io/IBufferAccess.html" title="interface in com.bigdata.io">IBufferAccess</a>&nbsp;b)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/bigdata/rwstore/RWStore.html#writeRootBlock(com.bigdata.journal.IRootBlockView,%20com.bigdata.journal.ForceEnum)">writeRootBlock</a></strong>(<a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal">IRootBlockView</a>&nbsp;rootBlock,
              <a href="../../../com/bigdata/journal/ForceEnum.html" title="enum in com.bigdata.journal">ForceEnum</a>&nbsp;forceOnCommit)</code>
<div class="block">This can be called as part of the HA downstream replication.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="RWStore(com.bigdata.journal.FileMetadata, com.bigdata.quorum.Quorum)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>RWStore</h4>
<pre>public&nbsp;RWStore(<a href="../../../com/bigdata/journal/FileMetadata.html" title="class in com.bigdata.journal">FileMetadata</a>&nbsp;fileMetadata,
       <a href="../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum">Quorum</a>&lt;?,?&gt;&nbsp;quorum)</pre>
<div class="block">The ALLOC_SIZES must be initialized from either the file or the
 properties associated with the fileMetadataView</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fileMetadataView</code> - </dd><dd><code>readOnly</code> - </dd><dd><code>quorum</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getWriteCacheService()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWriteCacheService</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/RWWriteCacheService.html" title="class in com.bigdata.rwstore">RWWriteCacheService</a>&nbsp;getWriteCacheService()</pre>
<div class="block">Return the then current <a href="../../../com/bigdata/io/writecache/WriteCacheService.html" title="class in com.bigdata.io.writecache"><code>WriteCacheService</code></a> object.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/journal/IHABufferStrategy.html#getWriteCacheService()"><code>IHABufferStrategy.getWriteCacheService()</code></a></dd></dl>
</li>
</ul>
<a name="isOpen()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isOpen</h4>
<pre>public&nbsp;boolean&nbsp;isOpen()</pre>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html#close()">IStore</a></code></strong></div>
<div class="block">Close the backing storage.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#close()">close</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
</dl>
</li>
</ul>
<a name="finalize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finalize</h4>
<pre>protected&nbsp;void&nbsp;finalize()</pre>
<div class="block">make sure resource is closed!</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a></code>&nbsp;in class&nbsp;<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
<a name="readAllocationBlocks()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readAllocationBlocks</h4>
<pre>protected&nbsp;void&nbsp;readAllocationBlocks()
                             throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="getMaxFileSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxFileSize</h4>
<pre>public&nbsp;long&nbsp;getMaxFileSize()</pre>
</li>
</ul>
<a name="getData(long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getData</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;getData(long&nbsp;rwaddr,
                 int&nbsp;sze)</pre>
<div class="block">Alternative method signature returning a ByteBuffer rather than receiving a
 byte array.
 <p>
 If a blob then an extra byte array is required in which to build the data,
 but otherwise extra buffering could be avoided be reading directly from
 the WriteCacheService.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>rwaddr</code> - </dd><dd><code>sze</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="getData(long, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getData</h4>
<pre>public&nbsp;void&nbsp;getData(long&nbsp;addr,
           byte[]&nbsp;buf)</pre>
<div class="block">If the buf[] size is greater than the maximum fixed allocation, then the
 direct read will be the blob header record. In this case we should hand
 over the streaming to a PSInputStream.
 
 FIXME: Javadoc update (was: For now we do not use the PSInputStream but instead process
 directly...)
 
 If it is a BlobAllocation, then the BlobAllocation address points to the
 address of the BlobHeader record.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#getData(long,%20byte[])">getData</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - the address of the data</dd><dd><code>buf</code> - the buffer of the size required!</dd></dl>
</li>
</ul>
<a name="getData(long, byte[], int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getData</h4>
<pre>public&nbsp;void&nbsp;getData(long&nbsp;addr,
           byte[]&nbsp;buf,
           int&nbsp;offset,
           int&nbsp;length)</pre>
</li>
</ul>
<a name="free(long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>free</h4>
<pre>public&nbsp;void&nbsp;free(long&nbsp;laddr,
        int&nbsp;sze)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html#free(long,%20int)">IStore</a></code></strong></div>
<div class="block">Frees allocated storage (clears the bit to enable recycling after
 the next commit).</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#free(long,%20int)">free</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>laddr</code> - the storage address to be freed</dd></dl>
</li>
</ul>
<a name="free(long, int, com.bigdata.rawstore.IAllocationContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>free</h4>
<pre>public&nbsp;void&nbsp;free(long&nbsp;laddr,
        int&nbsp;sze,
        <a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</pre>
<div class="block">free
 <p>
 If the address is greater than zero than it is interpreted as a physical
 address and the allocators are searched to find the allocations.
 Otherwise the address directly encodes the allocator index and bit
 offset, allowing direct access to clear the allocation.
 <p>
 A blob allocator contains the allocator index and offset, so an allocator
 contains up to 245 blob references.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>laddr</code> - </dd><dd><code>sze</code> - </dd><dd><code>context</code> - </dd></dl>
</li>
</ul>
<a name="alloc(int, com.bigdata.rawstore.IAllocationContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>alloc</h4>
<pre>public&nbsp;int&nbsp;alloc(int&nbsp;size,
        <a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</pre>
<div class="block">Core allocation method.</div>
</li>
</ul>
<a name="realloc(long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>realloc</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/PSOutputStream.html" title="class in com.bigdata.rwstore">PSOutputStream</a>&nbsp;realloc(long&nbsp;oldAddr,
                     int&nbsp;size)</pre>
<div class="block">The base realloc method that returns a stream for writing to rather than
 handle the reallocation immediately.</div>
</li>
</ul>
<a name="alloc(byte[], int, com.bigdata.rawstore.IAllocationContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>alloc</h4>
<pre>public&nbsp;long&nbsp;alloc(byte[]&nbsp;buf,
         int&nbsp;size,
         <a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</pre>
<div class="block">Called by PSOutputStream to make to actual allocation or directly by
 lower level API clients.
 <p>
 If the allocation is for greater than MAX_FIXED_ALLOC, then a
 PSOutputStream is used to manage the chained buffers.
 
 TODO: Instead of using PSOutputStream, manage allocations written to the
 WriteCacheService, building BlobHeader as you go.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#alloc(byte[],%20int,%20com.bigdata.rawstore.IAllocationContext)">alloc</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the allocated address</dd></dl>
</li>
</ul>
<a name="reset()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reset</h4>
<pre>public&nbsp;void&nbsp;reset()</pre>
<div class="block">The semantics of reset are to revert unisolated writes to committed
 state.
 <p>
 Unisolated writes must also be removed from the write cache.
 <p>
 The AllocBlocks of the FixedAllocators maintain the state to determine
 the correct reset behavior.
 <p>
 If the store is using DirectFixedAllocators then an IllegalStateException
 is thrown.
 <p>
 If there is an active <a href="../../../com/bigdata/rwstore/RWStore.html#m_commitStateRef"><code>m_commitStateRef</code></a>, then this indicates a
 failure after the <a href="../../../com/bigdata/rwstore/RWStore.html#commit()"><code>commit()</code></a> had "succeeded".</div>
</li>
</ul>
<a name="isDirty()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDirty</h4>
<pre>public&nbsp;boolean&nbsp;isDirty()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="commit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public&nbsp;void&nbsp;commit()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html#commit()">IStore</a></code></strong></div>
<div class="block">Global commit on the backing store. Previously committed data which has
 been marked as <a href="../../../com/bigdata/rwstore/IStore.html#free(long,%20int)"><code>IStore.free(long, int)</code></a> is now available for recycling.
 However, recycling can not occur if session protection is active.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#commit()">commit</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
</dl>
</li>
</ul>
<a name="getCommitLock()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCommitLock</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html?is-external=true" title="class or interface in java.util.concurrent.locks">Lock</a>&nbsp;getCommitLock()</pre>
<div class="block">Optionally return a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html?is-external=true" title="class or interface in java.util.concurrent.locks"><code>Lock</code></a> that must be used (when non-
 <code>null</code>) to make the <a href="../../../com/bigdata/rwstore/IStore.html#commit()"><code>IStore.commit()</code></a> / <a href="../../../com/bigdata/rwstore/IStore.html#postCommit()"><code>IStore.postCommit()</code></a>
 strategy atomic.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#getCommitLock()">getCommitLock</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
</dl>
</li>
</ul>
<a name="postCommit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>postCommit</h4>
<pre>public&nbsp;void&nbsp;postCommit()</pre>
<div class="block">Hook that supports synchronization with an external commit before which
 a rollback to "pre-commit" state is supported.
 <p>
 Commits the FixedAllocator bits</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#postCommit()">postCommit</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
</dl>
</li>
</ul>
<a name="checkDeferredFrees(com.bigdata.journal.AbstractJournal)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkDeferredFrees</h4>
<pre>public&nbsp;int&nbsp;checkDeferredFrees(<a href="../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal">AbstractJournal</a>&nbsp;journal)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#checkDeferredFrees(com.bigdata.journal.AbstractJournal)">IHistoryManager</a></code></strong></div>
<div class="block">This method is invoked during the commit protocol and gives the backing
 store an opportunity to check whether storage associated with deferred
 frees can now be released. The backing store needs to reply the deferred
 free blocks for the commit points that will be released, mark those
 addresses as free, and free the logged delete blocks.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#checkDeferredFrees(com.bigdata.journal.AbstractJournal)">checkDeferredFrees</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html" title="interface in com.bigdata.rwstore">IHistoryManager</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>number of addresses freed</dd><dt><span class="strong">See Also:</span></dt><dd><code>AbstractJournal#commitNow()</code></dd></dl>
</li>
</ul>
<a name="allocBlock(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allocBlock</h4>
<pre>protected&nbsp;int&nbsp;allocBlock(int&nbsp;size)</pre>
<div class="block">Return the address of a contiguous region on the persistent heap.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>size</code> - The size of that region (this is not bytes, but something a
            bit more complicated).</dd></dl>
</li>
</ul>
<a name="convertAddr(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>convertAddr</h4>
<pre>public static&nbsp;long&nbsp;convertAddr(int&nbsp;addr)</pre>
<div class="block">Convert an implicitly scaled int32 offset into the backing file into an
 int64 address into the backing file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - An int32 offset into the backing file formed by
            <a href="../../../com/bigdata/rwstore/RWStore.html#convertFromAddr(long)"><code>convertFromAddr(long)</code></a>. The representation is a
            negative integer that has been left shifted by
            <a href="../../../com/bigdata/rwstore/RWStore.html#ALLOCATION_SCALEUP"><code>ALLOCATION_SCALEUP</code></a> to reduce its bit size.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A byte offset in the backing file.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/rwstore/RWStore.html#convertFromAddr(long)"><code>convertFromAddr(long)</code></a>, 
<a href="../../../com/bigdata/rwstore/RWStore.html#ALLOCATION_SCALEUP"><code>ALLOCATION_SCALEUP</code></a></dd></dl>
</li>
</ul>
<a name="convertFromAddr(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>convertFromAddr</h4>
<pre>public&nbsp;int&nbsp;convertFromAddr(long&nbsp;addr)</pre>
<div class="block">Convert an int64 address into the backing file into an int32 offset that
 is implicitly scaled by <a href="../../../com/bigdata/rwstore/RWStore.html#ALLOCATION_SCALEUP"><code>ALLOCATION_SCALEUP</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - An int64 offset into the backing file.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The implicitly scaled int32 offset.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/rwstore/RWStore.html#convertAddr(int)"><code>convertAddr(int)</code></a>, 
<a href="../../../com/bigdata/rwstore/RWStore.html#ALLOCATION_SCALEUP"><code>ALLOCATION_SCALEUP</code></a></dd></dl>
</li>
</ul>
<a name="showAllocators(java.lang.StringBuilder)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showAllocators</h4>
<pre>public&nbsp;void&nbsp;showAllocators(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html?is-external=true" title="class or interface in java.lang">StringBuilder</a>&nbsp;str)</pre>
<div class="block">Utility debug outputing the allocator array, showing index, start
 address and alloc type/size
 
 Collected statistics are against each Allocation Block size:
 total number of slots | store size
 number of filled slots | store used
 <dl>
 <dt>AllocatorSize</dt><dd>The #of bytes in the allocated slots issued by this allocator.</dd>
 <dt>AllocatorCount</dt><dd>The #of fixed allocators for that slot size.</dd>
 <dt>SlotsInUse</dt><dd>The difference between the two previous columns (net slots in use for this slot size).</dd>
 <dt>SlotsReserved</dt><dd>The #of slots in this slot size which have had storage reserved for them.</dd>
 <dt>SlotsAllocated</dt><dd>Cumulative allocation of slots to date in this slot size (regardless of the transaction outcome).</dd>
 <dt>SlotsRecycled</dt><dd>Cumulative recycled slots to date in this slot size (regardless of the transaction outcome).</dd>
 <dt>SlotsChurn</dt><dd>How frequently slots of this size are re-allocated (SlotsInUse/SlotsAllocated).</dd>
 <dt>%SlotsUnused</dt><dd>The percentage of slots of this size which are not in use (1-(SlotsInUse/SlotsReserved)).</dd>
 <dt>BytesReserved</dt><dd>The space reserved on the backing file for those allocation slots</dd>
 <dt>BytesAppData</dt><dd>The #of bytes in the allocated slots which are used by application data (including the record checksum).</dd>
 <dt>%SlotWaste</dt><dd>How well the application data fits in the slots (BytesAppData/(SlotsInUse*AllocatorSize)).</dd>
 <dt>%AppData</dt><dd>How much of your data is stored by each allocator (BytesAppData/Sum(BytesAppData)).</dd>
 <dt>%StoreFile</dt><dd>How much of the backing file is reserved for each allocator (BytesReserved/Sum(BytesReserved)).</dd>
 <dt>%StoreWaste</dt><dd>How much of the total waste on the store is waste for this allocator size ((BytesReserved-BytesAppData)/(Sum(BytesReserved)-Sum(BytesAppData))).</dd>
 </dl></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/rwstore/StorageStats.html#showStats(java.lang.StringBuilder)"><code>StorageStats.showStats(StringBuilder)</code></a></dd></dl>
</li>
</ul>
<a name="verify(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verify</h4>
<pre>public&nbsp;boolean&nbsp;verify(long&nbsp;laddr)</pre>
<div class="block">Given a physical address (byte offset on the store), return true if that
 address could be managed by an allocated block.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>a</code> - the storage address to be tested.</dd></dl>
</li>
</ul>
<a name="physicalAddress(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>physicalAddress</h4>
<pre>public final&nbsp;long&nbsp;physicalAddress(int&nbsp;addr)</pre>
<div class="block">Return the byte offset in the file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - A latched address.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The byte offset.</dd></dl>
</li>
</ul>
<a name="isNativeAddress(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isNativeAddress</h4>
<pre>public&nbsp;boolean&nbsp;isNativeAddress(long&nbsp;addr)</pre>
<div class="block">The <a href="../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a> always generates negative address values.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>whether the address given is a native IStore address</dd></dl>
</li>
</ul>
<a name="getStoreFile()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStoreFile</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;getStoreFile()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html#getStoreFile()">IStore</a></code></strong></div>
<div class="block">Retrieves store file. Can be used to delete the store after the IStore
 has been released</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#getStoreFile()">getStoreFile</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the File object</dd></dl>
</li>
</ul>
<a name="requiresCommit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>requiresCommit</h4>
<pre>public&nbsp;boolean&nbsp;requiresCommit()</pre>
</li>
</ul>
<a name="getMetaBitsAddr()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMetaBitsAddr</h4>
<pre>public&nbsp;long&nbsp;getMetaBitsAddr()</pre>
<div class="block">Since we need to store the absolute address and the size can be
 a maximum of 64K, the absolute address is limited to 48 bits, setting
 the maximum address as 140T, which is sufficient.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>long representation of metaBitsAddr PLUS the size</dd></dl>
</li>
</ul>
<a name="getMetaBitsStoreAddress()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMetaBitsStoreAddress</h4>
<pre>public&nbsp;long&nbsp;getMetaBitsStoreAddress()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>the address of the metaBits</dd></dl>
</li>
</ul>
<a name="getMetaStartAddr()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMetaStartAddr</h4>
<pre>public&nbsp;long&nbsp;getMetaStartAddr()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>long representation of metaStartAddr PLUS the size where addr +
         size is fileSize (not necessarily physical size)</dd></dl>
</li>
</ul>
<a name="getNextOffset()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextOffset</h4>
<pre>public&nbsp;long&nbsp;getNextOffset()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>the nextAllocation from the file Heap to be provided to an
         Allocation Block</dd></dl>
</li>
</ul>
<a name="flushWrites(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushWrites</h4>
<pre>public&nbsp;void&nbsp;flushWrites(boolean&nbsp;metadata)
                 throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="getTotalAllocations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTotalAllocations</h4>
<pre>public&nbsp;long&nbsp;getTotalAllocations()</pre>
<div class="block">The # of allocation requests made.</div>
</li>
</ul>
<a name="getTotalFrees()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTotalFrees</h4>
<pre>public&nbsp;long&nbsp;getTotalFrees()</pre>
<div class="block">The # of free requests made</div>
</li>
</ul>
<a name="getTotalAllocationsSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTotalAllocationsSize</h4>
<pre>public&nbsp;long&nbsp;getTotalAllocationsSize()</pre>
<div class="block">The # of bytes requested - as opposed to the size of the slots allocated.</div>
</li>
</ul>
<a name="getAllocator(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllocator</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/Allocator.html" title="interface in com.bigdata.rwstore">Allocator</a>&nbsp;getAllocator(int&nbsp;i)</pre>
</li>
</ul>
<a name="establishExtent(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>establishExtent</h4>
<pre>public&nbsp;void&nbsp;establishExtent(long&nbsp;extent)</pre>
<div class="block">If the current file extent is different from the required extent then the
 call is made to <a href="../../../com/bigdata/rwstore/RWStore.html#extendFile(int)"><code>extendFile(int)</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>extent</code> - The new file extent.</dd></dl>
</li>
</ul>
<a name="getFixedAllocatorCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFixedAllocatorCount</h4>
<pre>public&nbsp;int&nbsp;getFixedAllocatorCount()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>number of FixedAllocators</dd></dl>
</li>
</ul>
<a name="getAllocatedBlocks()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllocatedBlocks</h4>
<pre>public&nbsp;int&nbsp;getAllocatedBlocks()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>the number of heap allocations made to the FixedAllocators.</dd></dl>
</li>
</ul>
<a name="getFileStorage()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileStorage</h4>
<pre>public&nbsp;long&nbsp;getFileStorage()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>the amount of heap storage assigned to the FixedAllocators.</dd></dl>
</li>
</ul>
<a name="getAllocatedSlots()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllocatedSlots</h4>
<pre>public&nbsp;long&nbsp;getAllocatedSlots()</pre>
<div class="block">Computes the amount of utilised storage</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the amount of storage to alloted slots in the allocation blocks</dd></dl>
</li>
</ul>
<a name="deferFree(int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deferFree</h4>
<pre>public&nbsp;void&nbsp;deferFree(int&nbsp;rwaddr,
             int&nbsp;sze)</pre>
<div class="block">Adds the address for later freeing to the deferred free list.
 <p>
 If the allocation is for a BLOB then the sze is also stored
 <p>
 The deferred list is checked on AllocBlock and prior to commit.
 <p>
 DeferredFrees are written to the deferred PSOutputStream</div>
</li>
</ul>
<a name="saveDeferrals()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveDeferrals</h4>
<pre>public&nbsp;long&nbsp;saveDeferrals()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#saveDeferrals()">IHistoryManager</a></code></strong></div>
<div class="block">Saves the current list of delete blocks, returning the address allocated.
 This can be used later to retrieve the addresses of allocations to be
 freed.
 <p>
 Writes the content of currentTxnFreeList to the store.
 <p>
 These are the current buffered frees that have yet been saved into a
 block referenced from the deferredFreeList</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#saveDeferrals()">saveDeferrals</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html" title="interface in com.bigdata.rwstore">IHistoryManager</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the address of the deferred addresses saved on the store, or zero
         if none.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/journal/DeleteBlockCommitter.html" title="class in com.bigdata.journal"><code>DeleteBlockCommitter</code></a></dd></dl>
</li>
</ul>
<a name="detachContext(com.bigdata.rawstore.IAllocationContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>detachContext</h4>
<pre>public&nbsp;void&nbsp;detachContext(<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</pre>
<div class="block">Indicates that the allocation context will no longer be used, but that
 the allocations made within the context should be preserved. The
 allocations associated with the context are propagated to the parent
 allocation context. The <a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore"><code>IStore</code></a> is the top-level parent of
 allocation contexts. The allocators associated with the allocation
 context are return to the global list of available allocators.
 <p>
 The <code>ContextAllocation</code> object manages a freeList of associated
 allocators and an overall list of allocators. When the context is
 detached, all allocators must be released and any that has available
 capacity will be assigned to the global free lists. See
 <a href="../../../com/bigdata/rwstore/AllocBlock.html" title="class in com.bigdata.rwstore"><code>#releaseSession</code></a></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IAllocationManager.html#detachContext(com.bigdata.rawstore.IAllocationContext)">detachContext</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IAllocationManager.html" title="interface in com.bigdata.rwstore">IAllocationManager</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>context</code> - The context to be released from all <a href="../../../com/bigdata/rwstore/FixedAllocator.html" title="class in com.bigdata.rwstore"><code>FixedAllocator</code></a>s.</dd></dl>
</li>
</ul>
<a name="abortContext(com.bigdata.rawstore.IAllocationContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abortContext</h4>
<pre>public&nbsp;void&nbsp;abortContext(<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</pre>
<div class="block">The ContextAllocation object manages a freeList of associated allocators
 and an overall list of allocators.  When the context is aborted then
 allocations made by that context should be released.
  See <a href="../../../com/bigdata/rwstore/AllocBlock.html" title="class in com.bigdata.rwstore"><code>#abortShadow</code></a></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IAllocationManager.html#abortContext(com.bigdata.rawstore.IAllocationContext)">abortContext</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IAllocationManager.html" title="interface in com.bigdata.rwstore">IAllocationManager</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>context</code> - The context to be released from all FixedAllocators.</dd></dl>
</li>
</ul>
<a name="getSlotSize(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSlotSize</h4>
<pre>public&nbsp;int&nbsp;getSlotSize(int&nbsp;data_len)</pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/io/writecache/IBufferedWriter.html#getSlotSize(int)">getSlotSize</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/io/writecache/IBufferedWriter.html" title="interface in com.bigdata.io.writecache">IBufferedWriter</a></code></dd>
</dl>
</li>
</ul>
<a name="getMaxAllocSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxAllocSize</h4>
<pre>public&nbsp;int&nbsp;getMaxAllocSize()</pre>
<div class="block">The maximum allocation size (bytes).</div>
</li>
</ul>
<a name="writeRootBlock(com.bigdata.journal.IRootBlockView, com.bigdata.journal.ForceEnum)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeRootBlock</h4>
<pre>public&nbsp;void&nbsp;writeRootBlock(<a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal">IRootBlockView</a>&nbsp;rootBlock,
                  <a href="../../../com/bigdata/journal/ForceEnum.html" title="enum in com.bigdata.journal">ForceEnum</a>&nbsp;forceOnCommit)</pre>
<div class="block">This can be called as part of the HA downstream replication.
 
 FIXME: If part of downstream replication then the current metabits
 held by the RWStore will not be in sync with that stored on disk.
 
 This will only be a problem if the RWStore needs to take over as
 leader and be able to allocate and write to the store.
 
 Note that the metabits are not needed in order to determine the
 physical address mapping of an rw-native address.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>rootBlock</code> - </dd><dd><code>forceOnCommit</code> - </dd></dl>
</li>
</ul>
<a name="readRootBlock(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readRootBlock</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;readRootBlock(boolean&nbsp;rootBlock0)</pre>
</li>
</ul>
<a name="getStoreCounters()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStoreCounters</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore">RWStore.StoreCounters</a>&lt;?&gt;&nbsp;getStoreCounters()</pre>
<div class="block">Returns the striped performance counters for the store.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/io/writecache/IBufferedWriter.html#getStoreCounters()">getStoreCounters</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/io/writecache/IBufferedWriter.html" title="interface in com.bigdata.io.writecache">IBufferedWriter</a></code></dd>
</dl>
</li>
</ul>
<a name="setStoreCounters(com.bigdata.rwstore.RWStore.StoreCounters)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setStoreCounters</h4>
<pre>public&nbsp;void&nbsp;setStoreCounters(<a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore">RWStore.StoreCounters</a>&lt;?&gt;&nbsp;storeCounters)</pre>
<div class="block">Replaces the <a href="../../../com/bigdata/rwstore/RWStore.StoreCounters.html" title="class in com.bigdata.rwstore"><code>RWStore.StoreCounters</code></a> object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>storeCounters</code> - The new <a href="../../../com/bigdata/btree/BTree.Counter.html" title="class in com.bigdata.btree"><code>BTree.Counter</code></a>s.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the argument is <code>null</code>.</dd></dl>
</li>
</ul>
<a name="getCounters()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCounters</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a>&nbsp;getCounters()</pre>
<div class="block">Return interesting information about the write cache and file operations.</div>
</li>
</ul>
<a name="writeRawBuffer(com.bigdata.ha.msg.IHAWriteMessage, com.bigdata.io.IBufferAccess)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeRawBuffer</h4>
<pre>public&nbsp;void&nbsp;writeRawBuffer(<a href="../../../com/bigdata/ha/msg/IHAWriteMessage.html" title="interface in com.bigdata.ha.msg">IHAWriteMessage</a>&nbsp;msg,
                  <a href="../../../com/bigdata/io/IBufferAccess.html" title="interface in com.bigdata.io">IBufferAccess</a>&nbsp;b)
                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                           <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="sendHALogBuffer(com.bigdata.ha.msg.IHALogRequest, com.bigdata.ha.msg.IHAWriteMessage, com.bigdata.io.IBufferAccess)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendHALogBuffer</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html?is-external=true" title="class or interface in java.util.concurrent">Future</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Void.html?is-external=true" title="class or interface in java.lang">Void</a>&gt;&nbsp;sendHALogBuffer(<a href="../../../com/bigdata/ha/msg/IHALogRequest.html" title="interface in com.bigdata.ha.msg">IHALogRequest</a>&nbsp;req,
                           <a href="../../../com/bigdata/ha/msg/IHAWriteMessage.html" title="interface in com.bigdata.ha.msg">IHAWriteMessage</a>&nbsp;msg,
                           <a href="../../../com/bigdata/io/IBufferAccess.html" title="interface in com.bigdata.io">IBufferAccess</a>&nbsp;buf)
                             throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                                    <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="sendRawBuffer(com.bigdata.ha.msg.IHARebuildRequest, long, long, long, long, int, java.nio.ByteBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendRawBuffer</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html?is-external=true" title="class or interface in java.util.concurrent">Future</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Void.html?is-external=true" title="class or interface in java.lang">Void</a>&gt;&nbsp;sendRawBuffer(<a href="../../../com/bigdata/ha/msg/IHARebuildRequest.html" title="interface in com.bigdata.ha.msg">IHARebuildRequest</a>&nbsp;req,
                         long&nbsp;sequence,
                         long&nbsp;quorumToken,
                         long&nbsp;fileExtent,
                         long&nbsp;offset,
                         int&nbsp;nbytes,
                         <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;b)
                           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                                  <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/journal/IHABufferStrategy.html#sendRawBuffer(com.bigdata.ha.msg.IHARebuildRequest,%20long,%20long,%20long,%20long,%20int,%20java.nio.ByteBuffer)"><code>IHABufferStrategy.sendRawBuffer(IHARebuildRequest, long,
      long, long, long, int, ByteBuffer)</code></a></dd></dl>
</li>
</ul>
<a name="writeOnStream(java.io.OutputStream, com.bigdata.journal.AbstractJournal.ISnapshotData, com.bigdata.quorum.Quorum, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeOnStream</h4>
<pre>public&nbsp;void&nbsp;writeOnStream(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;os,
                 <a href="../../../com/bigdata/journal/AbstractJournal.ISnapshotData.html" title="interface in com.bigdata.journal">AbstractJournal.ISnapshotData</a>&nbsp;snapshotData,
                 <a href="../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum">Quorum</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>,<a href="../../../com/bigdata/ha/QuorumService.html" title="interface in com.bigdata.ha">QuorumService</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>&gt;&gt;&nbsp;quorum,
                 long&nbsp;token)
                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                          <a href="../../../com/bigdata/quorum/QuorumException.html" title="class in com.bigdata.quorum">QuorumException</a>,
                          <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="../../../com/bigdata/quorum/QuorumException.html" title="class in com.bigdata.quorum">QuorumException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="writeOnStream2(java.io.OutputStream, java.util.Set, com.bigdata.quorum.Quorum, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeOnStream2</h4>
<pre>public&nbsp;void&nbsp;writeOnStream2(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;os,
                  <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util">Map.Entry</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,byte[]&gt;&gt;&nbsp;snapshotData,
                  <a href="../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum">Quorum</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>,<a href="../../../com/bigdata/ha/QuorumService.html" title="interface in com.bigdata.ha">QuorumService</a>&lt;<a href="../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha">HAGlue</a>&gt;&gt;&nbsp;quorum,
                  long&nbsp;token)
                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                           <a href="../../../com/bigdata/quorum/QuorumException.html" title="class in com.bigdata.quorum">QuorumException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="../../../com/bigdata/quorum/QuorumException.html" title="class in com.bigdata.quorum">QuorumException</a></code></dd></dl>
</li>
</ul>
<a name="readRaw(long, java.nio.ByteBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readRaw</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;readRaw(long&nbsp;offset,
                 <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;dst)</pre>
<div class="block">Read on the backing file. <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html?is-external=true#remaining()" title="class or interface in java.nio"><code>Buffer.remaining()</code></a> bytes will be
 read into the caller's buffer, starting at the specified offset in the
 backing file.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/io/writecache/IBackingReader.html#readRaw(long,%20java.nio.ByteBuffer)">readRaw</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/io/writecache/IBackingReader.html" title="interface in com.bigdata.io.writecache">IBackingReader</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>offset</code> - The offset of the first byte (relative to the start of the
            data region).</dd><dd><code>dst</code> - Where to put the data. Bytes will be written at position until
            limit.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The caller's buffer, prepared for reading.</dd></dl>
</li>
</ul>
<a name="getMaxBlobSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxBlobSize</h4>
<pre>public&nbsp;int&nbsp;getMaxBlobSize()</pre>
</li>
</ul>
<a name="getStorageStats()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStorageStats</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/StorageStats.html" title="class in com.bigdata.rwstore">StorageStats</a>&nbsp;getStorageStats()</pre>
</li>
</ul>
<a name="newTx()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newTx</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/IRawTx.html" title="interface in com.bigdata.rwstore">IRawTx</a>&nbsp;newTx()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#newTx()">IHistoryManager</a></code></strong></div>
<div class="block">A hook used to support session protection by incrementing and
 decrementing a transaction counter within the <a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore"><code>IStore</code></a>. As long as
 a transaction is active we can not release data which is currently marked
 as freed but was committed at the point the session started.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#newTx()">newTx</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html" title="interface in com.bigdata.rwstore">IHistoryManager</a></code></dd>
</dl>
</li>
</ul>
<a name="getActiveTxCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getActiveTxCount</h4>
<pre>public&nbsp;int&nbsp;getActiveTxCount()</pre>
<div class="block">Debug ONLY method added to permit unit tests to be written that the
 native transaction counter is correctly decremented to zero. The returned
 value is ONLY valid while holding the <a href="../../../com/bigdata/rwstore/RWStore.html#m_allocationLock"><code>m_allocationLock</code></a>.
 Therefore this method MAY NOT be used reliably outside of code that can
 guarantee that there are no concurrent committers on the <a href="../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a>.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="http://trac.blazegraph.com/ticket/1036"> Journal file growth
      reported with 1.3.3 </a></dd></dl>
</li>
</ul>
<a name="getAssociatedSlotSize(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAssociatedSlotSize</h4>
<pre>public&nbsp;int&nbsp;getAssociatedSlotSize(int&nbsp;addr)</pre>
<div class="block">Returns the slot size associated with this address</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IStore.html#getAssociatedSlotSize(int)">getAssociatedSlotSize</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IStore.html" title="interface in com.bigdata.rwstore">IStore</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - - the address</dd>
<dt><span class="strong">Returns:</span></dt><dd>the size of the slot associated</dd></dl>
</li>
</ul>
<a name="lockAddress(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockAddress</h4>
<pre>public&nbsp;void&nbsp;lockAddress(int&nbsp;addr)</pre>
<div class="block">lockAddress adds the address passed to a lock list.  This is for
 debug only and is not intended to be used generally for the live system.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - - address to be locked</dd></dl>
</li>
</ul>
<a name="showWriteCacheDebug(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showWriteCacheDebug</h4>
<pre>public&nbsp;void&nbsp;showWriteCacheDebug(long&nbsp;paddr)</pre>
</li>
</ul>
<a name="getWriteCacheCounters()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWriteCacheCounters</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/counters/CounterSet.html" title="class in com.bigdata.counters">CounterSet</a>&nbsp;getWriteCacheCounters()</pre>
</li>
</ul>
<a name="getLastReleaseTime()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastReleaseTime</h4>
<pre>public&nbsp;long&nbsp;getLastReleaseTime()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#getLastReleaseTime()">IHistoryManager</a></code></strong></div>
<div class="block">If history is retained this returns the time for which data was most
 recently released. No request can be made for data earlier than this.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#getLastReleaseTime()">getLastReleaseTime</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html" title="interface in com.bigdata.rwstore">IHistoryManager</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>latest data release time</dd></dl>
</li>
</ul>
<a name="registerExternalCache(com.bigdata.cache.ConcurrentWeakValueCache, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerExternalCache</h4>
<pre>public&nbsp;void&nbsp;registerExternalCache(<a href="../../../com/bigdata/cache/ConcurrentWeakValueCache.html" title="class in com.bigdata.cache">ConcurrentWeakValueCache</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../com/bigdata/journal/ICommitter.html" title="interface in com.bigdata.journal">ICommitter</a>&gt;&nbsp;externalCache,
                         int&nbsp;dataSize)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#registerExternalCache(com.bigdata.cache.ConcurrentWeakValueCache,%20int)">IHistoryManager</a></code></strong></div>
<div class="block">Call made from AbstractJournal to register the cache used. This can then
 be accessed to clear entries when storage is made available for
 re-cycling.
 <p>
 Note: It is not safe to clear at the point of the delete request since
 the data could still be loaded if the data is retained for a period due
 to a non-zero retention period or session protection.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IHistoryManager.html#registerExternalCache(com.bigdata.cache.ConcurrentWeakValueCache,%20int)">registerExternalCache</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IHistoryManager.html" title="interface in com.bigdata.rwstore">IHistoryManager</a></code></dd>
</dl>
</li>
</ul>
<a name="isCommitted(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isCommitted</h4>
<pre>public&nbsp;boolean&nbsp;isCommitted(int&nbsp;rwaddr)</pre>
<div class="block">Return <code>true</code> iff the allocation having that address is
 flagged as committed. The caller must be holding the allocation lock in
 order for the result to remain valid outside of the method call.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - The address.</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> iff the address is currently committed.</dd></dl>
</li>
</ul>
<a name="inWriteCache(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>inWriteCache</h4>
<pre>public&nbsp;boolean&nbsp;inWriteCache(int&nbsp;rwaddr)</pre>
</li>
</ul>
<a name="getInputStream(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInputStream</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io">InputStream</a>&nbsp;getInputStream(long&nbsp;addr)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rawstore/IStreamStore.html#getInputStream(long)">IStreamStore</a></code></strong></div>
<div class="block">Return an input stream from which a previously written stream may be read
 back.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rawstore/IStreamStore.html#getInputStream(long)">getInputStream</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rawstore/IStreamStore.html" title="interface in com.bigdata.rawstore">IStreamStore</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - The address at which the stream was written.</dd>
<dt><span class="strong">Returns:</span></dt><dd>an input stream for the data for provided address</dd></dl>
</li>
</ul>
<a name="getOutputStream()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOutputStream</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rawstore/IPSOutputStream.html" title="class in com.bigdata.rawstore">IPSOutputStream</a>&nbsp;getOutputStream()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rawstore/IStreamStore.html#getOutputStream()">IStreamStore</a></code></strong></div>
<div class="block">Return an output stream which can be used to write on the backing store.
 You can recover the address used to read back the data from the
 <a href="../../../com/bigdata/rawstore/IPSOutputStream.html" title="class in com.bigdata.rawstore"><code>IPSOutputStream</code></a>.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rawstore/IStreamStore.html#getOutputStream()">getOutputStream</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rawstore/IStreamStore.html" title="interface in com.bigdata.rawstore">IStreamStore</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>The output stream.</dd></dl>
</li>
</ul>
<a name="getOutputStream(com.bigdata.rawstore.IAllocationContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOutputStream</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rawstore/IPSOutputStream.html" title="class in com.bigdata.rawstore">IPSOutputStream</a>&nbsp;getOutputStream(<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;context)</pre>
</li>
</ul>
<a name="resetFromHARootBlock(com.bigdata.journal.IRootBlockView)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetFromHARootBlock</h4>
<pre>public&nbsp;void&nbsp;resetFromHARootBlock(<a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal">IRootBlockView</a>&nbsp;rootBlock)</pre>
<div class="block">Low level routine used when we replace the root blocks of an empty
 journal in HA with those from the leader.
 <p>
 Note: This method is only invoked in contexts where there should not be
 concurrent access to the journal. This we should not need to worry about
 concurrent readers during <a href="../../../com/bigdata/rwstore/RWStore.html#resetFromHARootBlock(com.bigdata.journal.IRootBlockView)"><code>resetFromHARootBlock(IRootBlockView)</code></a>.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/rwstore/RWStore.html#postHACommit(com.bigdata.journal.IRootBlockView)"><code>postHACommit(IRootBlockView)</code></a></dd></dl>
</li>
</ul>
<a name="postHACommit(com.bigdata.journal.IRootBlockView)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>postHACommit</h4>
<pre>public&nbsp;void&nbsp;postHACommit(<a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal">IRootBlockView</a>&nbsp;rbv)</pre>
<div class="block">Called from <a href="../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal"><code>AbstractJournal</code></a> commit2Phase to ensure that a
 downstream HA quorum member ensures it is able to read committed data
 that has been streamed directly to the backing store.
 <p>
 The data stream will have included metabits and modified
 <a href="../../../com/bigdata/rwstore/FixedAllocator.html" title="class in com.bigdata.rwstore"><code>FixedAllocator</code></a>s so these must be reset using the metabitsAddr
 data in the root block.
 <p>
 Note: Reads on the <a href="../../../com/bigdata/rwstore/RWStore.html" title="class in com.bigdata.rwstore"><code>RWStore</code></a> MUST block during this method since
 some allocators may be replaced as part of the post-commit protocol.
 <p>
 Ticket #778 was for a problem when a follower takes over as leader and
 was not correctly synchronised.  This was traced, eventually, to a problem
 in calculating the diskAddr metabit for the modified Allocator.  The problem
 was demonstrated by a temporary method to reserve metaAllocations by extending and
 setting the m_transient bits.  But that has to be done within the commit() method
 before it attempts to save all the dirty allocators.  If we need to contrive a similar
 scenario in the future a better approach would be a special debug property on the 
 RWStore that indicates a "TRANSIENT_RESERVE" or something similar.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>rbv</code> - The new <a href="../../../com/bigdata/journal/IRootBlockView.html" title="interface in com.bigdata.journal"><code>IRootBlockView</code></a>.</dd></dl>
</li>
</ul>
<a name="checkDeleteBlocks(com.bigdata.journal.AbstractJournal)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkDeleteBlocks</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rwstore/RWStore.DeleteBlockStats.html" title="class in com.bigdata.rwstore">RWStore.DeleteBlockStats</a>&nbsp;checkDeleteBlocks(<a href="../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal">AbstractJournal</a>&nbsp;journal)</pre>
<div class="block">Utility to check the deleteBlocks associated with each active CommitRecord</div>
</li>
</ul>
<a name="readFromLatchedAddress(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readFromLatchedAddress</h4>
<pre>public final&nbsp;byte[]&nbsp;readFromLatchedAddress(int&nbsp;nxtAddr)
                                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">A low level utility method that reads directly from the backing
 <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html?is-external=true" title="class or interface in java.nio.channels"><code>FileChannel</code></a>.
 <p>
 Note: The latched address does not encode the actual length of the data.
 Therefore, all data in the slot addressed by the latched address will be
 returned.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>nxtAddr</code> - The latched address.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The byte[] in the addressed slot.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="getBlockSequence()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBlockSequence</h4>
<pre>public&nbsp;long&nbsp;getBlockSequence()</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/journal/IHABufferStrategy.html#getBlockSequence()"><code>IHABufferStrategy.getBlockSequence()</code></a></dd></dl>
</li>
</ul>
<a name="getCurrentBlockSequence()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCurrentBlockSequence</h4>
<pre>public&nbsp;long&nbsp;getCurrentBlockSequence()</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/journal/IHABufferStrategy.html#getCurrentBlockSequence()"><code>IHABufferStrategy.getCurrentBlockSequence()</code></a></dd></dl>
</li>
</ul>
<a name="computeDigest(java.lang.Object, java.security.MessageDigest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeDigest</h4>
<pre>public&nbsp;void&nbsp;computeDigest(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;snapshot,
                 <a href="http://docs.oracle.com/javase/7/docs/api/java/security/MessageDigest.html?is-external=true" title="class or interface in java.security">MessageDigest</a>&nbsp;digest)
                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/security/DigestException.html?is-external=true" title="class or interface in java.security">DigestException</a>,
                          <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/DigestException.html?is-external=true" title="class or interface in java.security">DigestException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/bigdata/journal/IHABufferStrategy.html#computeDigest(java.lang.Object,%20java.security.MessageDigest)"><code>IHABufferStrategy.computeDigest(Object, MessageDigest)</code></a></dd></dl>
</li>
</ul>
<a name="writeRaw(long, java.nio.ByteBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeRaw</h4>
<pre>public&nbsp;void&nbsp;writeRaw(long&nbsp;offset,
            <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;transfer)
              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Used as part of the rebuild protocol</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="verifyAllocatedAddress(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyAllocatedAddress</h4>
<pre>public&nbsp;boolean&nbsp;verifyAllocatedAddress(long&nbsp;addr)</pre>
<div class="block">Can be used to determine if an address is within an allocated slot.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>addr</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>whether addr is within slot allocated area</dd></dl>
</li>
</ul>
<a name="getStoreState()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStoreState</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/journal/StoreState.html" title="interface in com.bigdata.journal">StoreState</a>&nbsp;getStoreState()</pre>
</li>
</ul>
<a name="ensureMetabitsDemispace(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureMetabitsDemispace</h4>
<pre>public&nbsp;boolean&nbsp;ensureMetabitsDemispace(boolean&nbsp;useDemispace)</pre>
<div class="block">Forces a reset of the metabits allocation on the next commit.
 <p>
 Note that a side-effect of this is that there will be a memory leak
 of either a FixedAllocation slot or an existing demi-space.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>useDemispace</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>whether the storage has been modified.</dd></dl>
</li>
</ul>
<a name="isUsingDemiSpace()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isUsingDemiSpace</h4>
<pre>public&nbsp;boolean&nbsp;isUsingDemiSpace()</pre>
</li>
</ul>
<a name="snapshotMetabits(com.bigdata.journal.AbstractJournal.ISnapshotData)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>snapshotMetabits</h4>
<pre>public&nbsp;void&nbsp;snapshotMetabits(<a href="../../../com/bigdata/journal/AbstractJournal.ISnapshotData.html" title="interface in com.bigdata.journal">AbstractJournal.ISnapshotData</a>&nbsp;tm)
                      throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Add the address/byte[] to the snapshot representing the metabits allocaiton data</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="snapshotAllocators(com.bigdata.journal.AbstractJournal.ISnapshotData)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>snapshotAllocators</h4>
<pre>public&nbsp;void&nbsp;snapshotAllocators(<a href="../../../com/bigdata/journal/AbstractJournal.ISnapshotData.html" title="interface in com.bigdata.journal">AbstractJournal.ISnapshotData</a>&nbsp;tm)</pre>
<div class="block">Add the address/allocator associated with each FixedAllocator to the snapshot map</div>
</li>
</ul>
<a name="newAllocationContext(boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>newAllocationContext</h4>
<pre>public&nbsp;<a href="../../../com/bigdata/rawstore/IAllocationContext.html" title="interface in com.bigdata.rawstore">IAllocationContext</a>&nbsp;newAllocationContext(boolean&nbsp;isolated)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../com/bigdata/rwstore/IAllocationManager.html#newAllocationContext(boolean)">IAllocationManager</a></code></strong></div>
<div class="block">Creates a context to be used to isolate updates to within the context until it
 is released to the parent environment.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../com/bigdata/rwstore/IAllocationManager.html#newAllocationContext(boolean)">newAllocationContext</a></code>&nbsp;in interface&nbsp;<code><a href="../../../com/bigdata/rwstore/IAllocationManager.html" title="interface in com.bigdata.rwstore">IAllocationManager</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>a new IAlocationContext</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/RWStore.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/rwstore/PSOutputStream.html" title="class in com.bigdata.rwstore"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/bigdata/rwstore/RWStore.AllocationStats.html" title="class in com.bigdata.rwstore"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/rwstore/RWStore.html" target="_top">Frames</a></li>
<li><a href="RWStore.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
