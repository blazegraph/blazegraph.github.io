<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Mon Aug 29 21:19:21 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AbstractLBSPolicy (Blazegraph Database Platform 2.1.4 API)</title>
<meta name="date" content="2016-08-29">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AbstractLBSPolicy (Blazegraph Database Platform 2.1.4 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractLBSPolicy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractHostMetrics.html" title="class in com.bigdata.rdf.sail.webapp.lbs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.InitParams.html" title="interface in com.bigdata.rdf.sail.webapp.lbs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html" target="_top">Frames</a></li>
<li><a href="AbstractLBSPolicy.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.rdf.sail.webapp.lbs</div>
<h2 title="Class AbstractLBSPolicy" class="title">Class AbstractLBSPolicy</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.rdf.sail.webapp.lbs.AbstractLBSPolicy</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../../com/bigdata/quorum/QuorumListener.html" title="interface in com.bigdata.quorum">QuorumListener</a>, <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHALoadBalancerPolicy</a>, <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHAPolicyLifeCycle</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</a></dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractHostLBSPolicy.html" title="class in com.bigdata.rdf.sail.webapp.lbs">AbstractHostLBSPolicy</a>, <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/policy/NOPLBSPolicy.html" title="class in com.bigdata.rdf.sail.webapp.lbs.policy">NOPLBSPolicy</a>, <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/policy/RoundRobinLBSPolicy.html" title="class in com.bigdata.rdf.sail.webapp.lbs.policy">RoundRobinLBSPolicy</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">AbstractLBSPolicy</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHALoadBalancerPolicy</a>, <a href="../../../../../../com/bigdata/quorum/QuorumListener.html" title="interface in com.bigdata.quorum">QuorumListener</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</a></pre>
<div class="block">Abstract base class establishes a listener for quorum events, tracks the
 services that are members of the quorum, and caches metadata about those
 services (especially the requestURL at which they will respond).</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../serialized-form.html#com.bigdata.rdf.sail.webapp.lbs.AbstractLBSPolicy">Serialized Form</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.InitParams.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">AbstractLBSPolicy.InitParams</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref">WeakReference</a>&lt;<a href="../../../../../../com/bigdata/ha/IHAJournal.html" title="interface in com.bigdata.ha">IHAJournal</a>&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#journalRef">journalRef</a></strong></code>
<div class="block">A <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref"><code>WeakReference</code></a> to the <code>HAJournal</code> avoids pinning the
 <code>HAJournal</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#serviceIDRef">serviceIDRef</a></strong></code>
<div class="block">The <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a> of the HAJournalServer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs">ServiceScore</a>[]&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#serviceTableRef">serviceTableRef</a></strong></code>
<div class="block">This is the table of known services.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#AbstractLBSPolicy()">AbstractLBSPolicy</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#conditionallyForwardReadRequest(com.bigdata.rdf.sail.webapp.HALoadBalancerServlet,%20javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse)">conditionallyForwardReadRequest</a></strong>(<a href="../../../../../../com/bigdata/rdf/sail/webapp/HALoadBalancerServlet.html" title="class in com.bigdata.rdf.sail.webapp">HALoadBalancerServlet</a>&nbsp;servlet,
                               javax.servlet.http.HttpServletRequest&nbsp;request,
                               javax.servlet.http.HttpServletResponse&nbsp;response)</code>
<div class="block">Hook provides the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs"><code>IHALoadBalancerPolicy</code></a> with an opportunity to
 forward a read-request to the local service rather than proxying the
 request to a service selected by the load balancer (a local forward has
 less overhead than proxying to either the local host or a remote service,
 which makes it more efficient under some circumstances to handle the
 read-request on the service where it was originally received).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#conditionallyUpdateServiceTable()">conditionallyUpdateServiceTable</a></strong>()</code>
<div class="block">Conditionally update the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#serviceTableRef"><code>serviceTableRef</code></a> iff it does not exist or
 is empty.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#destroy()">destroy</a></strong>()</code>
<div class="block">Destroy the policy (stop any asynchronous processing, release any
 resources).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../../com/bigdata/ha/IHAJournal.html" title="interface in com.bigdata.ha">IHAJournal</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#getJournal()">getJournal</a></strong>()</code>
<div class="block">Return the cached reference to the <code>HAJournal</code>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#getLeaderURI(javax.servlet.http.HttpServletRequest)">getLeaderURI</a></strong>(javax.servlet.http.HttpServletRequest&nbsp;request)</code>
<div class="block">Return the Request-URI to which a non-idempotent request will be proxied.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs">ServiceScore</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#getLocalServiceScore()">getLocalServiceScore</a></strong>()</code>
<div class="block">Return the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs"><code>ServiceScore</code></a> for the <a href="../../../../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha"><code>HAGlue</code></a> service running on
 this host within this webapp.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs">ServiceScore</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#getServiceScoreForHostname(java.lang.String)">getServiceScoreForHostname</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;hostname)</code>
<div class="block">Return the first service found for the indicated host.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#init(javax.servlet.ServletConfig,%20com.bigdata.journal.IIndexManager)">init</a></strong>(javax.servlet.ServletConfig&nbsp;servletConfig,
    <a href="../../../../../../com/bigdata/journal/IIndexManager.html" title="interface in com.bigdata.journal">IIndexManager</a>&nbsp;indexManager)</code>
<div class="block">Initialize the policy.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#notify(com.bigdata.quorum.QuorumEvent)">notify</a></strong>(<a href="../../../../../../com/bigdata/quorum/QuorumEvent.html" title="interface in com.bigdata.quorum">QuorumEvent</a>&nbsp;e)</code>
<div class="block">Notify the client of a quorum event.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#service(boolean,%20com.bigdata.rdf.sail.webapp.HALoadBalancerServlet,%20javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse)">service</a></strong>(boolean&nbsp;isLeaderRequest,
       <a href="../../../../../../com/bigdata/rdf/sail/webapp/HALoadBalancerServlet.html" title="class in com.bigdata.rdf.sail.webapp">HALoadBalancerServlet</a>&nbsp;servlet,
       javax.servlet.http.HttpServletRequest&nbsp;request,
       javax.servlet.http.HttpServletResponse&nbsp;response)</code>
<div class="block">Invoked for each request.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#toString()">toString</a></strong>()</code>
<div class="block">Note: implementation is non-blocking!</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#toString(java.lang.StringBuilder)">toString</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html?is-external=true" title="class or interface in java.lang">StringBuilder</a>&nbsp;sb)</code>
<div class="block">Extension hook for <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#toString()"><code>toString()</code></a> - implementation MUST NOT block.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#updateServiceTable()">updateServiceTable</a></strong>()</code>
<div class="block">Update the per-service table.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.bigdata.rdf.sail.webapp.lbs.IHALoadBalancerPolicy">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;com.bigdata.rdf.sail.webapp.lbs.<a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHALoadBalancerPolicy</a></h3>
<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html#getReaderURI(javax.servlet.http.HttpServletRequest)">getReaderURI</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="journalRef">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>journalRef</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref">WeakReference</a>&lt;<a href="../../../../../../com/bigdata/ha/IHAJournal.html" title="interface in com.bigdata.ha">IHAJournal</a>&gt;&gt; journalRef</pre>
<div class="block">A <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref"><code>WeakReference</code></a> to the <code>HAJournal</code> avoids pinning the
 <code>HAJournal</code>.</div>
</li>
</ul>
<a name="serviceIDRef">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceIDRef</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>&gt; serviceIDRef</pre>
<div class="block">The <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a> of the HAJournalServer.</div>
</li>
</ul>
<a name="serviceTableRef">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>serviceTableRef</h4>
<pre>protected final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs">ServiceScore</a>[]&gt; serviceTableRef</pre>
<div class="block">This is the table of known services. We can scan the table for a service
 <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a> and then forward a request to the pre-computed requestURL
 associated with that <a href="http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a>. If the requestURL is <code>null</code>
 then we do not know how to reach that service and can not proxy the
 request.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="AbstractLBSPolicy()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AbstractLBSPolicy</h4>
<pre>public&nbsp;AbstractLBSPolicy()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;toString()</pre>
<div class="block">Note: implementation is non-blocking!</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
<a name="toString(java.lang.StringBuilder)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>protected&nbsp;void&nbsp;toString(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html?is-external=true" title="class or interface in java.lang">StringBuilder</a>&nbsp;sb)</pre>
<div class="block">Extension hook for <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#toString()"><code>toString()</code></a> - implementation MUST NOT block.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sb</code> - Buffer where you can write additional state.</dd></dl>
</li>
</ul>
<a name="getJournal()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getJournal</h4>
<pre>protected&nbsp;<a href="../../../../../../com/bigdata/ha/IHAJournal.html" title="interface in com.bigdata.ha">IHAJournal</a>&nbsp;getJournal()</pre>
<div class="block">Return the cached reference to the <code>HAJournal</code>.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The reference or <code>null</code> iff the reference has been
         cleared or has not yet been set.</dd></dl>
</li>
</ul>
<a name="destroy()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>destroy</h4>
<pre>public&nbsp;void&nbsp;destroy()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html#destroy()">IHAPolicyLifeCycle</a></code></strong></div>
<div class="block">Destroy the policy (stop any asynchronous processing, release any
 resources).</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html#destroy()">destroy</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHAPolicyLifeCycle</a></code></dd>
</dl>
</li>
</ul>
<a name="init(javax.servlet.ServletConfig, com.bigdata.journal.IIndexManager)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>public&nbsp;void&nbsp;init(javax.servlet.ServletConfig&nbsp;servletConfig,
        <a href="../../../../../../com/bigdata/journal/IIndexManager.html" title="interface in com.bigdata.journal">IIndexManager</a>&nbsp;indexManager)
          throws javax.servlet.ServletException</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html#init(javax.servlet.ServletConfig,%20com.bigdata.journal.IIndexManager)">IHAPolicyLifeCycle</a></code></strong></div>
<div class="block">Initialize the policy.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html#init(javax.servlet.ServletConfig,%20com.bigdata.journal.IIndexManager)">init</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHAPolicyLifeCycle.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHAPolicyLifeCycle</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.servlet.ServletException</code></dd></dl>
</li>
</ul>
<a name="service(boolean, com.bigdata.rdf.sail.webapp.HALoadBalancerServlet, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>service</h4>
<pre>public&nbsp;boolean&nbsp;service(boolean&nbsp;isLeaderRequest,
              <a href="../../../../../../com/bigdata/rdf/sail/webapp/HALoadBalancerServlet.html" title="class in com.bigdata.rdf.sail.webapp">HALoadBalancerServlet</a>&nbsp;servlet,
              javax.servlet.http.HttpServletRequest&nbsp;request,
              javax.servlet.http.HttpServletResponse&nbsp;response)
                throws javax.servlet.ServletException,
                       <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html#service(boolean,%20com.bigdata.rdf.sail.webapp.HALoadBalancerServlet,%20javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse)">IHALoadBalancerPolicy</a></code></strong></div>
<div class="block">Invoked for each request. If the response is not committed, then it will
 be handled by the <a href="../../../../../../com/bigdata/rdf/sail/webapp/HALoadBalancerServlet.html" title="class in com.bigdata.rdf.sail.webapp"><code>HALoadBalancerServlet</code></a>.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html#service(boolean,%20com.bigdata.rdf.sail.webapp.HALoadBalancerServlet,%20javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse)">service</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHALoadBalancerPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>isLeaderRequest</code> - <code>true</code> iff this request must be directed to the
            leaeder and <code>false</code> iff this request may be load
            balanced over the joined services. UPDATEs MUST be handled by
            the leader. Read requests can be handled by any service that
            is joined with the met quorum.</dd><dd><code>servlet</code> - The <a href="../../../../../../com/bigdata/rdf/sail/webapp/HALoadBalancerServlet.html" title="class in com.bigdata.rdf.sail.webapp"><code>HALoadBalancerServlet</code></a>. This is exposed in order to
            allow the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs"><code>IHALoadBalancerPolicy</code></a> to perform a local
            forward of the request.</dd><dd><code>request</code> - The request.</dd><dd><code>response</code> - The response.</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> iff the request was handled.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.servlet.ServletException</code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="conditionallyForwardReadRequest(com.bigdata.rdf.sail.webapp.HALoadBalancerServlet, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>conditionallyForwardReadRequest</h4>
<pre>protected&nbsp;boolean&nbsp;conditionallyForwardReadRequest(<a href="../../../../../../com/bigdata/rdf/sail/webapp/HALoadBalancerServlet.html" title="class in com.bigdata.rdf.sail.webapp">HALoadBalancerServlet</a>&nbsp;servlet,
                                      javax.servlet.http.HttpServletRequest&nbsp;request,
                                      javax.servlet.http.HttpServletResponse&nbsp;response)
                                           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Hook provides the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs"><code>IHALoadBalancerPolicy</code></a> with an opportunity to
 forward a read-request to the local service rather than proxying the
 request to a service selected by the load balancer (a local forward has
 less overhead than proxying to either the local host or a remote service,
 which makes it more efficient under some circumstances to handle the
 read-request on the service where it was originally received).</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="getLeaderURI(javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLeaderURI</h4>
<pre>public final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getLeaderURI(javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block">Return the Request-URI to which a non-idempotent request will be proxied.
 <p>
 This implementation rewrites the requestURL such that the request will be
 proxied to the quorum leader.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html#getLeaderURI(javax.servlet.http.HttpServletRequest)">getLeaderURI</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/IHALoadBalancerPolicy.html" title="interface in com.bigdata.rdf.sail.webapp.lbs">IHALoadBalancerPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>request</code> - The request.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The proxyTo Request-URI -or- <code>null</code> if we could not
         find a service to which we could proxy this request.</dd></dl>
</li>
</ul>
<a name="getLocalServiceScore()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLocalServiceScore</h4>
<pre>protected&nbsp;<a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs">ServiceScore</a>&nbsp;getLocalServiceScore()</pre>
<div class="block">Return the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs"><code>ServiceScore</code></a> for the <a href="../../../../../../com/bigdata/ha/HAGlue.html" title="interface in com.bigdata.ha"><code>HAGlue</code></a> service running on
 this host within this webapp.</div>
</li>
</ul>
<a name="getServiceScoreForHostname(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getServiceScoreForHostname</h4>
<pre>protected&nbsp;<a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/ServiceScore.html" title="class in com.bigdata.rdf.sail.webapp.lbs">ServiceScore</a>&nbsp;getServiceScoreForHostname(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;hostname)</pre>
<div class="block">Return the first service found for the indicated host.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>hostname</code> - The hostname.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The first service for that host.</dd></dl>
</li>
</ul>
<a name="notify(com.bigdata.quorum.QuorumEvent)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>notify</h4>
<pre>public&nbsp;void&nbsp;notify(<a href="../../../../../../com/bigdata/quorum/QuorumEvent.html" title="interface in com.bigdata.quorum">QuorumEvent</a>&nbsp;e)</pre>
<div class="block">Notify the client of a quorum event.
 <p>
 The listener MUST NOT take any event that could block. In particular, it
 MUST NOT wait on another thread that will access the <a href="../../../../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum"><code>Quorum</code></a> as
 that will cause a deadlock around the internal lock maintained by the
 <a href="../../../../../../com/bigdata/quorum/Quorum.html" title="interface in com.bigdata.quorum"><code>Quorum</code></a>.
 <p>
 The services table is updated if a services joins or leaves the quorum.
 
 FIXME The <a href="../../../../../../com/bigdata/quorum/QuorumListener.html" title="interface in com.bigdata.quorum"><code>QuorumListener</code></a> is unregistered by
 <a href="../../../../../../com/bigdata/quorum/AbstractQuorum.html#terminate()"><code>AbstractQuorum.terminate()</code></a>. This happens any time the
  HAJournalServer goes into the error state. When this occurs, we
 stop getting <a href="../../../../../../com/bigdata/quorum/QuorumEvent.html" title="interface in com.bigdata.quorum"><code>QuorumEvent</code></a>s and the policy stops being responsive
 (it can not proxy the request to a service that is still up because it
 does not know what services are up, or maybe it just can not learn if
 services go down).
 <p>
 We probably need to either NOT clear the quorum listener and/or add an
 event type that is sent when <a href="../../../../../../com/bigdata/quorum/Quorum.html#terminate()"><code>Quorum.terminate()</code></a> is called and/or
 use our own listener (independent of the HAJournalServer, which would
 require us to use an HAClient).
 <p>
 This should be robust even when the HAQuorumService is not running. We do
 not want to be unable to proxy to another service just because this one
 is going through an error state. Would it make more sense to have a 2nd
 Quorum object for this purpose - one that is not started and stopped by
 the HAJournalServer?</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../com/bigdata/quorum/QuorumListener.html#notify(com.bigdata.quorum.QuorumEvent)">notify</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/bigdata/quorum/QuorumListener.html" title="interface in com.bigdata.quorum">QuorumListener</a></code></dd>
<dt><span class="strong">See Also:</span></dt><dd><code>(HAJournal start() delay)</code></dd></dl>
</li>
</ul>
<a name="conditionallyUpdateServiceTable()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>conditionallyUpdateServiceTable</h4>
<pre>protected&nbsp;void&nbsp;conditionallyUpdateServiceTable()</pre>
<div class="block">Conditionally update the <a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#serviceTableRef"><code>serviceTableRef</code></a> iff it does not exist or
 is empty.</div>
</li>
</ul>
<a name="updateServiceTable()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>updateServiceTable</h4>
<pre>protected&nbsp;void&nbsp;updateServiceTable()</pre>
<div class="block">Update the per-service table.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html#serviceTableRef"><code>serviceTableRef</code></a></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractLBSPolicy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractHostMetrics.html" title="class in com.bigdata.rdf.sail.webapp.lbs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.InitParams.html" title="interface in com.bigdata.rdf.sail.webapp.lbs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?com/bigdata/rdf/sail/webapp/lbs/AbstractLBSPolicy.html" target="_top">Frames</a></li>
<li><a href="AbstractLBSPolicy.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
