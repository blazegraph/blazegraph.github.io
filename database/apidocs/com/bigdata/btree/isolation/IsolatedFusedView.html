<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Mon Mar 18 18:55:27 UTC 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>IsolatedFusedView (Blazegraph Database Platform 2.1.5 API)</title>
<meta name="date" content="2019-03-18">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="IsolatedFusedView (Blazegraph Database Platform 2.1.5 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/IsolatedFusedView.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/bigdata/btree/isolation/IConflictResolver.html" title="interface in com.bigdata.btree.isolation"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../com/bigdata/btree/isolation/NoConflictResolver.html" title="class in com.bigdata.btree.isolation"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/bigdata/btree/isolation/IsolatedFusedView.html" target="_top">Frames</a></li>
<li><a href="IsolatedFusedView.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_classes_inherited_from_class_com.bigdata.btree.view.FusedView">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_com.bigdata.btree.view.FusedView">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.bigdata.btree.isolation</div>
<h2 title="Class IsolatedFusedView" class="title">Class IsolatedFusedView</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">com.bigdata.btree.view.FusedView</a></li>
<li>
<ul class="inheritance">
<li>com.bigdata.btree.isolation.IsolatedFusedView</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../com/bigdata/btree/IAutoboxBTree.html" title="interface in com.bigdata.btree">IAutoboxBTree</a>, <a href="../../../../com/bigdata/btree/IIndex.html" title="interface in com.bigdata.btree">IIndex</a>, <a href="../../../../com/bigdata/btree/IIndexLocalCounter.html" title="interface in com.bigdata.btree">IIndexLocalCounter</a>, <a href="../../../../com/bigdata/btree/ILocalBTreeView.html" title="interface in com.bigdata.btree">ILocalBTreeView</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html" title="interface in com.bigdata.btree">IRangeQuery</a>, <a href="../../../../com/bigdata/btree/ISimpleBTree.html" title="interface in com.bigdata.btree">ISimpleBTree</a>, <a href="../../../../com/bigdata/counters/ICounterSetAccess.html" title="interface in com.bigdata.counters">ICounterSetAccess</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">IsolatedFusedView</span>
extends <a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></pre>
<div class="block"><p>
 An index (or index partition) that has been isolated by a transaction.
 Isolation is achieved by the following mechanisms:
 <ol>
 <li>The writeSet of the transaction on the index is isolated on a
 <a href="../../../../com/bigdata/btree/BTree.html" title="class in com.bigdata.btree"><code>BTree</code></a> visible only to that transaction.</li>
 <li>Version timestamps are maintained for index entries in both the isolated
 write set and groundState from which the transaction is reading.</li>
 <li>The groundState is defined as the view of the index (partition) as of the
 abs(startTime) of the transaction.</li>
 <li>Reads are performed against an ordered view defined by the writeSet
 followed by the ordered set of indices defining the groundState of the index.
 </li>
 <li>Writes first read through the ordered view to locate the most recent
 version for an index entry. If the index entry is located in the isolated
 writeSet then it is overwritten and its timestamp is unchanged. If the index
 entry is located in the groundState then the timestamp is copied from that
 index entry and written on the new version in the isolated writeSet.</li>
 <li>During validation, version timestamps in the isolated writeSet are
 compared against the then current view of the corresponding unisolated index.
 If the timestamp in the unisolated view differs from that in the writeSet
 then there is a write-write conflict. Write-write conflicts MAY be validated
 if the index has a registered <a href="../../../../com/bigdata/btree/isolation/IConflictResolver.html" title="interface in com.bigdata.btree.isolation"><code>IConflictResolver</code></a>.</li>
 <li>If the writeSet is validated then it is mergedDown (copied onto) the then
 current unisolated index view. During the mergeDown phase the revision
 timestamp of the transaction is applied to all index entries copied from the
 write set. Transactions that later try to commit will recognize write-write
 conflicts based on those updated timestamps. Note that revision timestamps
 ARE NOT commit timestamps. Revision timestamps are assigned at the start of
 the validation phase. All tuples modified by a transaction are annotated with
 the same revision timestamp during the validation phase of the transaction.
 Write-write conflicts are detected on the basis of the per-tuple revision
 timestamps. Commit timestamps are assigned once the write set has been
 validated and checkpointed and all shards participating in the commit
 protocol signal that they are prepared and ready to commit.</li>
 </ol>
 </p>
 <p>
 Note: The timestamp from which the post-commit state of the transaction may
 be read IS NOT defined for an <a href="../../../../com/bigdata/service/IBigdataFederation.html" title="interface in com.bigdata.service"><code>IBigdataFederation</code></a>. It is not possible
 to define this timestamp without requiring concurrent commit processing to be
 paused on all data services on which the transaction has written, which is
 viewed as too high a cost. Instead, the commit timestamp is the state from
 which you can read the data written by the transaction. Reads on tuples NOT
 updated by the transaction MAY have been changed by concurrent transactions.
 </p>
 Note: The process of validating, merging down changes, and committing those
 changes MUST be atomic. Therefore no other operations may be permitted access
 to the unisolated indices corresponding to the isolated indices on which the
 transaction during this process. This constraint is generally achieved by
 holding a write lock on the unisolated indices corresponding to the indices
 isolated by the transaction, e.g., by declaring those indices to an
 <a href="../../../../com/bigdata/journal/ITx.html#UNISOLATED"><code>ITx.UNISOLATED</code></a> <a href="../../../../com/bigdata/journal/AbstractTask.html" title="class in com.bigdata.journal"><code>AbstractTask</code></a> which handles this process. </p></div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd><a href="mailto:thompsonbry@users.sourceforge.net">Bryan Thompson</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_com.bigdata.btree.view.FusedView">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;com.bigdata.btree.view.<a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></h3>
<code><a href="../../../../com/bigdata/btree/view/FusedView.FusedBloomFilter.html" title="class in com.bigdata.btree.view">FusedView.FusedBloomFilter</a></code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_com.bigdata.btree.view.FusedView">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.bigdata.btree.view.<a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></h3>
<code><a href="../../../../com/bigdata/btree/view/FusedView.html#ERR_RANGE_COUNT_EXCEEDS_MAX_LONG">ERR_RANGE_COUNT_EXCEEDS_MAX_LONG</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#log">log</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_com.bigdata.btree.IRangeQuery">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;com.bigdata.btree.<a href="../../../../com/bigdata/btree/IRangeQuery.html" title="interface in com.bigdata.btree">IRangeQuery</a></h3>
<code><a href="../../../../com/bigdata/btree/IRangeQuery.html#ALL">ALL</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#CURSOR">CURSOR</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#DEFAULT">DEFAULT</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#DELETED">DELETED</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#FIXED_LENGTH_SUCCESSOR">FIXED_LENGTH_SUCCESSOR</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#KEYS">KEYS</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#NONE">NONE</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#PARALLEL">PARALLEL</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#READONLY">READONLY</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#REMOVEALL">REMOVEALL</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#REVERSE">REVERSE</a>, <a href="../../../../com/bigdata/btree/IRangeQuery.html#VALS">VALS</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#IsolatedFusedView(long,%20com.bigdata.btree.AbstractBTree[])">IsolatedFusedView</a></strong>(long&nbsp;timestamp,
                 <a href="../../../../com/bigdata/btree/AbstractBTree.html" title="class in com.bigdata.btree">AbstractBTree</a>[]&nbsp;sources)</code>
<div class="block">Constructor may be used either for a fully isolated transaction or an
 unisolated operation.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../com/bigdata/btree/ICounter.html" title="interface in com.bigdata.btree">ICounter</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#getCounter()">getCounter</a></strong>()</code>
<div class="block">Counters are disallowed for isolated view.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../com/bigdata/btree/BTree.html" title="class in com.bigdata.btree">BTree</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#getWriteSet()">getWriteSet</a></strong>()</code>
<div class="block">The isolated write set (the place where we record the intention of the
 transaction).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#insert(byte[],%20byte[])">insert</a></strong>(byte[]&nbsp;key,
      byte[]&nbsp;val)</code>
<div class="block">Insert or update a value under the key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#isEmptyWriteSet()">isEmptyWriteSet</a></strong>()</code>
<div class="block">True iff there are no writes on this isolated index.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#mergeDown(long,%20com.bigdata.btree.AbstractBTree[])">mergeDown</a></strong>(long&nbsp;revisionTime,
         <a href="../../../../com/bigdata/btree/AbstractBTree.html" title="class in com.bigdata.btree">AbstractBTree</a>[]&nbsp;groundStateSources)</code>
<div class="block">
 Merge the transaction scope index onto the then current unisolated index.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#putIfAbsent(byte[],%20byte[])">putIfAbsent</a></strong>(byte[]&nbsp;key,
           byte[]&nbsp;val)</code>
<div class="block">Insert or update a value under the key iff there is no entry for that key
 in the index.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#remove(byte[])">remove</a></strong>(byte[]&nbsp;key)</code>
<div class="block">Write a deleted entry for the key on the write set.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html#validate(com.bigdata.btree.AbstractBTree[])">validate</a></strong>(<a href="../../../../com/bigdata/btree/AbstractBTree.html" title="class in com.bigdata.btree">AbstractBTree</a>[]&nbsp;groundStateSources)</code>
<div class="block">
 Validate changes made to the index within a transaction against the last
 committed state of the index in the global scope.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.bigdata.btree.view.FusedView">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.bigdata.btree.view.<a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></h3>
<code><a href="../../../../com/bigdata/btree/view/FusedView.html#assertNotReadOnly()">assertNotReadOnly</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#contains(byte[])">contains</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#contains(java.lang.Object)">contains</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getBloomFilter()">getBloomFilter</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getCounters()">getCounters</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getIndexMetadata()">getIndexMetadata</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getMutableBTree()">getMutableBTree</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getResourceMetadata()">getResourceMetadata</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getSourceCount()">getSourceCount</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#getSources()">getSources</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#insert(java.lang.Object,%20java.lang.Object)">insert</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#lookup(byte[])">lookup</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#lookup(byte[],%20com.bigdata.btree.Tuple)">lookup</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#lookup(int,%20byte[],%20com.bigdata.btree.Tuple)">lookup</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#lookup(java.lang.Object)">lookup</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeCount()">rangeCount</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeCount(byte[],%20byte[])">rangeCount</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeCountExact(byte[],%20byte[])">rangeCountExact</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeCountExactWithDeleted(byte[],%20byte[])">rangeCountExactWithDeleted</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeIterator()">rangeIterator</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeIterator(byte[],%20byte[])">rangeIterator</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#rangeIterator(byte[],%20byte[],%20int,%20int,%20cutthecrap.utils.striterators.IFilter)">rangeIterator</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#remove(java.lang.Object)">remove</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#submit(byte[],%20byte[],%20com.bigdata.btree.proc.IKeyRangeIndexProcedure,%20com.bigdata.btree.proc.IResultHandler)">submit</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#submit(byte[],%20com.bigdata.btree.proc.ISimpleIndexProcedure)">submit</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#submit(int,%20int,%20byte[][],%20byte[][],%20com.bigdata.btree.proc.AbstractKeyArrayIndexProcedureConstructor,%20com.bigdata.btree.proc.IResultHandler)">submit</a>, <a href="../../../../com/bigdata/btree/view/FusedView.html#toString()">toString</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="IsolatedFusedView(long, com.bigdata.btree.AbstractBTree[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>IsolatedFusedView</h4>
<pre>public&nbsp;IsolatedFusedView(long&nbsp;timestamp,
                 <a href="../../../../com/bigdata/btree/AbstractBTree.html" title="class in com.bigdata.btree">AbstractBTree</a>[]&nbsp;sources)</pre>
<div class="block">Constructor may be used either for a fully isolated transaction or an
 unisolated operation. In each case the <i>groundState</i> is the ordered
 set of read-only resources corresponding to the <i>timestamp</i>.
 <p>
 Reads will read through the <i>writeSet</i> and then the resource(s) in
 the <i>groundState</i> in the order in which they are given. A read is
 satisfied by the first resource containing an index entry for the search
 key.
 <p>
 Writes will first read through looking for a @todo javadoc</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timestamp</code> - The timestamp associated with the <i>groundState</i>.</dd><dd><code>sources</code> - An ordered array of sources comprised of the <a href="../../../../com/bigdata/btree/BTree.html" title="class in com.bigdata.btree"><code>BTree</code></a>
            that will absorb writes and the historical ground state.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getWriteSet()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWriteSet</h4>
<pre>public&nbsp;<a href="../../../../com/bigdata/btree/BTree.html" title="class in com.bigdata.btree">BTree</a>&nbsp;getWriteSet()</pre>
<div class="block">The isolated write set (the place where we record the intention of the
 transaction). This is just a reference to the mutable <a href="../../../../com/bigdata/btree/BTree.html" title="class in com.bigdata.btree"><code>BTree</code></a> at
 index zero(0) of sources in the view.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../com/bigdata/btree/view/FusedView.html#getMutableBTree()"><code>FusedView.getMutableBTree()</code></a></dd></dl>
</li>
</ul>
<a name="isEmptyWriteSet()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isEmptyWriteSet</h4>
<pre>public&nbsp;boolean&nbsp;isEmptyWriteSet()</pre>
<div class="block">True iff there are no writes on this isolated index.</div>
</li>
</ul>
<a name="getCounter()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCounter</h4>
<pre>public final&nbsp;<a href="../../../../com/bigdata/btree/ICounter.html" title="interface in com.bigdata.btree">ICounter</a>&nbsp;getCounter()</pre>
<div class="block">Counters are disallowed for isolated view. The reason is that counters
 are typically used to create one-up distinct values assigned to keys. If
 the counter is stored on the write set then different transactions could
 easily assign the same counter value under different keys, leading to an
 undetectable write conflict.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/IIndexLocalCounter.html#getCounter()">getCounter</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/btree/IIndexLocalCounter.html" title="interface in com.bigdata.btree">IIndexLocalCounter</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/view/FusedView.html#getCounter()">getCounter</a></code>&nbsp;in class&nbsp;<code><a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/UnsupportedOperationException.html?is-external=true" title="class or interface in java.lang">UnsupportedOperationException</a></code> - always</dd></dl>
</li>
</ul>
<a name="insert(byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>insert</h4>
<pre>public&nbsp;byte[]&nbsp;insert(byte[]&nbsp;key,
            byte[]&nbsp;val)</pre>
<div class="block">Insert or update a value under the key.
 <p>
 Resolves the old value against the view and then directs the write to the
 first of the sources specified to the ctor.
 <p>
 Write an entry for the key on the write set.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/ISimpleBTree.html#insert(byte[],%20byte[])">insert</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/btree/ISimpleBTree.html" title="interface in com.bigdata.btree">ISimpleBTree</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/view/FusedView.html#insert(byte[],%20byte[])">insert</a></code>&nbsp;in class&nbsp;<code><a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - The key.</dd><dd><code>val</code> - The value (may be null).</dd>
<dt><span class="strong">Returns:</span></dt><dd>The previous value under that key or <code>null</code> if the
         key was not found or if the previous entry for that key was
         marked as deleted.</dd></dl>
</li>
</ul>
<a name="putIfAbsent(byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>putIfAbsent</h4>
<pre>public&nbsp;byte[]&nbsp;putIfAbsent(byte[]&nbsp;key,
                 byte[]&nbsp;val)</pre>
<div class="block">Insert or update a value under the key iff there is no entry for that key
 in the index. This is equivalent to
 
 <pre>
 if (!contains(key))
        insert(key, value);
 </pre>
 
 However, if the index allows <code>null</code> values to be stored under
 a key and the application in fact stores <code>null</code> values for
 some tuples, then caller is not able to decide using this method whether
 or not the mutation was applied based on the return value. For these
 cases if the caller needs to know whether or not the conditional mutation
 actually took place, the caller CAN use the pattern
 <code>if(!contains()) insert(key,value);</code> to obtain that
 information.
 <p>
 This case is a bit tricky. Since it is possible for the value stored
 under a key to be null, we need to obtain the Tuple for the key from the
 view. If the tuple is null or deleted, then we can do an unconditional
 insert. Otherwise there is an entry under the key and we return the value
 of the entry from the Tuple. Note that the value COULD be a null.
 <p>
 Write an entry for the key on the write set.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/ISimpleBTree.html#putIfAbsent(byte[],%20byte[])">putIfAbsent</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/btree/ISimpleBTree.html" title="interface in com.bigdata.btree">ISimpleBTree</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/view/FusedView.html#putIfAbsent(byte[],%20byte[])">putIfAbsent</a></code>&nbsp;in class&nbsp;<code><a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - The key.</dd><dd><code>val</code> - The value (may be null).</dd>
<dt><span class="strong">Returns:</span></dt><dd>The previous value under that key or <code>null</code> if the key
         was not found or if the previous entry for that key was marked as
         deleted. Note that the return value MAY be <code>null</code> even
         if there was an entry under the key. This is because the index is
         capable of storing a <code>null</code> value. In such cases the
         conditional mutation WAS NOT applied.</dd><dt><span class="strong">See Also:</span></dt><dd><code>(putIfAbsent)</code></dd></dl>
</li>
</ul>
<a name="remove(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>remove</h4>
<pre>public&nbsp;byte[]&nbsp;remove(byte[]&nbsp;key)</pre>
<div class="block">Write a deleted entry for the key on the write set.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/ISimpleBTree.html#remove(byte[])">remove</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/bigdata/btree/ISimpleBTree.html" title="interface in com.bigdata.btree">ISimpleBTree</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../com/bigdata/btree/view/FusedView.html#remove(byte[])">remove</a></code>&nbsp;in class&nbsp;<code><a href="../../../../com/bigdata/btree/view/FusedView.html" title="class in com.bigdata.btree.view">FusedView</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - The key.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The value stored under that key or <code>null</code> if the key
         was not found or if the previous entry under that key was marked
         as deleted.</dd></dl>
</li>
</ul>
<a name="validate(com.bigdata.btree.AbstractBTree[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validate</h4>
<pre>public&nbsp;boolean&nbsp;validate(<a href="../../../../com/bigdata/btree/AbstractBTree.html" title="class in com.bigdata.btree">AbstractBTree</a>[]&nbsp;groundStateSources)</pre>
<div class="block"><p>
 Validate changes made to the index within a transaction against the last
 committed state of the index in the global scope. In general there are
 two kinds of conflicts: read-write conflicts and write-write conflicts.
 Read-write conflicts are handled by NEVER overwriting an existing version
 (an MVCC style strategy). Write-write conflicts are detected by backward
 validation against the last committed state of the journal. A write-write
 conflict exists IFF the version counter on the transaction index entry
 differs from the version counter in the global index scope. Once
 detected, the resolution of a write-write conflict is delegated to a
 <a href="../../../../com/bigdata/btree/isolation/IConflictResolver.html" title="interface in com.bigdata.btree.isolation"><code>conflict resolver</code></a>. If a write-write conflict
 can not be validated, then validation will fail and the transaction must
 abort.
 </p>
 <p>
 Validation occurs as part of the prepare/commit protocol. Concurrent
 transactions MAY continue to run without limitation. A concurrent commit
 (if permitted) would force re-validation since the transaction MUST now
 be validated against the new baseline. (It is possible that this
 validation could be optimized.)
 </p>
 <p>
 The version counters used to detect write-write conflicts are incremented
 during the commit as part of the <code>#mergeDown()</code> of the
 <a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html" title="class in com.bigdata.btree.isolation"><code>IsolatedFusedView</code></a> onto the corresponding unisolated indices in
 the global scope.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>groundStateSources</code> - The ordered view of the unisolated index. This MUST be the
            current view of the ground state as of when the transaction is
            validated (NOT when it was created). This view WILL NOT the
            same as the groundState specified to the constructor if
            intervening transactions have committed on the index.</dd>
<dt><span class="strong">Returns:</span></dt><dd>True iff validation succeeds.</dd></dl>
</li>
</ul>
<a name="mergeDown(long, com.bigdata.btree.AbstractBTree[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>mergeDown</h4>
<pre>public&nbsp;void&nbsp;mergeDown(long&nbsp;revisionTime,
             <a href="../../../../com/bigdata/btree/AbstractBTree.html" title="class in com.bigdata.btree">AbstractBTree</a>[]&nbsp;groundStateSources)</pre>
<div class="block"><p>
 Merge the transaction scope index onto the then current unisolated index.
 </p>
 <p>
 Note: This method is invoked by a transaction during commit processing to
 merge the write set of an <a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html" title="class in com.bigdata.btree.isolation"><code>IsolatedFusedView</code></a> into the global
 scope. This operation does NOT check for conflicts. The pre-condition is
 that the transaction has already been validated (hence, there will be no
 conflicts).
 </p>
 <p>
 Note: This method is also responsible for updating the version timestamps
 that are used to detect write-write conflicts during validation - they
 are set to the <i>revisionTime</i>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>revisionTime</code> - The revision timestamp assigned to the commit point of the
            transaction.</dd><dd><code>groundStateSources</code> - The ordered view of the unisolated index. This MUST be the
            current view of the ground state as of when the transaction is
            validated (NOT when it was created). This view WILL NOT the
            same as the groundState specified to the constructor if
            intervening transactions have committed on the index.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/IsolatedFusedView.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/bigdata/btree/isolation/IConflictResolver.html" title="interface in com.bigdata.btree.isolation"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../com/bigdata/btree/isolation/NoConflictResolver.html" title="class in com.bigdata.btree.isolation"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/bigdata/btree/isolation/IsolatedFusedView.html" target="_top">Frames</a></li>
<li><a href="IsolatedFusedView.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_classes_inherited_from_class_com.bigdata.btree.view.FusedView">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_com.bigdata.btree.view.FusedView">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2019 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
