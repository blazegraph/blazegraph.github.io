<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Thu Jun 09 18:54:37 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>com.bigdata.btree.isolation (Blazegraph Database Platform 2.1.1 API)</title>
<meta name="date" content="2016-06-09">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="com.bigdata.btree.isolation (Blazegraph Database Platform 2.1.1 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/bigdata/btree/filter/package-summary.html">Prev Package</a></li>
<li><a href="../../../../com/bigdata/btree/keys/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/bigdata/btree/isolation/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;com.bigdata.btree.isolation</h1>
<div class="docSummary">&nbsp;</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/IConflictResolver.html" title="interface in com.bigdata.btree.isolation">IConflictResolver</a></td>
<td class="colLast">
<div class="block">
 An interface invoked during backward validation when a write-write conflict
 has been detected.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html" title="class in com.bigdata.btree.isolation">IsolatedFusedView</a></td>
<td class="colLast">
<div class="block">
 An index (or index partition) that has been isolated by a transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/NoConflictResolver.html" title="class in com.bigdata.btree.isolation">NoConflictResolver</a></td>
<td class="colLast">
<div class="block">Does not resolve any conflicts.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestAccount.html" title="class in com.bigdata.btree.isolation">TestAccount</a></td>
<td class="colLast">
<div class="block">This test case demonstrates a state-based validation technique described in
 http://www.cs.brown.edu/~mph/Herlihy90a/p96-herlihy.pdf for a "bank account"
 data type.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestAccount.Account.html" title="class in com.bigdata.btree.isolation">TestAccount.Account</a></td>
<td class="colLast">
<div class="block">An implementation of a bank account data type used to test state-based
 validation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestAccount.TxAccount.html" title="class in com.bigdata.btree.isolation">TestAccount.TxAccount</a></td>
<td class="colLast">
<div class="block">A transactional view of an <a href="../../../../com/bigdata/btree/isolation/TestAccount.Account.html" title="class in com.bigdata.btree.isolation"><code>TestAccount.Account</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestAll.html" title="class in com.bigdata.btree.isolation">TestAll</a></td>
<td class="colLast">
<div class="block">Aggregates test suites in increasing dependency order.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestConflictResolution.html" title="class in com.bigdata.btree.isolation">TestConflictResolution</a></td>
<td class="colLast">
<div class="block">Tests of write-write conflict resolution.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestConflictResolution.SingleValueConflictResolver.html" title="class in com.bigdata.btree.isolation">TestConflictResolution.SingleValueConflictResolver</a></td>
<td class="colLast">
<div class="block">Helper class used to resolve a predicted conflict to a known value.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestIsolatedFusedView.html" title="class in com.bigdata.btree.isolation">TestIsolatedFusedView</a></td>
<td class="colLast">
<div class="block">Test suite for <a href="../../../../com/bigdata/btree/isolation/IsolatedFusedView.html" title="class in com.bigdata.btree.isolation"><code>IsolatedFusedView</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestMixedModeOperations.html" title="class in com.bigdata.btree.isolation">TestMixedModeOperations</a></td>
<td class="colLast">
<div class="block">This is a test suite for mixing full transactions with unisolated operations
 on the same indices.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/bigdata/btree/isolation/TestAccount.TxAccount.OverdraftException.html" title="class in com.bigdata.btree.isolation">TestAccount.TxAccount.OverdraftException</a></td>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package com.bigdata.btree.isolation Description">Package com.bigdata.btree.isolation Description</h2>
<div class="block"><!-- $Id$ -->

<p>
Support for transactional isolation builds on the basic features of the 
<a href="../../../../com/bigdata/btree/package-summary.html"><code>com.bigdata.btree</code></a> package, including copy-on-write semantics, per-tuple
delete markers, and per-tuple revision timestamps, and on the characteristics
of the <a href="../../../../com/bigdata/journal/AbstractJournal.html" title="class in com.bigdata.journal"><code>AbstractJournal</code></a>, which guarantees that valid
data are never overwritten (it is an immortal database aka temporal store aka
WORM store).  In order to support transactional isolation, the B+Tree MUST be
provisioned to maintain both per-tuple delete markers and per-tuple revision
timestamps.  The per-tuple delete marker is used to mark keys for tuples which
have been deleted.  Delete markers remain in place unless the tuple is updated
to a non-deleted tuple.  (In the scale-out architecture, delete markers are purged
by a compacting merge.)  The per-tuple revision timestamp is used to detect
write-write conflicts between transactions as described below.  This is an 
<em>MVCC</em> (Multiple Version Concurrency Control) design.
</p>

<p>
The basic design for isolation requires that reads are performed
against a historical committed state of the store (the ground state,
which is typically the last committed state of the store at the time
that the transaction begins) while writes are isolated (they are not
visible outside of the transaction). The basic mechanism for isolation
is an <code>com.bigdata.btree.isolated.IsolatedFusedView</code> which reads through
to a read-only btree loaded from a historical metadata record while writes
go into the isolated <a href="../../../../com/bigdata/btree/BTree.html" title="class in com.bigdata.btree"><code>BTree</code></a> (aka the transaction
write set).  
</p>

<p>
In order to commit, the transaction must validate the write set on the
isolated btree against the then current committed state of the unisolated
btree. If there have been no intervening commits then validation is a
NOP since the read-only btree that the isolated btree reads through to
is the current committed state. If there have been intervening
commits, then validation may identify write-write conflicts
(read-write conflicts can not occur in MVCC). A write-write
conflict exists when a concurrent transaction wrote data for the
same key as the transaction that is being validated and has already
committed (conflicts are not visible until a writer has committed).
</p>

<p>
Once a transaction has validated it is merged down onto the globally
visible state of the btree. This process consists simply of applying
the changes to the globally visible btree, including both inserts of
key-value pairs and removal of keys that were deleted during the
transaction.  A <em>revision timestamp</em> is assigned when the
transaction begins to validate its write set.  The revision timestamp
is used to annotate each tuple updated by the transaction.  This is
the basis for detecting write-write conflicts.
</p>

<p>
If a transaction is reading from or writing on more than one btree,
then it must validate the write set for each btree during its
validation stage and merge down the write set for each btree during
its merge stage. Once this merge process is complete, the btree is
flushed to the backing store which results in a new checkpoint
record. The mapping from the btree name to checkpoint record is
then updated on the backing store. Finally, an atomic commit is then
performed on the backing store. At this point the transaction has
successfully completed.
</p>

<h2>Conflict Resolution</h2>

<p>
Write-write conflicts may be reconciled using application specific
logic.  To do this you must register an <code>IConflictResolver</code>
when the B+-Tree is provisioned.  This interface will offer you an
opportunity to inspect each tuple for which a write-write conflict
was detected.  If the conflicts are reconciled, then the transaction
will commit.  Otherwise it will abort. 
</p>

<h2>Extended commit processing</h2>

<p>Support for this has not been specified yet.</p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/bigdata/btree/filter/package-summary.html">Prev Package</a></li>
<li><a href="../../../../com/bigdata/btree/keys/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/bigdata/btree/isolation/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
