<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Sat Jun 18 19:39:13 UTC 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>com.bigdata.cache (Blazegraph Database Platform 2.1.2 API)</title>
<meta name="date" content="2016-06-18">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="com.bigdata.cache (Blazegraph Database Platform 2.1.2 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/btree/view/package-summary.html">Prev Package</a></li>
<li><a href="../../../com/bigdata/concurrent/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/cache/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;com.bigdata.cache</h1>
<div class="docSummary">
<div class="block">A canonicalizing object cache may be constructed from an outer weak
reference value hash map backed by an inner hard reference LRU policy.</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/HardReferenceQueueEvictionListener.html" title="interface in com.bigdata.cache">HardReferenceQueueEvictionListener</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Interface for reporting cache evictions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ICacheEntry.html" title="interface in com.bigdata.cache">ICacheEntry</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">
 Interface for hard reference cache entries exposes a <i>dirty</i> flag in
 addition to the object identifier and object reference.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ICacheListener.html" title="interface in com.bigdata.cache">ICacheListener</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">Interface receives notice of cache eviction events.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ICachePolicy.html" title="interface in com.bigdata.cache">ICachePolicy</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">
 Interface for cache policy.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/IConcurrentWeakValueCache.html" title="interface in com.bigdata.cache">IConcurrentWeakValueCache</a>&lt;K,V&gt;</td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/IHardReferenceQueue.html" title="interface in com.bigdata.cache">IHardReferenceQueue</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Interface for a hard reference queue.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/IWeakRefCacheEntry.html" title="interface in com.bigdata.cache">IWeakRefCacheEntry</a>&lt;K,T&gt;</td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/IWeakRefCacheEntryFactory.html" title="interface in com.bigdata.cache">IWeakRefCacheEntryFactory</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">Interface supports choice of either weak or soft references for cache
 entries and makes it possible for the application to extend the metadata
 associated with and entry in the <a href="../../../com/bigdata/cache/WeakValueCache.html" title="class in com.bigdata.cache"><code>WeakValueCache</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/LRUCache.ICacheOrderChangeListener.html" title="interface in com.bigdata.cache">LRUCache.ICacheOrderChangeListener</a>&lt;K,T&gt;</td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/SynchronizedHardReferenceQueueWithTimeout.IRef.html" title="interface in com.bigdata.cache">SynchronizedHardReferenceQueueWithTimeout.IRef</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Interface for something wrapping a reference.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/WeakValueCache.IClearReferenceListener.html" title="interface in com.bigdata.cache">WeakValueCache.IClearReferenceListener</a>&lt;K&gt;</td>
<td class="colLast">
<div class="block">An optional listener that is invoked when we notice a cleared reference.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ConcurrentWeakValueCache.html" title="class in com.bigdata.cache">ConcurrentWeakValueCache</a>&lt;K,V&gt;</td>
<td class="colLast">
<div class="block">A low-contention/high concurrency weak value cache.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ConcurrentWeakValueCache.WeakRef.html" title="class in com.bigdata.cache">ConcurrentWeakValueCache.WeakRef</a>&lt;K,V&gt;</td>
<td class="colLast">
<div class="block">Adds the key to the weak reference.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ConcurrentWeakValueCacheWithBatchedUpdates.html" title="class in com.bigdata.cache">ConcurrentWeakValueCacheWithBatchedUpdates</a>&lt;K,V&gt;</td>
<td class="colLast">
<div class="block">A low-contention/high concurrency weak value cache.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ConcurrentWeakValueCacheWithBatchedUpdates.WeakRef.html" title="class in com.bigdata.cache">ConcurrentWeakValueCacheWithBatchedUpdates.WeakRef</a>&lt;K,V&gt;</td>
<td class="colLast">
<div class="block">Adds the key to the weak reference.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/ConcurrentWeakValueCacheWithTimeout.html" title="class in com.bigdata.cache">ConcurrentWeakValueCacheWithTimeout</a>&lt;K,V&gt;</td>
<td class="colLast">
<div class="block">Extends the basic behavior to clear stale references from a backing hard
 reference queue.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/HardReferenceQueue.html" title="class in com.bigdata.cache">HardReferenceQueue</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">
 A cache for hard references using an LRU policy.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/HardReferenceQueueWithBatchingUpdates.html" title="class in com.bigdata.cache">HardReferenceQueueWithBatchingUpdates</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">A variant relying on thread-local <a href="../../../com/bigdata/cache/IHardReferenceQueue.html" title="interface in com.bigdata.cache"><code>IHardReferenceQueue</code></a>s to batch
 updates and thus minimize thread contention for the lock required to
 synchronize calls to <a href="../../../com/bigdata/cache/HardReferenceQueueWithBatchingUpdates.html#add(T)"><code>HardReferenceQueueWithBatchingUpdates.add(Object)</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/LRUCache.html" title="class in com.bigdata.cache">LRUCache</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">Hard reference hash map with Least Recently Used ordering over entries.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/RingBuffer.html" title="class in com.bigdata.cache">RingBuffer</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">
 A unsynchronized fixed capacity ring buffer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/SoftCacheEntry.html" title="class in com.bigdata.cache">SoftCacheEntry</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">Implementation based on <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/SoftReference.html?is-external=true" title="class or interface in java.lang.ref"><code>SoftReference</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/SoftCacheEntryFactory.html" title="class in com.bigdata.cache">SoftCacheEntryFactory</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">The default factory for <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref"><code>WeakReference</code></a> cache entries.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/SynchronizedHardReferenceQueue.html" title="class in com.bigdata.cache">SynchronizedHardReferenceQueue</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Thread-safe version.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/SynchronizedHardReferenceQueueWithTimeout.html" title="class in com.bigdata.cache">SynchronizedHardReferenceQueueWithTimeout</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">
 Thread-safe version with timeout for clearing stale references from the
 queue.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/WeakCacheEntry.html" title="class in com.bigdata.cache">WeakCacheEntry</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">Implementation based on <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref"><code>WeakReference</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/WeakCacheEntryFactory.html" title="class in com.bigdata.cache">WeakCacheEntryFactory</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">The default factory for <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref"><code>WeakReference</code></a> cache entries.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/bigdata/cache/WeakValueCache.html" title="class in com.bigdata.cache">WeakValueCache</a>&lt;K,T&gt;</td>
<td class="colLast">
<div class="block">
 A memory sensitive cache using weak references for its values and object ids
 for its keys and backed by the CRUD operations of the persistence layer,
 which is assumed to implement a hard reference LRU or similar cache policy.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package com.bigdata.cache Description">Package com.bigdata.cache Description</h2>
<div class="block"><p>A canonicalizing object cache may be constructed from an outer weak
reference value hash map backed by an inner hard reference LRU policy.
The weak reference value map ensures that there is never more than one
runtime object for a given object identifier (OID) within the same
context. This guarentee means that we can use reference testing on
persistence capable runtime objects to test for equality.  Further,
unlike testing the OID, a reference test also differentiates between
runtime objects with the same OID in different contexts and distinct
object references will result in each context for the same object
identifier.</p>

<h3>WeakValueCache</h3>

<p>This class implements a hash map using weak or soft references as
its values and object identifiers as its keys. When an object is
touched in the outer weak value map its ordering is updated in the
inner hard reference map. Java does not support notification before a
weak (or soft) reference is cleared. Therefore cache eviction notices
are generated eagerly when the object is evicted from the inner hard
reference cache. When a weak reference is cleared, that fact is
recorded on a ReferenceQueue. Various operations on the cache poll the
queue and remove entries corresponding to objects which are no longer
reachable.  A facility is provided to remove individual objects from
the weak value cache, however objects automatically removed when the
garbage collector clears the weak reference.</p>

<p>
Note: Many methods on the WeakValueCache are delegated to the inner
hard reference cache, including: size(), iterator(), entryIterator(),
etc.  Among other things this means that you can NOT enumerate the
entries in the weak value cache, but only in the inner hard reference
cache.
</p>

<h3>LRUCache</h3>

<p>This class implements an LRU policy. Once the cache reaches capacity
inserting a new object into the cache causes the Least Recently Used
object to be evicted from the cache. A listener may be registered
against the cache and will be notified when objects are evicted from the
cache.</p>

<h3>Integration</h3>

<p>This package is designed to support efficient incremental writes of
dirty objects which are no longer strongly reachable against a
persistence layer. The application is typically an object database
framework, such as the Generic Object Model (GOM).</p>

<p>A WeakValueCache is constructed using the LRUCache as its inner
hard reference map.  The persistence layer then registers a listener
for cache eviction events against the WeakValueCache, but the listener
is actually set on the inner hard reference map - the LRUCache.  When
the persistence layer receivies cache eviction notices they are from
the inner hard reference map.</p>

<p>The capacity of the inner LRUCache determines the maximum #of dirty
objects that may exist within the context administered by the
WeakValueCache (there is no limit imposed on the #of clean
objects). When the persistence layer fetches an object, it put()s it
into the WeakValueCache with the dirty flag set to <code>false</code>.
When the object becomes dirty it notifies the WeakValueCache using
put() with the dirty flag set to <code>true</code>. Both operations
cause the LRUCache ordering to be updated. While the WeakValueCache
will contain all weakly reachable objects that it administers, the
LRUCache capacity is fixed when it is created. Once the LRUCache is at
capacity a put() of an object against the WeakValueCache that is not
also in the LRUCache force the eviction of another object from the
LRUCache.</p>

<p>When the LRUCache evicts an object, the listener receives notice
via the WeakValueCache listener. If the notice indicates that the
object is dirty, then the listener must cause the persistent state of
the object to be updated within the backing store (which may be a
transaction scope). Typically this means serializing the persistent
state of the object and requesting that the persistence layer update
its copy of the object state.</p>

<p>On commit, all dirty objects on the inner LRUCache must be flushed
to the persistence layer.</p>

<p>Each object in the cache is either clear or dirty. The dirty flag
state is normally managed using <code>ICachePolicy#put(long, Object,
boolean)</code>. During a cache eviction, the object evicted from the cache
gets written through to the persistence layer. However it is not
necessary to clear the dirty flag during a cache eviction since the
cache entry will be either recycled or discarded. The only case where
the client needs to directly set the dirty flag state is during a
commit iff the application layer will continue to have access to the
object cache.  This is because objects may remain in the cache after
the commit but they are no longer dirty since they were written
through to the persistence layer during the commit.</p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/bigdata/btree/view/package-summary.html">Prev Package</a></li>
<li><a href="../../../com/bigdata/concurrent/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/bigdata/cache/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2006&#x2013;2016 <a href="https://www.blazegraph.com/">SYSTAP, LLC DBA Blazegraph</a>. All rights reserved.</small></p>
</body>
</html>
